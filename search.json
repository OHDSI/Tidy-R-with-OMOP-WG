[
  {
    "objectID": "index.html#description-and-goals",
    "href": "index.html#description-and-goals",
    "title": "Tidy R with OMOP workgroup",
    "section": "Description and goals",
    "text": "Description and goals\n\nOKRs 2026\n\n\nOKRs 2025"
  },
  {
    "objectID": "index.html#regular-meetings",
    "href": "index.html#regular-meetings",
    "title": "Tidy R with OMOP workgroup",
    "section": "Regular meetings",
    "text": "Regular meetings"
  },
  {
    "objectID": "index.html#join-the-journey",
    "href": "index.html#join-the-journey",
    "title": "Tidy R with OMOP workgroup",
    "section": "Join the Journey",
    "text": "Join the Journey"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#introduction",
    "href": "Presentations/DrugUtilisation.html#introduction",
    "title": "DrugUtilisation",
    "section": "Introduction",
    "text": "Introduction\nDrug Utilisation Studies (DUS) were defined by the World Health Organization as studying the marketing, distribution, prescription, and use of medicinal products in a society, with special emphasis on the resulting medical and socioeconomic consequences (WHO, 2003).\n\nThis package aims to standardise and provide the tools to conduct Drug Utilisation studies as of the Darwin-EU Catalogue of Standard Analytics."
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#the-package",
    "href": "Presentations/DrugUtilisation.html#the-package",
    "title": "DrugUtilisation",
    "section": "The package",
    "text": "The package\n\n\ninstall.packages(\"DrugUtilisation\")\n\n\nv1.0.5 on cran.\npackage website\nReport an issue/Feature request"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#create-a-reference-to-a-cdm-object",
    "href": "Presentations/DrugUtilisation.html#create-a-reference-to-a-cdm-object",
    "title": "DrugUtilisation",
    "section": "Create a reference to a cdm object",
    "text": "Create a reference to a cdm object\nFor this example we are going to use the GiBleed synthetic test database:\n\nlibrary(omock)\nlibrary(duckdb)\nlibrary(CDMConnector)\nlibrary(dplyr)\nlibrary(CodelistGenerator)\nlibrary(DrugUtilisation)\nlibrary(CohortConstructor)\nlibrary(PatientProfiles)\nlibrary(ggplot2)\nlibrary(clock)\nlibrary(omopgenerics)\nlibrary(CohortSurvival)\n\ncdm &lt;- mockCdmFromDataset(datasetName = \"GiBleed\", source = \"duckdb\")\ncdm$drug_exposure &lt;- cdm$drug_exposure |&gt;\n  mutate(quantity = sql(\"floor(random() * 6) + 1\")) |&gt;\n  mutate(quantity = case_when(\n    quantity == 1 ~ 0,\n    quantity == 2 ~ 1,\n    quantity == 3 ~ 5,\n    quantity == 4 ~ 10,\n    quantity == 5 ~ 30,\n    quantity == 6 ~ 100\n  )) |&gt;\n  compute(name = \"drug_exposure\")"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#generate-a-drug-cohort",
    "href": "Presentations/DrugUtilisation.html#generate-a-drug-cohort",
    "title": "DrugUtilisation",
    "section": "Generate a drug cohort",
    "text": "Generate a drug cohort\nFor this example we are going to use all records of acteaminophen:\n\n\ncodelist &lt;- getDrugIngredientCodes(cdm = cdm, name = \"acetaminophen\", nameStyle = \"{concept_name}\")\n\n\ncdm$dus_cohort &lt;- conceptCohort(\n  cdm = cdm,\n  name = \"dus_cohort\",\n  conceptSet = codelist\n)\n\n\n\nThe results is the cdm object with the new cohort instantiated.\n\n\n\ncdm\n\n\n\n\nâ”€â”€ # OMOP CDM reference (duckdb) of GiBleed â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n\n\nâ€¢ omop tables: care_site, cdm_source, concept, concept_ancestor, concept_class, concept_relationship, concept_synonym,\ncondition_era, condition_occurrence, cost, death, device_exposure, domain, dose_era, drug_era, drug_exposure,\ndrug_strength, fact_relationship, location, measurement, metadata, note, note_nlp, observation, observation_period,\npayer_plan_period, person, procedure_occurrence, provider, relationship, source_to_concept_map, specimen, visit_detail,\nvisit_occurrence, vocabulary\n\n\nâ€¢ cohort tables: dus_cohort\n\n\nâ€¢ achilles tables: -\n\n\nâ€¢ other tables: -"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#cohort-objects",
    "href": "Presentations/DrugUtilisation.html#cohort-objects",
    "title": "DrugUtilisation",
    "section": "Cohort objects",
    "text": "Cohort objects\nThe cohort objects have some attributes:\n\nclass(cdm$dus_cohort)\n\n[1] \"cohort_table\"          \"cdm_table\"             \"GeneratedCohortSet\"    \"tbl_duckdb_connection\"\n[5] \"tbl_dbi\"               \"tbl_sql\"               \"tbl_lazy\"              \"tbl\"                  \n\n\n\n\nnames(attributes(cdm$dus_cohort))\n\n[1] \"names\"            \"class\"            \"tbl_source\"       \"tbl_name\"         \"cohort_set\"       \"cohort_attrition\"\n[7] \"cohort_codelist\"  \"cdm_reference\"   \n\n\n\n\n\nSettings\nCounts\nAttrition\nCodelist"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#cohort-attributes",
    "href": "Presentations/DrugUtilisation.html#cohort-attributes",
    "title": "DrugUtilisation",
    "section": "Cohort attributes",
    "text": "Cohort attributes\nSettings:\n\nsettings(cdm$dus_cohort)\n\n# A tibble: 1 Ã— 4\n  cohort_definition_id cohort_name   cdm_version vocabulary_version\n                 &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;             \n1                    1 acetaminophen 5.3         v5.0 18-JAN-19    \n\n\n\nCohort counts:\n\ncohortCount(cdm$dus_cohort)\n\n# A tibble: 1 Ã— 3\n  cohort_definition_id number_records number_subjects\n                 &lt;int&gt;          &lt;int&gt;           &lt;int&gt;\n1                    1          13908            2679"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#cohort-attributes-1",
    "href": "Presentations/DrugUtilisation.html#cohort-attributes-1",
    "title": "DrugUtilisation",
    "section": "Cohort attributes",
    "text": "Cohort attributes\nCohort attrition:\n\nattrition(cdm$dus_cohort)\n\n# A tibble: 4 Ã— 7\n  cohort_definition_id number_records number_subjects reason_id reason                excluded_records excluded_subjects\n                 &lt;int&gt;          &lt;int&gt;           &lt;int&gt;     &lt;int&gt; &lt;chr&gt;                            &lt;int&gt;             &lt;int&gt;\n1                    1          14205            2679         1 Initial qualifying eâ€¦                0                 0\n2                    1          14205            2679         2 Record in observation                0                 0\n3                    1          14205            2679         3 Not missing record dâ€¦                0                 0\n4                    1          13908            2679         4 Merge overlapping reâ€¦              297                 0\n\n\n\nCohort codelist:\n\ncohortCodelist(cdm$dus_cohort, cohortId = 1)\n\n\n- acetaminophen (7 codes)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#gapera-parameter",
    "href": "Presentations/DrugUtilisation.html#gapera-parameter",
    "title": "DrugUtilisation",
    "section": "gapEra parameter",
    "text": "gapEra parameter\ngapEra parameter can be used to concatenate different records.\n\nNumber of days between two continuous exposures to be considered in the same era. Records that have fewer days between them than this gap will be concatenated into the same cohort record."
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#gapera-parameter-1",
    "href": "Presentations/DrugUtilisation.html#gapera-parameter-1",
    "title": "DrugUtilisation",
    "section": "gapEra parameter",
    "text": "gapEra parameter"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#generate-a-drug-cohort-1",
    "href": "Presentations/DrugUtilisation.html#generate-a-drug-cohort-1",
    "title": "DrugUtilisation",
    "section": "Generate a drug cohort",
    "text": "Generate a drug cohort\n\n\ncohortCount(cdm$dus_cohort)\n\n# A tibble: 1 Ã— 3\n  cohort_definition_id number_records number_subjects\n                 &lt;int&gt;          &lt;int&gt;           &lt;int&gt;\n1                    1          13908            2679\n\n\n\n\n\ncdm$dus_cohort &lt;- cdm$dus_cohort |&gt;\n  collapseCohorts(gap = 30)\n\n\n\n\ncohortCount(cdm$dus_cohort)\n\n# A tibble: 1 Ã— 3\n  cohort_definition_id number_records number_subjects\n                 &lt;int&gt;          &lt;int&gt;           &lt;int&gt;\n1                    1          13860            2679\n\n\n\n\n\nattrition(cdm$dus_cohort)\n\n# A tibble: 5 Ã— 7\n  cohort_definition_id number_records number_subjects reason_id reason                excluded_records excluded_subjects\n                 &lt;int&gt;          &lt;int&gt;           &lt;int&gt;     &lt;int&gt; &lt;chr&gt;                            &lt;int&gt;             &lt;int&gt;\n1                    1          14205            2679         1 Initial qualifying eâ€¦                0                 0\n2                    1          14205            2679         2 Record in observation                0                 0\n3                    1          14205            2679         3 Not missing record dâ€¦                0                 0\n4                    1          13908            2679         4 Merge overlapping reâ€¦              297                 0\n5                    1          13860            2679         5 Collapse cohort withâ€¦               48                 0"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#inclusion-criteria",
    "href": "Presentations/DrugUtilisation.html#inclusion-criteria",
    "title": "DrugUtilisation",
    "section": "Inclusion criteria",
    "text": "Inclusion criteria\nFour functions to add inclusion criteria to our cohort:\n\nWashout requirePriorDrugWashout() (requireConceptIntersect)\nFirst observation requireIsFirstDrugEntry() (requireIsFirstEntry)\nPrior observation requireObservationBeforeDrug() (requirePriorObservation)\nDate range requireDrugInDateRange() (requireInDateRange)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#important-considerations",
    "href": "Presentations/DrugUtilisation.html#important-considerations",
    "title": "DrugUtilisation",
    "section": "Important considerations",
    "text": "Important considerations\nNot all inclusion criteria are commutable operations (A + B != B + A):\nNot commutable:\n\nprior washout + prior observation != prior observation + prior washout\nprior washout + first != first + prior washout\nprior washout + date range != date range + prior washout\nfirst + prior observation != prior observation + first\nfirst + date range != date range + first\n\n\nCommutable:\n\ndate range + prior observation == prior observation + date range"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#recommended-order",
    "href": "Presentations/DrugUtilisation.html#recommended-order",
    "title": "DrugUtilisation",
    "section": "Recommended order",
    "text": "Recommended order\nHaving all this into account the recommended order to apply criteria would be:\n\nRequire a prior drug washout or require first drug entry (particular case).\nRequire a prior observation before the drug episode.\nRequire the drugs to be in a certain date range."
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#vignette-to-create-cohorts",
    "href": "Presentations/DrugUtilisation.html#vignette-to-create-cohorts",
    "title": "DrugUtilisation",
    "section": "Vignette to create cohorts",
    "text": "Vignette to create cohorts\nhttps://darwin-eu-dev.github.io/DrugUtilisation/articles/create_cohorts.html"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drug-usage",
    "href": "Presentations/DrugUtilisation.html#drug-usage",
    "title": "DrugUtilisation",
    "section": "Drug usage",
    "text": "Drug usage\n\n\nresult &lt;- cdm$dus_cohort |&gt;\n  summariseDrugUtilisation(\n    ingredientConceptId = 1125315L, \n    indexDate = \"cohort_start_date\",\n    censorDate = \"cohort_end_date\", \n    restrictIncident = TRUE, \n    gapEra = 30, \n    numberExposures = TRUE, \n    numberEras = TRUE,\n    daysExposed = TRUE,\n    daysPrescribed = TRUE,\n    timeToExposure = FALSE, \n    initialQuantity = TRUE, \n    cumulativeQuantity = TRUE, \n    initialDailyDose = TRUE, \n    cumulativeDose = TRUE,\n    estimates = c(\"q25\", \"median\", \"q75\")\n  )"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drug-usage-1",
    "href": "Presentations/DrugUtilisation.html#drug-usage-1",
    "title": "DrugUtilisation",
    "section": "Drug usage",
    "text": "Drug usage\n\nresult |&gt;\n  suppress(minCellCount = 5) |&gt;\n  tableDrugUtilisation()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nConcept set\nIngredient\nVariable name\nEstimate name\n\nCDM name\n\n\n\nGiBleed\n\n\n\n\nacetaminophen\n\n\noverall\noverall\nnumber records\nN\n13,860\n\n\n\n\nnumber subjects\nN\n2,679\n\n\ningredient_1125315_descendants\noverall\nnumber exposures\nMedian (Q25 - Q75)\n1 (1 - 1)\n\n\n\n\ncumulative quantity\nMedian (Q25 - Q75)\n10.00 (1.00 - 30.00)\n\n\n\n\ninitial quantity\nMedian (Q25 - Q75)\n10.00 (1.00 - 30.00)\n\n\n\n\ninitial exposure duration\nMedian (Q25 - Q75)\n15 (8 - 15)\n\n\n\n\nnumber eras\nMedian (Q25 - Q75)\n1 (1 - 1)\n\n\n\n\ndays exposed\nMedian (Q25 - Q75)\n15 (8 - 15)\n\n\n\n\ndays prescribed\nMedian (Q25 - Q75)\n15 (8 - 15)\n\n\n\nAcetaminophen\ncumulative dose milligram\nMedian (Q25 - Q75)\n1,625.00 (217.00 - 9,750.00)\n\n\n\n\ninitial daily dose milligram\nMedian (Q25 - Q75)\n108.33 (13.56 - 443.18)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications",
    "href": "Presentations/DrugUtilisation.html#indications",
    "title": "DrugUtilisation",
    "section": "Indications",
    "text": "Indications\nsummariseIndication():\n\nTo summarise mutually exclusive indications.\nDefine a window respect to the â€˜cohort_start_dateâ€™.\nIndications must be instantiated beforehand as cohorts.\nUnknown indication (check a table to see if there is a record)."
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-1",
    "href": "Presentations/DrugUtilisation.html#indications-1",
    "title": "DrugUtilisation",
    "section": "Indications",
    "text": "Indications\nLetâ€™s instantiate the cohorts of interest:\n\ncdm$indications &lt;- conceptCohort(\n  cdm = cdm,\n  conceptSet = list(\n    arteriosclerosis = 317576, \n    myocardial_infarction = 4329847, \n    pain = getCandidateCodes(cdm = cdm, keywords = \"pain\")$concept_id\n  ),\n  name = \"indications\"\n)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indciations",
    "href": "Presentations/DrugUtilisation.html#indciations",
    "title": "DrugUtilisation",
    "section": "Indciations",
    "text": "Indciations\n\nresult &lt;- cdm$dus_cohort |&gt;\n  summariseIndication(\n    indicationCohortName = \"indications\", \n    indicationWindow = list(c(0, 0), c(-30, 7)), \n    unknownIndicationTable = \"condition_occurrence\"\n  )\nresult |&gt;\n  glimpse()\n\nRows: 40\nColumns: 13\n$ result_id        &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, â€¦\n$ cdm_name         &lt;chr&gt; \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBlâ€¦\n$ group_name       &lt;chr&gt; \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"coâ€¦\n$ group_level      &lt;chr&gt; \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetamiâ€¦\n$ strata_name      &lt;chr&gt; \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overâ€¦\n$ strata_level     &lt;chr&gt; \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overâ€¦\n$ variable_name    &lt;chr&gt; \"Indication on index date\", \"Indication on index date\", \"Indication on index date\", \"Indicatiâ€¦\n$ variable_level   &lt;chr&gt; \"arteriosclerosis\", \"arteriosclerosis\", \"myocardial_infarction\", \"myocardial_infarction\", \"paâ€¦\n$ estimate_name    &lt;chr&gt; \"count\", \"percentage\", \"count\", \"percentage\", \"count\", \"percentage\", \"count\", \"percentage\", \"â€¦\n$ estimate_type    &lt;chr&gt; \"integer\", \"percentage\", \"integer\", \"percentage\", \"integer\", \"percentage\", \"integer\", \"percenâ€¦\n$ estimate_value   &lt;chr&gt; \"0\", \"0\", \"64\", \"0.461760461760462\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"13633â€¦\n$ additional_name  &lt;chr&gt; \"window_name\", \"window_name\", \"window_name\", \"window_name\", \"window_name\", \"window_name\", \"wiâ€¦\n$ additional_level &lt;chr&gt; \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 â€¦"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-2",
    "href": "Presentations/DrugUtilisation.html#indications-2",
    "title": "DrugUtilisation",
    "section": "Indications",
    "text": "Indications\n\n\nresult |&gt;\n  suppress() |&gt;\n  tableIndication()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCDM name\n\n\n\n\n\nGiBleed\n\n\n\nIndication\nEstimate name\n\nCohort name\n\n\n\nacetaminophen\n\n\n\n\nIndication on index date\n\n\narteriosclerosis\nN (%)\n0 (0.00 %)\n\n\nmyocardial_infarction\nN (%)\n64 (0.46 %)\n\n\npain\nN (%)\n0 (0.00 %)\n\n\narteriosclerosis and myocardial_infarction\nN (%)\n0 (0.00 %)\n\n\narteriosclerosis and pain\nN (%)\n0 (0.00 %)\n\n\nmyocardial_infarction and pain\nN (%)\n0 (0.00 %)\n\n\narteriosclerosis and myocardial_infarction and pain\nN (%)\n0 (0.00 %)\n\n\nunknown\nN (%)\n13,633 (98.36 %)\n\n\nnone\nN (%)\n163 (1.18 %)\n\n\nnot in observation\nN (%)\n0 (0.00 %)\n\n\nIndication from 30 days before to 7 days after the index date\n\n\narteriosclerosis\nN (%)\n5 (0.04 %)\n\n\nmyocardial_infarction\nN (%)\n64 (0.46 %)\n\n\npain\nN (%)\n0 (0.00 %)\n\n\narteriosclerosis and myocardial_infarction\nN (%)\n0 (0.00 %)\n\n\narteriosclerosis and pain\nN (%)\n0 (0.00 %)\n\n\nmyocardial_infarction and pain\nN (%)\n0 (0.00 %)\n\n\narteriosclerosis and myocardial_infarction and pain\nN (%)\n0 (0.00 %)\n\n\nunknown\nN (%)\n13,784 (99.45 %)\n\n\nnone\nN (%)\n7 (0.05 %)\n\n\nnot in observation\nN (%)\n0 (0.00 %)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-3",
    "href": "Presentations/DrugUtilisation.html#indications-3",
    "title": "DrugUtilisation",
    "section": "Indications",
    "text": "Indications\n\nplotIndication(result)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-4",
    "href": "Presentations/DrugUtilisation.html#indications-4",
    "title": "DrugUtilisation",
    "section": "Indications",
    "text": "Indications\nOutput of ploting functions are ggplot2 objects.\n\n\nplotIndication(result) +\n  theme(legend.position = \"none\")"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-5",
    "href": "Presentations/DrugUtilisation.html#indications-5",
    "title": "DrugUtilisation",
    "section": "Indications",
    "text": "Indications\nCurrently considering to add support for plotly.\n\n\nlibrary(plotly)\nplotIndication(result) |&gt;\n  ggplotly()"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-new-plot",
    "href": "Presentations/DrugUtilisation.html#indications-new-plot",
    "title": "DrugUtilisation",
    "section": "Indications (new plot)",
    "text": "Indications (new plot)\nLetâ€™s say we conducted the analysis stratified by sex:\n\nresult &lt;- cdm$dus_cohort |&gt;\n  addSex() |&gt;\n  summariseIndication(\n    strata = \"sex\",\n    indicationCohortName = \"indications\", \n    indicationWindow = list(c(0, 0), c(-30, 7)), \n    unknownIndicationTable = \"condition_occurrence\"\n  )\nresult |&gt;\n  glimpse()\n\nRows: 120\nColumns: 13\n$ result_id        &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, â€¦\n$ cdm_name         &lt;chr&gt; \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBlâ€¦\n$ group_name       &lt;chr&gt; \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"coâ€¦\n$ group_level      &lt;chr&gt; \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetamiâ€¦\n$ strata_name      &lt;chr&gt; \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overâ€¦\n$ strata_level     &lt;chr&gt; \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overâ€¦\n$ variable_name    &lt;chr&gt; \"Indication on index date\", \"Indication on index date\", \"Indication on index date\", \"Indicatiâ€¦\n$ variable_level   &lt;chr&gt; \"arteriosclerosis\", \"arteriosclerosis\", \"myocardial_infarction\", \"myocardial_infarction\", \"paâ€¦\n$ estimate_name    &lt;chr&gt; \"count\", \"percentage\", \"count\", \"percentage\", \"count\", \"percentage\", \"count\", \"percentage\", \"â€¦\n$ estimate_type    &lt;chr&gt; \"integer\", \"percentage\", \"integer\", \"percentage\", \"integer\", \"percentage\", \"integer\", \"percenâ€¦\n$ estimate_value   &lt;chr&gt; \"0\", \"0\", \"64\", \"0.461760461760462\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"13633â€¦\n$ additional_name  &lt;chr&gt; \"window_name\", \"window_name\", \"window_name\", \"window_name\", \"window_name\", \"window_name\", \"wiâ€¦\n$ additional_level &lt;chr&gt; \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 â€¦"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-new-plot-1",
    "href": "Presentations/DrugUtilisation.html#indications-new-plot-1",
    "title": "DrugUtilisation",
    "section": "Indications (new plot)",
    "text": "Indications (new plot)\n\nplotIndication(result = result, x = \"sex\")"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-new-plot-2",
    "href": "Presentations/DrugUtilisation.html#indications-new-plot-2",
    "title": "DrugUtilisation",
    "section": "Indications (new plot)",
    "text": "Indications (new plot)\n\nYou can do the same plot by year:\n\n\n\nresult &lt;- cdm$dus_cohort |&gt;\n  requireDrugInDateRange(\n    name = \"new_cohort\",\n    dateRange = as.Date(c(\"1990-01-01\", \"1999-12-31\"))\n  ) |&gt;\n  mutate(year = get_year(cohort_start_date)) |&gt;\n  summariseIndication(\n    strata = \"year\",\n    indicationCohortName = \"indications\", \n    indicationWindow = c(-Inf, 0), \n    unknownIndicationTable = \"condition_occurrence\"\n  )\nresult |&gt;\n  filterStrata(year != \"overall\") |&gt;\n  plotIndication(x = \"year\")"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-new-plot-3",
    "href": "Presentations/DrugUtilisation.html#indications-new-plot-3",
    "title": "DrugUtilisation",
    "section": "Indications (new plot)",
    "text": "Indications (new plot)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#treatment-persistence",
    "href": "Presentations/DrugUtilisation.html#treatment-persistence",
    "title": "DrugUtilisation",
    "section": "Treatment persistence",
    "text": "Treatment persistence\nTo analyse treatment persistence and adherence there are two standard pipelines:\n\nSurvival analysis (implemented in the CohortSurvival package)\nProportion of patients covered"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#survival-analysis",
    "href": "Presentations/DrugUtilisation.html#survival-analysis",
    "title": "DrugUtilisation",
    "section": "Survival Analysis",
    "text": "Survival Analysis\n\nsurvivalResults &lt;- estimateSingleEventSurvival(\n  cdm = cdm, \n  targetCohortTable = \"dus_cohort\", \n  outcomeCohortTable = \"dus_cohort\", \n  outcomeDateVariable = \"cohort_end_date\", \n  followUpDays = 90\n)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#survival-analysis-1",
    "href": "Presentations/DrugUtilisation.html#survival-analysis-1",
    "title": "DrugUtilisation",
    "section": "Survival analysis",
    "text": "Survival analysis\n\nplotSurvival(result = survivalResults)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#proportion-of-patients-covered",
    "href": "Presentations/DrugUtilisation.html#proportion-of-patients-covered",
    "title": "DrugUtilisation",
    "section": "Proportion of patients covered",
    "text": "Proportion of patients covered\nProportion of treated individuals between index date and followUpDays. Percentages will be reported daily.\n\nresult &lt;- cdm$dus_cohort |&gt;\n  summariseProportionOfPatientsCovered(followUpDays = 90)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#proportion-of-patients-covered-1",
    "href": "Presentations/DrugUtilisation.html#proportion-of-patients-covered-1",
    "title": "DrugUtilisation",
    "section": "Proportion of patients covered",
    "text": "Proportion of patients covered\n\n\ntableProportionOfPatientsCovered(result)\n\n\n\n\n\n\n\n\n\n\n\n\nTime\nEstimate name\n\nCohort name\n\n\n\nacetaminophen\n\n\n\n\nGiBleed\n\n\n0\nPPC (95%CI)\n100.00% [99.86% - 100.00%]\n\n\n1\nPPC (95%CI)\n98.69% [98.19% - 99.06%]\n\n\n2\nPPC (95%CI)\n98.69% [98.19% - 99.06%]\n\n\n3\nPPC (95%CI)\n98.69% [98.19% - 99.06%]\n\n\n4\nPPC (95%CI)\n98.69% [98.19% - 99.06%]\n\n\n5\nPPC (95%CI)\n98.69% [98.19% - 99.06%]\n\n\n6\nPPC (95%CI)\n98.69% [98.19% - 99.06%]\n\n\n7\nPPC (95%CI)\n98.66% [98.15% - 99.03%]\n\n\n8\nPPC (95%CI)\n74.73% [73.05% - 76.34%]\n\n\n9\nPPC (95%CI)\n74.73% [73.05% - 76.34%]\n\n\n10\nPPC (95%CI)\n74.73% [73.05% - 76.34%]\n\n\n11\nPPC (95%CI)\n74.73% [73.05% - 76.34%]\n\n\n12\nPPC (95%CI)\n74.73% [73.05% - 76.34%]\n\n\n13\nPPC (95%CI)\n74.73% [73.05% - 76.34%]\n\n\n14\nPPC (95%CI)\n74.62% [72.93% - 76.23%]\n\n\n15\nPPC (95%CI)\n19.48% [18.03% - 21.03%]\n\n\n16\nPPC (95%CI)\n19.37% [17.92% - 20.91%]\n\n\n17\nPPC (95%CI)\n19.26% [17.81% - 20.80%]\n\n\n18\nPPC (95%CI)\n19.26% [17.81% - 20.80%]\n\n\n19\nPPC (95%CI)\n19.22% [17.78% - 20.76%]\n\n\n20\nPPC (95%CI)\n19.22% [17.78% - 20.76%]\n\n\n21\nPPC (95%CI)\n19.19% [17.74% - 20.72%]\n\n\n22\nPPC (95%CI)\n14.37% [13.09% - 15.75%]\n\n\n23\nPPC (95%CI)\n14.33% [13.06% - 15.71%]\n\n\n24\nPPC (95%CI)\n14.33% [13.06% - 15.71%]\n\n\n25\nPPC (95%CI)\n14.30% [13.02% - 15.67%]\n\n\n26\nPPC (95%CI)\n14.30% [13.02% - 15.67%]\n\n\n27\nPPC (95%CI)\n14.30% [13.02% - 15.67%]\n\n\n28\nPPC (95%CI)\n14.30% [13.02% - 15.67%]\n\n\n29\nPPC (95%CI)\n11.35% [10.20% - 12.60%]\n\n\n30\nPPC (95%CI)\n11.27% [10.13% - 12.53%]\n\n\n31\nPPC (95%CI)\n8.40% [7.41% - 9.51%]\n\n\n32\nPPC (95%CI)\n8.36% [7.37% - 9.47%]\n\n\n33\nPPC (95%CI)\n8.36% [7.37% - 9.47%]\n\n\n34\nPPC (95%CI)\n8.36% [7.37% - 9.47%]\n\n\n35\nPPC (95%CI)\n8.32% [7.34% - 9.43%]\n\n\n36\nPPC (95%CI)\n5.97% [5.14% - 6.93%]\n\n\n37\nPPC (95%CI)\n5.97% [5.14% - 6.93%]\n\n\n38\nPPC (95%CI)\n5.71% [4.89% - 6.65%]\n\n\n39\nPPC (95%CI)\n5.64% [4.82% - 6.57%]\n\n\n40\nPPC (95%CI)\n5.56% [4.76% - 6.49%]\n\n\n41\nPPC (95%CI)\n5.56% [4.76% - 6.49%]\n\n\n42\nPPC (95%CI)\n5.56% [4.76% - 6.49%]\n\n\n43\nPPC (95%CI)\n5.56% [4.76% - 6.49%]\n\n\n44\nPPC (95%CI)\n5.52% [4.72% - 6.45%]\n\n\n45\nPPC (95%CI)\n5.45% [4.65% - 6.37%]\n\n\n46\nPPC (95%CI)\n5.45% [4.65% - 6.37%]\n\n\n47\nPPC (95%CI)\n5.45% [4.65% - 6.37%]\n\n\n48\nPPC (95%CI)\n5.56% [4.76% - 6.49%]\n\n\n49\nPPC (95%CI)\n5.56% [4.76% - 6.49%]\n\n\n50\nPPC (95%CI)\n5.56% [4.76% - 6.49%]\n\n\n51\nPPC (95%CI)\n5.52% [4.72% - 6.45%]\n\n\n52\nPPC (95%CI)\n5.52% [4.72% - 6.45%]\n\n\n53\nPPC (95%CI)\n5.52% [4.72% - 6.45%]\n\n\n54\nPPC (95%CI)\n5.52% [4.72% - 6.45%]\n\n\n55\nPPC (95%CI)\n5.52% [4.72% - 6.45%]\n\n\n56\nPPC (95%CI)\n5.49% [4.69% - 6.41%]\n\n\n57\nPPC (95%CI)\n5.49% [4.69% - 6.41%]\n\n\n58\nPPC (95%CI)\n5.75% [4.93% - 6.69%]\n\n\n59\nPPC (95%CI)\n5.75% [4.93% - 6.69%]\n\n\n60\nPPC (95%CI)\n5.82% [5.00% - 6.77%]\n\n\n61\nPPC (95%CI)\n3.28% [2.67% - 4.03%]\n\n\n62\nPPC (95%CI)\n3.40% [2.77% - 4.15%]\n\n\n63\nPPC (95%CI)\n3.32% [2.71% - 4.07%]\n\n\n64\nPPC (95%CI)\n3.32% [2.71% - 4.07%]\n\n\n65\nPPC (95%CI)\n3.32% [2.71% - 4.07%]\n\n\n66\nPPC (95%CI)\n3.40% [2.77% - 4.15%]\n\n\n67\nPPC (95%CI)\n3.40% [2.77% - 4.15%]\n\n\n68\nPPC (95%CI)\n3.17% [2.57% - 3.91%]\n\n\n69\nPPC (95%CI)\n3.17% [2.57% - 3.91%]\n\n\n70\nPPC (95%CI)\n3.10% [2.51% - 3.82%]\n\n\n71\nPPC (95%CI)\n3.10% [2.51% - 3.82%]\n\n\n72\nPPC (95%CI)\n3.06% [2.47% - 3.78%]\n\n\n73\nPPC (95%CI)\n2.87% [2.31% - 3.58%]\n\n\n74\nPPC (95%CI)\n2.84% [2.27% - 3.54%]\n\n\n75\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n76\nPPC (95%CI)\n2.76% [2.21% - 3.45%]\n\n\n77\nPPC (95%CI)\n2.76% [2.21% - 3.45%]\n\n\n78\nPPC (95%CI)\n2.84% [2.27% - 3.54%]\n\n\n79\nPPC (95%CI)\n2.87% [2.31% - 3.58%]\n\n\n80\nPPC (95%CI)\n2.87% [2.31% - 3.58%]\n\n\n81\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n82\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n83\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n84\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n85\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n86\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n87\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n88\nPPC (95%CI)\n2.84% [2.27% - 3.54%]\n\n\n89\nPPC (95%CI)\n2.91% [2.34% - 3.62%]\n\n\n90\nPPC (95%CI)\n2.91% [2.34% - 3.62%]"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#proportion-of-patients-covered-2",
    "href": "Presentations/DrugUtilisation.html#proportion-of-patients-covered-2",
    "title": "DrugUtilisation",
    "section": "Proportion of patients covered",
    "text": "Proportion of patients covered\n\nplotProportionOfPatientsCovered(result)\n\n\n\ngapEra parameter can have a big impact in survival analysis, whereas it does not have such big impact on proportion of patients covered."
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching",
    "href": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching",
    "title": "DrugUtilisation",
    "section": "Drug restart and drug switching",
    "text": "Drug restart and drug switching\nWe have the ability to study drug restart or drug switching after a discontinuation:\n\nSwitching cohorts must be defined in advance.\nWe have to define the windows of interest.\nIndex date will be the date of discontinuation.\nReported percentages in each window will be:\nRestart: individuals that restarted and not switched.\nSwitch: individuals that switched and not restarted.\nRestart and switch: individuals that restarted and switched.\nUntreated: individuals that did not restart or switch."
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-1",
    "href": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-1",
    "title": "DrugUtilisation",
    "section": "Drug restart and drug switching",
    "text": "Drug restart and drug switching\nLetâ€™s define the cohorts of interest for switching:\n\ncodelist &lt;- getDrugIngredientCodes(\n  cdm = cdm, \n  name = c(\"clopidogrel\", \"simvastatin\", \"warfarin\"), \n  nameStyle = \"{concept_name}\"\n)\ncdm$switch &lt;- conceptCohort(\n  cdm = cdm, \n  name = \"switch\",\n  conceptSet = codelist\n)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-2",
    "href": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-2",
    "title": "DrugUtilisation",
    "section": "Drug restart and drug switching",
    "text": "Drug restart and drug switching\nWe have to be careful with the inclusion criteria of the input cohort, as restart is derived from it.\n\n\nresult &lt;- cdm$dus_cohort |&gt;\n  summariseDrugRestart(\n    switchCohortTable = \"switch\", \n    followUpDays = c(90, 180, 270, 360), \n    restrictToFirstDiscontinuation = TRUE\n  )\nresult |&gt;\n  glimpse()\n\nRows: 32\nColumns: 13\n$ result_id        &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1\n$ cdm_name         &lt;chr&gt; \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBlâ€¦\n$ group_name       &lt;chr&gt; \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"coâ€¦\n$ group_level      &lt;chr&gt; \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetamiâ€¦\n$ strata_name      &lt;chr&gt; \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overâ€¦\n$ strata_level     &lt;chr&gt; \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overâ€¦\n$ variable_name    &lt;chr&gt; \"Drug restart in 90 days\", \"Drug restart in 90 days\", \"Drug restart in 90 days\", \"Drug restarâ€¦\n$ variable_level   &lt;chr&gt; \"restart\", \"restart\", \"switch\", \"switch\", \"restart and switch\", \"restart and switch\", \"untreaâ€¦\n$ estimate_name    &lt;chr&gt; \"count\", \"percentage\", \"count\", \"percentage\", \"count\", \"percentage\", \"count\", \"percentage\", \"â€¦\n$ estimate_type    &lt;chr&gt; \"integer\", \"percentage\", \"integer\", \"percentage\", \"integer\", \"percentage\", \"integer\", \"percenâ€¦\n$ estimate_value   &lt;chr&gt; \"43\", \"1.60507652108996\", \"0\", \"0\", \"0\", \"0\", \"2636\", \"98.39492347891\", \"97\", \"3.620754012691â€¦\n$ additional_name  &lt;chr&gt; \"follow_up_days\", \"follow_up_days\", \"follow_up_days\", \"follow_up_days\", \"follow_up_days\", \"foâ€¦\n$ additional_level &lt;chr&gt; \"90 days\", \"90 days\", \"90 days\", \"90 days\", \"90 days\", \"90 days\", \"90 days\", \"90 days\", \"180 â€¦"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-3",
    "href": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-3",
    "title": "DrugUtilisation",
    "section": "Drug restart and drug switching",
    "text": "Drug restart and drug switching\n\n\ntableDrugRestart(result)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCDM name\n\n\n\n\n\nGiBleed\n\n\n\nTreatment\nEstimate name\n\nCohort name\n\n\n\nacetaminophen\n\n\n\n\nDrug restart in 90 days\n\n\nrestart\nN (%)\n43 (1.61 %)\n\n\nswitch\nN (%)\n0 (0.00 %)\n\n\nrestart and switch\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,636 (98.39 %)\n\n\nDrug restart in 180 days\n\n\nrestart\nN (%)\n97 (3.62 %)\n\n\nswitch\nN (%)\n0 (0.00 %)\n\n\nrestart and switch\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,582 (96.38 %)\n\n\nDrug restart in 270 days\n\n\nrestart\nN (%)\n175 (6.53 %)\n\n\nswitch\nN (%)\n0 (0.00 %)\n\n\nrestart and switch\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,504 (93.47 %)\n\n\nDrug restart in 360 days\n\n\nrestart\nN (%)\n244 (9.11 %)\n\n\nswitch\nN (%)\n1 (0.04 %)\n\n\nrestart and switch\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,434 (90.85 %)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-4",
    "href": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-4",
    "title": "DrugUtilisation",
    "section": "Drug restart and drug switching",
    "text": "Drug restart and drug switching\n\nplotDrugRestart(result)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-treatments",
    "href": "Presentations/DrugUtilisation.html#summarise-treatments",
    "title": "DrugUtilisation",
    "section": "Summarise treatments",
    "text": "Summarise treatments\nsummariseTreatment() is a general function to analyse presence of treatments (cohorts) after an index date. This can be used with many different purposes:\n\nSummarise treatments after a certain condition\nAnalyse comedications\nAnalyse treatments after discontinuation\nâ€¦"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#lets-create-some-treatments-cohorts",
    "href": "Presentations/DrugUtilisation.html#lets-create-some-treatments-cohorts",
    "title": "DrugUtilisation",
    "section": "Letâ€™s create some treatments cohorts",
    "text": "Letâ€™s create some treatments cohorts\n\ncodelist &lt;- getDrugIngredientCodes(\n  cdm = cdm, \n  name = c(\"clopidogrel\", \"simvastatin\", \"warfarin\", \"nitroglycerin\"),\n  nameStyle = \"{concept_name}\"\n)\ncdm$treatments &lt;- conceptCohort(\n  cdm = cdm, \n  name = \"treatments\",\n  conceptSet = codelist\n)\ncdm$osteoarthritis &lt;- conceptCohort(\n  cdm = cdm,\n  conceptSet = list(osteoarthritis = 80180L),\n  name = \"osteoarthritis\"\n)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-treatments-after-condition",
    "href": "Presentations/DrugUtilisation.html#summarise-treatments-after-condition",
    "title": "DrugUtilisation",
    "section": "Summarise treatments after condition",
    "text": "Summarise treatments after condition\n\nresult &lt;- cdm$osteoarthritis |&gt;\n  summariseTreatment(\n    window = list(c(1, 90), c(91, 180), c(181, 270), c(271, 360)), \n    treatmentCohortName = \"treatments\", \n    indexDate = \"cohort_start_date\", \n    censorDate = NULL\n  )"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-treatments-after-condition-1",
    "href": "Presentations/DrugUtilisation.html#summarise-treatments-after-condition-1",
    "title": "DrugUtilisation",
    "section": "Summarise treatments after condition",
    "text": "Summarise treatments after condition\n\n\ntableTreatment(result, style = \"darwin\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCDM name\n\n\n\n\n\nGiBleed\n\n\n\nTreatment\nEstimate name\n\nCohort name\n\n\n\nosteoarthritis\n\n\n\n\nMedication from 1 day after to 90 days after the index date\n\n\nclopidogrel\nN (%)\n9 (0.34 %)\n\n\nnitroglycerin\nN (%)\n20 (0.76 %)\n\n\nsimvastatin\nN (%)\n1 (0.04 %)\n\n\nwarfarin\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,608 (99.16 %)\n\n\nnot in observation\nN (%)\n0 (0.00 %)\n\n\nMedication from 91 days after to 180 days after the index date\n\n\nclopidogrel\nN (%)\n10 (0.38 %)\n\n\nnitroglycerin\nN (%)\n20 (0.76 %)\n\n\nsimvastatin\nN (%)\n0 (0.00 %)\n\n\nwarfarin\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,583 (98.21 %)\n\n\nnot in observation\nN (%)\n25 (0.95 %)\n\n\nMedication from 181 days after to 270 days after the index date\n\n\nclopidogrel\nN (%)\n9 (0.34 %)\n\n\nnitroglycerin\nN (%)\n20 (0.76 %)\n\n\nsimvastatin\nN (%)\n1 (0.04 %)\n\n\nwarfarin\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,569 (97.68 %)\n\n\nnot in observation\nN (%)\n40 (1.52 %)\n\n\nMedication from 271 days after to 360 days after the index date\n\n\nclopidogrel\nN (%)\n11 (0.42 %)\n\n\nnitroglycerin\nN (%)\n21 (0.80 %)\n\n\nsimvastatin\nN (%)\n1 (0.04 %)\n\n\nwarfarin\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,547 (96.84 %)\n\n\nnot in observation\nN (%)\n60 (2.28 %)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-treatments-after-condition-2",
    "href": "Presentations/DrugUtilisation.html#summarise-treatments-after-condition-2",
    "title": "DrugUtilisation",
    "section": "Summarise treatments after condition",
    "text": "Summarise treatments after condition\n\nplotTreatment(result)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-treatments-after-discontinuation",
    "href": "Presentations/DrugUtilisation.html#summarise-treatments-after-discontinuation",
    "title": "DrugUtilisation",
    "section": "Summarise treatments after discontinuation",
    "text": "Summarise treatments after discontinuation\n\nresult &lt;- cdm$dus_cohort |&gt;\n  summariseTreatment(\n    window = list(c(1, 90), c(91, 180), c(181, 270), c(271, 360)), \n    treatmentCohortName = \"treatments\", \n    indexDate = \"cohort_end_date\", \n    censorDate = NULL\n  )"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-treatments-after-discontinuation-1",
    "href": "Presentations/DrugUtilisation.html#summarise-treatments-after-discontinuation-1",
    "title": "DrugUtilisation",
    "section": "Summarise treatments after discontinuation",
    "text": "Summarise treatments after discontinuation\n\nplotTreatment(result)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-comedications",
    "href": "Presentations/DrugUtilisation.html#summarise-comedications",
    "title": "DrugUtilisation",
    "section": "Summarise comedications",
    "text": "Summarise comedications\n\ncomedications &lt;- cdm$dus_cohort |&gt;\n  summariseTreatment(\n    window = c(0, Inf), \n    treatmentCohortName = \"treatments\", \n    indexDate = \"cohort_start_date\", \n    censorDate = \"cohort_end_date\"\n  )"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-comedications-1",
    "href": "Presentations/DrugUtilisation.html#summarise-comedications-1",
    "title": "DrugUtilisation",
    "section": "Summarise comedications",
    "text": "Summarise comedications\n\nplotTreatment(comedications, style = \"darwin\")"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drugutilisation",
    "href": "Presentations/DrugUtilisation.html#drugutilisation",
    "title": "DrugUtilisation",
    "section": "DrugUtilisation",
    "text": "DrugUtilisation\n\n\nðŸ‘‰ Packages website\nðŸ‘‰ CRAN link\nðŸ‘‰ Manual\nðŸ“§ marti.catalasabate@ndorms.ox.ac.uk"
  },
  {
    "objectID": "Presentations/index.html",
    "href": "Presentations/index.html",
    "title": "Presentations",
    "section": "",
    "text": "Presentations\n\nAllOfUs\nDrugUtilisation"
  },
  {
    "objectID": "Presentations/allofus/index.html#allofus-r-package-authors",
    "href": "Presentations/allofus/index.html#allofus-r-package-authors",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "allofus R package authors",
    "text": "allofus R package authors\n\n\n\nLouisa Smith\n\nAssistant Professor at Northeastern University in the department of Public Health and Health Sciences and at the Roux Institute\n\n\n\n\n\nRob Cavanaugh\n\nAssistant Professor at the Massachusetts General Hospital Institute for Health Professions with appointments in Communication Science and Disorders and Genetic Counseling"
  },
  {
    "objectID": "Presentations/allofus/index.html#all-of-us-research-program",
    "href": "Presentations/allofus/index.html#all-of-us-research-program",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "All of Us Research Program",
    "text": "All of Us Research Program\n\nLaunched in 2018 by the National Institutes of Health (NIH)\nGoal: gather data from 1 million or more people living in the United States to accelerate research and improve health\n\nData types: EHR, surveys, physical measurements, genomics, wearables\nRight now about 600,000 have EHR, initial surveys, physical measurements, biospecimens"
  },
  {
    "objectID": "Presentations/allofus/index.html#all-of-us-researcher-workbench",
    "href": "Presentations/allofus/index.html#all-of-us-researcher-workbench",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "All of Us Researcher Workbench",
    "text": "All of Us Researcher Workbench\n\nCloud-based platform to access All of Us data for analysis\nData stored in Google BigQuery in the OMOP Common Data Model\nAccess directly via SQL queries or using Cohort Builder tool\nAnalysis in R, Python, or SAS"
  },
  {
    "objectID": "Presentations/allofus/index.html#costs",
    "href": "Presentations/allofus/index.html#costs",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Costs",
    "text": "Costs"
  },
  {
    "objectID": "Presentations/allofus/index.html#costs-1",
    "href": "Presentations/allofus/index.html#costs-1",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Costs",
    "text": "Costs"
  },
  {
    "objectID": "Presentations/allofus/index.html#cohort-builder",
    "href": "Presentations/allofus/index.html#cohort-builder",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Cohort Builder",
    "text": "Cohort Builder"
  },
  {
    "objectID": "Presentations/allofus/index.html#concept-set-builder",
    "href": "Presentations/allofus/index.html#concept-set-builder",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Concept Set Builder",
    "text": "Concept Set Builder"
  },
  {
    "objectID": "Presentations/allofus/index.html#dataset-builder",
    "href": "Presentations/allofus/index.html#dataset-builder",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Dataset Builder",
    "text": "Dataset Builder"
  },
  {
    "objectID": "Presentations/allofus/index.html#creates-code",
    "href": "Presentations/allofus/index.html#creates-code",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Creates code",
    "text": "Creates code"
  },
  {
    "objectID": "Presentations/allofus/index.html#code-writes-csv-files",
    "href": "Presentations/allofus/index.html#code-writes-csv-files",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Code writes csv files",
    "text": "Code writes csv files\n\n# Formulate a Cloud Storage destination path for the data exported from BigQuery.\n# NOTE: By default data exported multiple times on the same day will overwrite older copies.\n#       But data exported on a different days will write to a new location so that historical\n#       copies can be kept as the dataset definition is changed.\nsurvey_61548618_path &lt;- file.path(\n  Sys.getenv(\"WORKSPACE_BUCKET\"),\n  \"bq_exports\",\n  Sys.getenv(\"OWNER_EMAIL\"),\n  strftime(lubridate::now(), \"%Y%m%d\"),  # Comment out this line if you want the export to always overwrite.\n  \"survey_61548618\",\n  \"survey_61548618_*.csv\")\nmessage(str_glue('The data will be written to {survey_61548618_path}. Use this path when reading ',\n                 'the data into your notebooks in the future.'))\n\n# Perform the query and export the dataset to Cloud Storage as CSV files.\n# NOTE: You only need to run `bq_table_save` once. After that, you can\n#       just read data from the CSVs in Cloud Storage.\nbq_table_save(\n  bq_dataset_query(Sys.getenv(\"WORKSPACE_CDR\"), dataset_61548618_survey_sql, billing = Sys.getenv(\"GOOGLE_PROJECT\")),\n  survey_61548618_path,\n  destination_format = \"CSV\")\n\n\n# Read the data directly from Cloud Storage into memory.\n# NOTE: Alternatively you can `gsutil -m cp {survey_61548618_path}` to copy these files\n#       to the Jupyter disk.\nread_bq_export_from_workspace_bucket &lt;- function(export_path) {\n  col_types &lt;- cols(survey = col_character(), question = col_character(), answer = col_character(), survey_version_name = col_character())\n  bind_rows(\n    map(system2('gsutil', args = c('ls', export_path), stdout = TRUE, stderr = TRUE),\n        function(csv) {\n          message(str_glue('Loading {csv}.'))\n          chunk &lt;- read_csv(pipe(str_glue('gsutil cat {csv}')), col_types = col_types, show_col_types = FALSE)\n          if (is.null(col_types)) {\n            col_types &lt;- spec(chunk)\n          }\n          chunk\n        }))\n}\ndataset_61548618_survey_df &lt;- read_bq_export_from_workspace_bucket(survey_61548618_path)"
  },
  {
    "objectID": "Presentations/allofus/index.html#challenges",
    "href": "Presentations/allofus/index.html#challenges",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Challenges",
    "text": "Challenges\n\nPoint-and-click tools very limited, results in huge csv files\nBut lack of programming skillsâ€¦\n\nHealth researchers often use R or SAS, some use python, few use SQL\ntidyverse is (the most?) popular framework for R\n\nAll of Us data is complex\n\nthe OMOP CDM has a steep learning curve, plus the complexity of the other data (e.g., surveys)\nmany researchers are trained on cleaner, more straightforward data\n\nLarge scale observational health research is hard\n\ndefining cohorts with appropriate inclusion/exclusion criteria, exposure/outcome phenotypes, time under observation, etc.\nreproducibility is critical"
  },
  {
    "objectID": "Presentations/allofus/index.html#allofus-r-package",
    "href": "Presentations/allofus/index.html#allofus-r-package",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "allofus R package",
    "text": "allofus R package\n\n\n\n\n\nBuild on existing tools/skills\nEnable complex research\nEfficient (compared to built-in tools)\nReadable and reproducible"
  },
  {
    "objectID": "Presentations/allofus/index.html#begin-in-r-not-cohort-builder",
    "href": "Presentations/allofus/index.html#begin-in-r-not-cohort-builder",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Begin in R, not Cohort Builder",
    "text": "Begin in R, not Cohort Builder\n\nlibrary(allofus)\nlibrary(tidyverse)\n\ncon &lt;- aou_connect()\n\nError:\n! Unable to connect to CDR"
  },
  {
    "objectID": "Presentations/allofus/index.html#access-tables",
    "href": "Presentations/allofus/index.html#access-tables",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Access tables",
    "text": "Access tables\nUnder the hood, dbplyr (part of the tidyverse) allows researchers to use many of the same functions on a remote table that they would use on a dataframe\n\nperson &lt;- tbl(con, \"person\")\n\nError: object 'con' not found\n\ncolnames(person)\n\nNULL"
  },
  {
    "objectID": "Presentations/allofus/index.html#quick-data-manipulations-and-computations",
    "href": "Presentations/allofus/index.html#quick-data-manipulations-and-computations",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Quick data manipulations and computations",
    "text": "Quick data manipulations and computations\nUsers are running SQL queries without realizing theyâ€™re running SQL queries\n\nperson |&gt;\n  mutate(birth_decade = cut(year_of_birth, \n                            breaks = c(1930, 1940, 1950, 1960, 1970, \n                                       1980, 1990, 2000, 2010))) |&gt;\n  count(birth_decade)\n\nError in UseMethod(\"mutate\"): no applicable method for 'mutate' applied to an object of class \"function\""
  },
  {
    "objectID": "Presentations/allofus/index.html#creating-cohorts-with-allofus",
    "href": "Presentations/allofus/index.html#creating-cohorts-with-allofus",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Creating cohorts with allofus",
    "text": "Creating cohorts with allofus\n\nreproductive_age_female &lt;- tbl(con, \"cb_search_person\") |&gt; \n  filter(age_at_consent &gt;= 18 & age_at_consent &lt;= 55, \n         sex_at_birth == \"Female\")\n\nError: object 'con' not found\n\nhypertensive_disorder &lt;- tbl(con, \"concept_ancestor\") |&gt; \n  filter(ancestor_concept_id == 316866) |&gt; \n  inner_join(\n    tbl(con, \"condition_occurrence\"), \n    by = join_by(descendant_concept_id == condition_concept_id)) |&gt; \n  distinct(person_id)\n\nError: object 'con' not found\n\ncohort &lt;- reproductive_age_female |&gt; \n  inner_join(hypertensive_disorder, by = join_by(person_id))\n\nError: object 'reproductive_age_female' not found\n\ntally(cohort)\n\nError: object 'cohort' not found"
  },
  {
    "objectID": "Presentations/allofus/index.html#creating-datasets-with-cohort-builder",
    "href": "Presentations/allofus/index.html#creating-datasets-with-cohort-builder",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Creating datasets with Cohort Builder",
    "text": "Creating datasets with Cohort Builder\n\nlibrary(tidyverse)\nlibrary(bigrquery)\n\n# This query represents dataset \"hypertension in pregnancy\" for domain \"person\" and was generated for All of Us Registered Tier Dataset v7\ndataset_71250616_person_sql &lt;- paste(\"\n    SELECT\n        person.person_id,\n        person.gender_concept_id,\n        p_gender_concept.concept_name as gender,\n        person.birth_datetime as date_of_birth,\n        person.race_concept_id,\n        p_race_concept.concept_name as race,\n        person.ethnicity_concept_id,\n        p_ethnicity_concept.concept_name as ethnicity,\n        person.sex_at_birth_concept_id,\n        p_sex_at_birth_concept.concept_name as sex_at_birth \n    FROM\n        `person` person \n    LEFT JOIN\n        `concept` p_gender_concept \n            ON person.gender_concept_id = p_gender_concept.concept_id \n    LEFT JOIN\n        `concept` p_race_concept \n            ON person.race_concept_id = p_race_concept.concept_id \n    LEFT JOIN\n        `concept` p_ethnicity_concept \n            ON person.ethnicity_concept_id = p_ethnicity_concept.concept_id \n    LEFT JOIN\n        `concept` p_sex_at_birth_concept \n            ON person.sex_at_birth_concept_id = p_sex_at_birth_concept.concept_id  \n    WHERE\n        person.PERSON_ID IN (SELECT\n            distinct person_id  \n        FROM\n            `cb_search_person` cb_search_person  \n        WHERE\n            cb_search_person.person_id IN (SELECT\n                person_id \n            FROM\n                `cb_search_person` p \n            WHERE\n                age_at_consent BETWEEN 18 AND 50 \n            AND cb_search_person.person_id IN (SELECT\n                person_id \n            FROM\n                `person` p \n            WHERE\n                sex_at_birth_concept_id IN (45878463) ) \n            AND cb_search_person.person_id IN (SELECT\n                criteria.person_id \n            FROM\n                (SELECT\n                    DISTINCT person_id, entry_date, concept_id \n                FROM\n                    `cb_search_all_events` \n                WHERE\n                    (concept_id IN(SELECT\n                        DISTINCT c.concept_id \n                    FROM\n                        `cb_criteria` c \n                    JOIN\n                        (SELECT\n                            CAST(cr.id as string) AS id       \n                        FROM\n                            `cb_criteria` cr       \n                        WHERE\n                            concept_id IN (316866)       \n                            AND full_text LIKE '%_rank1]%'      ) a \n                            ON (c.path LIKE CONCAT('%.', a.id, '.%') \n                            OR c.path LIKE CONCAT('%.', a.id) \n                            OR c.path LIKE CONCAT(a.id, '.%') \n                            OR c.path = a.id) \n                    WHERE\n                        is_standard = 1 \n                        AND is_selectable = 1) \n                    AND is_standard = 1 )) criteria ) )\", sep=\"\")\n\n# Formulate a Cloud Storage destination path for the data exported from BigQuery.\n# NOTE: By default data exported multiple times on the same day will overwrite older copies.\n#       But data exported on a different days will write to a new location so that historical\n#       copies can be kept as the dataset definition is changed.\nperson_71250616_path &lt;- file.path(\n  Sys.getenv(\"WORKSPACE_BUCKET\"),\n  \"bq_exports\",\n  Sys.getenv(\"OWNER_EMAIL\"),\n  strftime(lubridate::now(), \"%Y%m%d\"),  # Comment out this line if you want the export to always overwrite.\n  \"person_71250616\",\n  \"person_71250616_*.csv\")\nmessage(str_glue('The data will be written to {person_71250616_path}. Use this path when reading ',\n                 'the data into your notebooks in the future.'))\n\n# Perform the query and export the dataset to Cloud Storage as CSV files.\n# NOTE: You only need to run `bq_table_save` once. After that, you can\n#       just read data from the CSVs in Cloud Storage.\nbq_table_save(\n  bq_dataset_query(Sys.getenv(\"WORKSPACE_CDR\"), dataset_71250616_person_sql, billing = Sys.getenv(\"GOOGLE_PROJECT\")),\n  person_71250616_path,\n  destination_format = \"CSV\")\n\n\n# Read the data directly from Cloud Storage into memory.\n# NOTE: Alternatively you can `gsutil -m cp {person_71250616_path}` to copy these files\n#       to the Jupyter disk.\nread_bq_export_from_workspace_bucket &lt;- function(export_path) {\n  col_types &lt;- cols(gender = col_character(), race = col_character(), ethnicity = col_character(), sex_at_birth = col_character())\n  bind_rows(\n    map(system2('gsutil', args = c('ls', export_path), stdout = TRUE, stderr = TRUE),\n        function(csv) {\n          message(str_glue('Loading {csv}.'))\n          chunk &lt;- read_csv(pipe(str_glue('gsutil cat {csv}')), col_types = col_types, show_col_types = FALSE)\n          if (is.null(col_types)) {\n            col_types &lt;- spec(chunk)\n          }\n          chunk\n        }))\n}\ndataset_71250616_person_df &lt;- read_bq_export_from_workspace_bucket(person_71250616_path)\n\ndim(dataset_71250616_person_df)\n\nhead(dataset_71250616_person_df, 5)\nlibrary(tidyverse)\nlibrary(bigrquery)\n\n# This query represents dataset \"hypertension in pregnancy\" for domain \"condition\" and was generated for All of Us Registered Tier Dataset v7\ndataset_71250616_condition_sql &lt;- paste(\"\n    SELECT\n        c_occurrence.person_id,\n        c_occurrence.condition_concept_id,\n        c_standard_concept.concept_name as standard_concept_name,\n        c_standard_concept.concept_code as standard_concept_code,\n        c_standard_concept.vocabulary_id as standard_vocabulary,\n        c_occurrence.condition_start_datetime,\n        c_occurrence.condition_end_datetime,\n        c_occurrence.condition_type_concept_id,\n        c_type.concept_name as condition_type_concept_name,\n        c_occurrence.stop_reason,\n        c_occurrence.visit_occurrence_id,\n        visit.concept_name as visit_occurrence_concept_name,\n        c_occurrence.condition_source_value,\n        c_occurrence.condition_source_concept_id,\n        c_source_concept.concept_name as source_concept_name,\n        c_source_concept.concept_code as source_concept_code,\n        c_source_concept.vocabulary_id as source_vocabulary,\n        c_occurrence.condition_status_source_value,\n        c_occurrence.condition_status_concept_id,\n        c_status.concept_name as condition_status_concept_name \n    FROM\n        ( SELECT\n            * \n        FROM\n            `condition_occurrence` c_occurrence \n        WHERE\n            (\n                condition_concept_id IN (SELECT\n                    DISTINCT c.concept_id \n                FROM\n                    `cb_criteria` c \n                JOIN\n                    (SELECT\n                        CAST(cr.id as string) AS id       \n                    FROM\n                        `cb_criteria` cr       \n                    WHERE\n                        concept_id IN (132685, 133816, 134414, 135601, 136743, 137613, 138811, 141084, 314090, 35622939, 4034096, 4057976, 4116344, 4283352, 433536, 438490, 439077, 439393, 443700)       \n                        AND full_text LIKE '%_rank1]%'      ) a \n                        ON (c.path LIKE CONCAT('%.', a.id, '.%') \n                        OR c.path LIKE CONCAT('%.', a.id) \n                        OR c.path LIKE CONCAT(a.id, '.%') \n                        OR c.path = a.id) \n                WHERE\n                    is_standard = 1 \n                    AND is_selectable = 1)\n            )  \n            AND (\n                c_occurrence.PERSON_ID IN (SELECT\n                    distinct person_id  \n                FROM\n                    `cb_search_person` cb_search_person  \n                WHERE\n                    cb_search_person.person_id IN (SELECT\n                        person_id \n                    FROM\n                        `cb_search_person` p \n                    WHERE\n                        age_at_consent BETWEEN 18 AND 50 \n                    AND cb_search_person.person_id IN (SELECT\n                        person_id \n                    FROM\n                        `person` p \n                    WHERE\n                        sex_at_birth_concept_id IN (45878463) ) \n                    AND cb_search_person.person_id IN (SELECT\n                        criteria.person_id \n                    FROM\n                        (SELECT\n                            DISTINCT person_id, entry_date, concept_id \n                        FROM\n                            `cb_search_all_events` \n                        WHERE\n                            (concept_id IN(SELECT\n                                DISTINCT c.concept_id \n                            FROM\n                                `cb_criteria` c \n                            JOIN\n                                (SELECT\n                                    CAST(cr.id as string) AS id       \n                                FROM\n                                    `cb_criteria` cr       \n                                WHERE\n                                    concept_id IN (316866)       \n                                    AND full_text LIKE '%_rank1]%'      ) a \n                                    ON (c.path LIKE CONCAT('%.', a.id, '.%') \n                                    OR c.path LIKE CONCAT('%.', a.id) \n                                    OR c.path LIKE CONCAT(a.id, '.%') \n                                    OR c.path = a.id) \n                            WHERE\n                                is_standard = 1 \n                                AND is_selectable = 1) \n                            AND is_standard = 1 )) criteria ) )\n            )) c_occurrence \n    LEFT JOIN\n        `concept` c_standard_concept \n            ON c_occurrence.condition_concept_id = c_standard_concept.concept_id \n    LEFT JOIN\n        `concept` c_type \n            ON c_occurrence.condition_type_concept_id = c_type.concept_id \n    LEFT JOIN\n        `visit_occurrence` v \n            ON c_occurrence.visit_occurrence_id = v.visit_occurrence_id \n    LEFT JOIN\n        `concept` visit \n            ON v.visit_concept_id = visit.concept_id \n    LEFT JOIN\n        `concept` c_source_concept \n            ON c_occurrence.condition_source_concept_id = c_source_concept.concept_id \n    LEFT JOIN\n        `concept` c_status \n            ON c_occurrence.condition_status_concept_id = c_status.concept_id\", sep=\"\")\n\n# Formulate a Cloud Storage destination path for the data exported from BigQuery.\n# NOTE: By default data exported multiple times on the same day will overwrite older copies.\n#       But data exported on a different days will write to a new location so that historical\n#       copies can be kept as the dataset definition is changed.\ncondition_71250616_path &lt;- file.path(\n  Sys.getenv(\"WORKSPACE_BUCKET\"),\n  \"bq_exports\",\n  Sys.getenv(\"OWNER_EMAIL\"),\n  strftime(lubridate::now(), \"%Y%m%d\"),  # Comment out this line if you want the export to always overwrite.\n  \"condition_71250616\",\n  \"condition_71250616_*.csv\")\nmessage(str_glue('The data will be written to {condition_71250616_path}. Use this path when reading ',\n                 'the data into your notebooks in the future.'))\n\n# Perform the query and export the dataset to Cloud Storage as CSV files.\n# NOTE: You only need to run `bq_table_save` once. After that, you can\n#       just read data from the CSVs in Cloud Storage.\nbq_table_save(\n  bq_dataset_query(Sys.getenv(\"WORKSPACE_CDR\"), dataset_71250616_condition_sql, billing = Sys.getenv(\"GOOGLE_PROJECT\")),\n  condition_71250616_path,\n  destination_format = \"CSV\")\n\n\n# Read the data directly from Cloud Storage into memory.\n# NOTE: Alternatively you can `gsutil -m cp {condition_71250616_path}` to copy these files\n#       to the Jupyter disk.\nread_bq_export_from_workspace_bucket &lt;- function(export_path) {\n  col_types &lt;- cols(standard_concept_name = col_character(), standard_concept_code = col_character(), standard_vocabulary = col_character(), condition_type_concept_name = col_character(), stop_reason = col_character(), visit_occurrence_concept_name = col_character(), condition_source_value = col_character(), source_concept_name = col_character(), source_concept_code = col_character(), source_vocabulary = col_character(), condition_status_source_value = col_character(), condition_status_concept_name = col_character())\n  bind_rows(\n    map(system2('gsutil', args = c('ls', export_path), stdout = TRUE, stderr = TRUE),\n        function(csv) {\n          message(str_glue('Loading {csv}.'))\n          chunk &lt;- read_csv(pipe(str_glue('gsutil cat {csv}')), col_types = col_types, show_col_types = FALSE)\n          if (is.null(col_types)) {\n            col_types &lt;- spec(chunk)\n          }\n          chunk\n        }))\n}\ndataset_71250616_condition_df &lt;- read_bq_export_from_workspace_bucket(condition_71250616_path)\n\ndim(dataset_71250616_condition_df)\n\nhead(dataset_71250616_condition_df, 5)\nlibrary(tidyverse)\nlibrary(bigrquery)\n\n# This query represents dataset \"hypertension in pregnancy\" for domain \"measurement\" and was generated for All of Us Registered Tier Dataset v7\ndataset_71250616_measurement_sql &lt;- paste(\"\n    SELECT\n        measurement.person_id,\n        measurement.measurement_concept_id,\n        m_standard_concept.concept_name as standard_concept_name,\n        m_standard_concept.concept_code as standard_concept_code,\n        m_standard_concept.vocabulary_id as standard_vocabulary,\n        measurement.measurement_datetime,\n        measurement.measurement_type_concept_id,\n        m_type.concept_name as measurement_type_concept_name,\n        measurement.operator_concept_id,\n        m_operator.concept_name as operator_concept_name,\n        measurement.value_as_number,\n        measurement.value_as_concept_id,\n        m_value.concept_name as value_as_concept_name,\n        measurement.unit_concept_id,\n        m_unit.concept_name as unit_concept_name,\n        measurement.range_low,\n        measurement.range_high,\n        measurement.visit_occurrence_id,\n        m_visit.concept_name as visit_occurrence_concept_name,\n        measurement.measurement_source_value,\n        measurement.measurement_source_concept_id,\n        m_source_concept.concept_name as source_concept_name,\n        m_source_concept.concept_code as source_concept_code,\n        m_source_concept.vocabulary_id as source_vocabulary,\n        measurement.unit_source_value,\n        measurement.value_source_value \n    FROM\n        ( SELECT\n            * \n        FROM\n            `measurement` measurement \n        WHERE\n            (\n                measurement_concept_id IN (SELECT\n                    DISTINCT c.concept_id \n                FROM\n                    `cb_criteria` c \n                JOIN\n                    (SELECT\n                        CAST(cr.id as string) AS id       \n                    FROM\n                        `cb_criteria` cr       \n                    WHERE\n                        concept_id IN (21490851, 21490853, 3004249, 3005606, 3009395, 3012526, 3012888, 3013940, 3017490, 3018586, 3018592, 3018822, 3019962, 3027598, 3028737, 3031203, 3034703, 3035856, 36716965, 4060834, 40758413, 4152194, 4154790, 4232915, 4239021, 4248524, 4298393, 4302410, 44789315, 44789316)       \n                        AND full_text LIKE '%_rank1]%'      ) a \n                        ON (c.path LIKE CONCAT('%.', a.id, '.%') \n                        OR c.path LIKE CONCAT('%.', a.id) \n                        OR c.path LIKE CONCAT(a.id, '.%') \n                        OR c.path = a.id) \n                WHERE\n                    is_standard = 1 \n                    AND is_selectable = 1)\n            )  \n            AND (\n                measurement.PERSON_ID IN (SELECT\n                    distinct person_id  \n                FROM\n                    `cb_search_person` cb_search_person  \n                WHERE\n                    cb_search_person.person_id IN (SELECT\n                        person_id \n                    FROM\n                        `cb_search_person` p \n                    WHERE\n                        age_at_consent BETWEEN 18 AND 50 \n                    AND cb_search_person.person_id IN (SELECT\n                        person_id \n                    FROM\n                        `person` p \n                    WHERE\n                        sex_at_birth_concept_id IN (45878463) ) \n                    AND cb_search_person.person_id IN (SELECT\n                        criteria.person_id \n                    FROM\n                        (SELECT\n                            DISTINCT person_id, entry_date, concept_id \n                        FROM\n                            `cb_search_all_events` \n                        WHERE\n                            (concept_id IN(SELECT\n                                DISTINCT c.concept_id \n                            FROM\n                                `cb_criteria` c \n                            JOIN\n                                (SELECT\n                                    CAST(cr.id as string) AS id       \n                                FROM\n                                    `cb_criteria` cr       \n                                WHERE\n                                    concept_id IN (316866)       \n                                    AND full_text LIKE '%_rank1]%'      ) a \n                                    ON (c.path LIKE CONCAT('%.', a.id, '.%') \n                                    OR c.path LIKE CONCAT('%.', a.id) \n                                    OR c.path LIKE CONCAT(a.id, '.%') \n                                    OR c.path = a.id) \n                            WHERE\n                                is_standard = 1 \n                                AND is_selectable = 1) \n                            AND is_standard = 1 )) criteria ) )\n            )) measurement \n    LEFT JOIN\n        `concept` m_standard_concept \n            ON measurement.measurement_concept_id = m_standard_concept.concept_id \n    LEFT JOIN\n        `concept` m_type \n            ON measurement.measurement_type_concept_id = m_type.concept_id \n    LEFT JOIN\n        `concept` m_operator \n            ON measurement.operator_concept_id = m_operator.concept_id \n    LEFT JOIN\n        `concept` m_value \n            ON measurement.value_as_concept_id = m_value.concept_id \n    LEFT JOIN\n        `concept` m_unit \n            ON measurement.unit_concept_id = m_unit.concept_id \n    LEFT JOIn\n        `visit_occurrence` v \n            ON measurement.visit_occurrence_id = v.visit_occurrence_id \n    LEFT JOIN\n        `concept` m_visit \n            ON v.visit_concept_id = m_visit.concept_id \n    LEFT JOIN\n        `concept` m_source_concept \n            ON measurement.measurement_source_concept_id = m_source_concept.concept_id\", sep=\"\")\n\n# Formulate a Cloud Storage destination path for the data exported from BigQuery.\n# NOTE: By default data exported multiple times on the same day will overwrite older copies.\n#       But data exported on a different days will write to a new location so that historical\n#       copies can be kept as the dataset definition is changed.\nmeasurement_71250616_path &lt;- file.path(\n  Sys.getenv(\"WORKSPACE_BUCKET\"),\n  \"bq_exports\",\n  Sys.getenv(\"OWNER_EMAIL\"),\n  strftime(lubridate::now(), \"%Y%m%d\"),  # Comment out this line if you want the export to always overwrite.\n  \"measurement_71250616\",\n  \"measurement_71250616_*.csv\")\nmessage(str_glue('The data will be written to {measurement_71250616_path}. Use this path when reading ',\n                 'the data into your notebooks in the future.'))\n\n# Perform the query and export the dataset to Cloud Storage as CSV files.\n# NOTE: You only need to run `bq_table_save` once. After that, you can\n#       just read data from the CSVs in Cloud Storage.\nbq_table_save(\n  bq_dataset_query(Sys.getenv(\"WORKSPACE_CDR\"), dataset_71250616_measurement_sql, billing = Sys.getenv(\"GOOGLE_PROJECT\")),\n  measurement_71250616_path,\n  destination_format = \"CSV\")\n\n\n# Read the data directly from Cloud Storage into memory.\n# NOTE: Alternatively you can `gsutil -m cp {measurement_71250616_path}` to copy these files\n#       to the Jupyter disk.\nread_bq_export_from_workspace_bucket &lt;- function(export_path) {\n  col_types &lt;- cols(standard_concept_name = col_character(), standard_concept_code = col_character(), standard_vocabulary = col_character(), measurement_type_concept_name = col_character(), operator_concept_name = col_character(), value_as_concept_name = col_character(), unit_concept_name = col_character(), visit_occurrence_concept_name = col_character(), measurement_source_value = col_character(), source_concept_name = col_character(), source_concept_code = col_character(), source_vocabulary = col_character(), unit_source_value = col_character(), value_source_value = col_character())\n  bind_rows(\n    map(system2('gsutil', args = c('ls', export_path), stdout = TRUE, stderr = TRUE),\n        function(csv) {\n          message(str_glue('Loading {csv}.'))\n          chunk &lt;- read_csv(pipe(str_glue('gsutil cat {csv}')), col_types = col_types, show_col_types = FALSE)\n          if (is.null(col_types)) {\n            col_types &lt;- spec(chunk)\n          }\n          chunk\n        }))\n}\ndataset_71250616_measurement_df &lt;- read_bq_export_from_workspace_bucket(measurement_71250616_path)\n\ndim(dataset_71250616_measurement_df)\n\nhead(dataset_71250616_measurement_df, 5)\nlibrary(tidyverse)\nlibrary(bigrquery)\n\n# This query represents dataset \"hypertension in pregnancy\" for domain \"drug\" and was generated for All of Us Registered Tier Dataset v7\ndataset_71250616_drug_sql &lt;- paste(\"\n    SELECT\n        d_exposure.person_id,\n        d_exposure.drug_concept_id,\n        d_standard_concept.concept_name as standard_concept_name,\n        d_standard_concept.concept_code as standard_concept_code,\n        d_standard_concept.vocabulary_id as standard_vocabulary,\n        d_exposure.drug_exposure_start_datetime,\n        d_exposure.drug_exposure_end_datetime,\n        d_exposure.verbatim_end_date,\n        d_exposure.drug_type_concept_id,\n        d_type.concept_name as drug_type_concept_name,\n        d_exposure.stop_reason,\n        d_exposure.refills,\n        d_exposure.quantity,\n        d_exposure.days_supply,\n        d_exposure.sig,\n        d_exposure.route_concept_id,\n        d_route.concept_name as route_concept_name,\n        d_exposure.lot_number,\n        d_exposure.visit_occurrence_id,\n        d_visit.concept_name as visit_occurrence_concept_name,\n        d_exposure.drug_source_value,\n        d_exposure.drug_source_concept_id,\n        d_source_concept.concept_name as source_concept_name,\n        d_source_concept.concept_code as source_concept_code,\n        d_source_concept.vocabulary_id as source_vocabulary,\n        d_exposure.route_source_value,\n        d_exposure.dose_unit_source_value \n    FROM\n        ( SELECT\n            * \n        FROM\n            `drug_exposure` d_exposure \n        WHERE\n            (\n                drug_concept_id IN (SELECT\n                    DISTINCT ca.descendant_id \n                FROM\n                    `cb_criteria_ancestor` ca \n                JOIN\n                    (SELECT\n                        DISTINCT c.concept_id       \n                    FROM\n                        `cb_criteria` c       \n                    JOIN\n                        (SELECT\n                            CAST(cr.id as string) AS id             \n                        FROM\n                            `cb_criteria` cr             \n                        WHERE\n                            concept_id IN (21601664, 21601744)             \n                            AND full_text LIKE '%_rank1]%'       ) a \n                            ON (c.path LIKE CONCAT('%.', a.id, '.%') \n                            OR c.path LIKE CONCAT('%.', a.id) \n                            OR c.path LIKE CONCAT(a.id, '.%') \n                            OR c.path = a.id) \n                    WHERE\n                        is_standard = 1 \n                        AND is_selectable = 1) b \n                        ON (ca.ancestor_id = b.concept_id)))  \n                    AND (d_exposure.PERSON_ID IN (SELECT\n                        distinct person_id  \n                FROM\n                    `cb_search_person` cb_search_person  \n                WHERE\n                    cb_search_person.person_id IN (SELECT\n                        person_id \n                    FROM\n                        `cb_search_person` p \n                    WHERE\n                        age_at_consent BETWEEN 18 AND 50\n                    AND cb_search_person.person_id IN (SELECT\n                        person_id \n                    FROM\n                        `person` p \n                    WHERE\n                        sex_at_birth_concept_id IN (45878463) ) \n                    AND cb_search_person.person_id IN (SELECT\n                        criteria.person_id \n                    FROM\n                        (SELECT\n                            DISTINCT person_id, entry_date, concept_id \n                        FROM\n                            `cb_search_all_events` \n                        WHERE\n                            (concept_id IN(SELECT\n                                DISTINCT c.concept_id \n                            FROM\n                                `cb_criteria` c \n                            JOIN\n                                (SELECT\n                                    CAST(cr.id as string) AS id       \n                                FROM\n                                    `cb_criteria` cr       \n                                WHERE\n                                    concept_id IN (316866)       \n                                    AND full_text LIKE '%_rank1]%'      ) a \n                                    ON (c.path LIKE CONCAT('%.', a.id, '.%') \n                                    OR c.path LIKE CONCAT('%.', a.id) \n                                    OR c.path LIKE CONCAT(a.id, '.%') \n                                    OR c.path = a.id) \n                            WHERE\n                                is_standard = 1 \n                                AND is_selectable = 1) \n                            AND is_standard = 1 )) criteria ) )\n            )) d_exposure \n    LEFT JOIN\n        `concept` d_standard_concept \n            ON d_exposure.drug_concept_id = d_standard_concept.concept_id \n    LEFT JOIN\n        `concept` d_type \n            ON d_exposure.drug_type_concept_id = d_type.concept_id \n    LEFT JOIN\n        `concept` d_route \n            ON d_exposure.route_concept_id = d_route.concept_id \n    LEFT JOIN\n        `visit_occurrence` v \n            ON d_exposure.visit_occurrence_id = v.visit_occurrence_id \n    LEFT JOIN\n        `concept` d_visit \n            ON v.visit_concept_id = d_visit.concept_id \n    LEFT JOIN\n        `concept` d_source_concept \n            ON d_exposure.drug_source_concept_id = d_source_concept.concept_id\", sep=\"\")\n\n# Formulate a Cloud Storage destination path for the data exported from BigQuery.\n# NOTE: By default data exported multiple times on the same day will overwrite older copies.\n#       But data exported on a different days will write to a new location so that historical\n#       copies can be kept as the dataset definition is changed.\ndrug_71250616_path &lt;- file.path(\n  Sys.getenv(\"WORKSPACE_BUCKET\"),\n  \"bq_exports\",\n  Sys.getenv(\"OWNER_EMAIL\"),\n  strftime(lubridate::now(), \"%Y%m%d\"),  # Comment out this line if you want the export to always overwrite.\n  \"drug_71250616\",\n  \"drug_71250616_*.csv\")\nmessage(str_glue('The data will be written to {drug_71250616_path}. Use this path when reading ',\n                 'the data into your notebooks in the future.'))\n\n# Perform the query and export the dataset to Cloud Storage as CSV files.\n# NOTE: You only need to run `bq_table_save` once. After that, you can\n#       just read data from the CSVs in Cloud Storage.\nbq_table_save(\n  bq_dataset_query(Sys.getenv(\"WORKSPACE_CDR\"), dataset_71250616_drug_sql, billing = Sys.getenv(\"GOOGLE_PROJECT\")),\n  drug_71250616_path,\n  destination_format = \"CSV\")\n\n\n# Read the data directly from Cloud Storage into memory.\n# NOTE: Alternatively you can `gsutil -m cp {drug_71250616_path}` to copy these files\n#       to the Jupyter disk.\nread_bq_export_from_workspace_bucket &lt;- function(export_path) {\n  col_types &lt;- cols(standard_concept_name = col_character(), standard_concept_code = col_character(), standard_vocabulary = col_character(), drug_type_concept_name = col_character(), stop_reason = col_character(), sig = col_character(), route_concept_name = col_character(), lot_number = col_character(), visit_occurrence_concept_name = col_character(), drug_source_value = col_character(), source_concept_name = col_character(), source_concept_code = col_character(), source_vocabulary = col_character(), route_source_value = col_character(), dose_unit_source_value = col_character())\n  bind_rows(\n    map(system2('gsutil', args = c('ls', export_path), stdout = TRUE, stderr = TRUE),\n        function(csv) {\n          message(str_glue('Loading {csv}.'))\n          chunk &lt;- read_csv(pipe(str_glue('gsutil cat {csv}')), col_types = col_types, show_col_types = FALSE)\n          if (is.null(col_types)) {\n            col_types &lt;- spec(chunk)\n          }\n          chunk\n        }))\n}\ndataset_71250616_drug_df &lt;- read_bq_export_from_workspace_bucket(drug_71250616_path)\n\ndim(dataset_71250616_drug_df)\n\nhead(dataset_71250616_drug_df, 5)"
  },
  {
    "objectID": "Presentations/allofus/index.html#creating-datasets-with-cohort-builder-1",
    "href": "Presentations/allofus/index.html#creating-datasets-with-cohort-builder-1",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Creating datasets with Cohort Builder",
    "text": "Creating datasets with Cohort Builder\nI have 4 CSV files (over 6 million rows) stored in my bucket that I have to read back in to do more manipulation\n\n\ngs://fc-secure-5dd899cc-249c-449a-b4b1-96abcc51898b/bq_exports/\nlouisahsmith@researchallofus.org/20241106/person_71250616/\nperson_71250616_*.csv\n\ngs://fc-secure-5dd899cc-249c-449a-b4b1-96abcc51898b/bq_exports/\nlouisahsmith@researchallofus.org/20241106/condition_71250616/\ncondition_71250616_*.csv\n\ngs://fc-secure-5dd899cc-249c-449a-b4b1-96abcc51898b/bq_exports/\nlouisahsmith@researchallofus.org/20241106/measurement_71250616/\nmeasurement_71250616_*.csv\n\ngs://fc-secure-5dd899cc-249c-449a-b4b1-96abcc51898b/bq_exports/\nlouisahsmith@researchallofus.org/20241106/drug_71250616/drug_71250616_*.csv"
  },
  {
    "objectID": "Presentations/allofus/index.html#creating-datasets-with-allofus",
    "href": "Presentations/allofus/index.html#creating-datasets-with-allofus",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Creating datasets with allofus",
    "text": "Creating datasets with allofus\n\nconcept_ids &lt;- c(21601664, 21601744, 21490851, 21490853, 3004249, 3005606, 3009395, 3012526, 3012888, 3013940, 3017490, 3018586, 3018592, 3018822, 3019962, 3027598, 3028737, 3031203, 3034703, 3035856, 36716965, 4060834, 40758413, 4152194, 4154790, 4232915, 4239021, 4248524, 4298393, 4302410, 44789315, 44789316, 132685, 133816, 134414, 135601, 136743, 137613, 138811, 141084, 314090, 35622939, 4034096, 4057976, 4116344, 4283352, 433536, 438490, 439077, 439393, 443700)\n\naou_concept_set(cohort, \n                concepts = concept_ids, \n                domains = c(\"drug\", \"measurement\", \"condition\"), \n                output = \"all\") |&gt; \n  count(concept_name, sort = TRUE)\n\nError in `aou_concept_set()`:\n! No connection available.\nâ„¹ Provide a connection automatically by running `aou_connect()` before this\n  function.\nâ„¹ You can also provide `con` as an argument or default with\n  `options(aou.default.con = ...)`."
  },
  {
    "objectID": "Presentations/allofus/index.html#improved-efficiency",
    "href": "Presentations/allofus/index.html#improved-efficiency",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Improved efficiency",
    "text": "Improved efficiency\n\nWeâ€™re extracting a lot less data because we are\n\nImmediately using it for what we need (eligibility criteria)\nRestricting to the time periods of interest\n\nThe data is not actually extracted or stored until we need it in a local R session (e.g, for figures, regressions, etc.)\nEdits are straightforward and code is easily readable\n\nvs.Â storing millions of rows of data in a bucket and transferring it every time you run a notebook"
  },
  {
    "objectID": "Presentations/allofus/index.html#survey-data",
    "href": "Presentations/allofus/index.html#survey-data",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Survey data",
    "text": "Survey data\n\nsurvey_data &lt;- aou_survey(cohort,\n           questions = c(43529063),\n           question_output = c(\"hypertension\"))\n\nWhen was the survey question answered?\n\ncolnames(survey_data)\n\n\n\n[1] \"person_id\"         \"hypertension\"      \"hypertension_date\""
  },
  {
    "objectID": "Presentations/allofus/index.html#survey-data-1",
    "href": "Presentations/allofus/index.html#survey-data-1",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Survey data",
    "text": "Survey data\n\ncount(survey_data, hypertension)\n\n\n\n# A tibble: 6 Ã— 2\n  hypertension      n    \n  &lt;chr&gt;             &lt;chr&gt;\n1 &lt;NA&gt;              16229\n2 Yes               5579 \n3 No                4426 \n4 Skip              280  \n5 DontKnow          49   \n6 PreferNotToAnswer &lt;20  \n\n\n\nâ€œSkip/Prefer not to answer/Donâ€™t knowâ€ includes anyone who skipped the whole question\nNA refers to participants who never saw the question.\nâ€œNoâ€ assigned to respondents who answered the question, but didnâ€™t select â€œSelfâ€"
  },
  {
    "objectID": "Presentations/allofus/index.html#integrating-ohdsi-software-for-cohort-building",
    "href": "Presentations/allofus/index.html#integrating-ohdsi-software-for-cohort-building",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Integrating OHDSI software for cohort building",
    "text": "Integrating OHDSI software for cohort building"
  },
  {
    "objectID": "Presentations/allofus/index.html#challenges-in-fully-integrating-other-ohdsi-software",
    "href": "Presentations/allofus/index.html#challenges-in-fully-integrating-other-ohdsi-software",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Challenges in fully integrating other OHDSI software",
    "text": "Challenges in fully integrating other OHDSI software\n\nNo direct write access\nTemp tables work differently"
  },
  {
    "objectID": "Presentations/allofus/index.html#aou_compute",
    "href": "Presentations/allofus/index.html#aou_compute",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "aou_compute()",
    "text": "aou_compute()\nLike dplyr::compute() â€“ forces computation\n\nfunction (data, ..., con = getOption(\"aou.default.con\")) \n{\n  q &lt;- as.character(dbplyr::db_sql_render(con, data))\n  tmp1 &lt;- \"CREATE TEMP TABLE table1 AS\"\n  tmp2 &lt;- \"SELECT * FROM table1\"\n  out &lt;- paste0(tmp1, \"\\n\", q, \";\\n\", tmp2)\n  {...}\n  get_query_table(out, collect = FALSE, ..., con = con)\n}"
  },
  {
    "objectID": "Presentations/allofus/index.html#aou_create_temp_table",
    "href": "Presentations/allofus/index.html#aou_create_temp_table",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "aou_create_temp_table()",
    "text": "aou_create_temp_table()\nCopies a local data frame to a temporary table in the connected database (in batches as necessary)\n\nfunction (data, nchar_batch = 1e+06, ..., con = getOption(\"aou.default.con\")) \n{\n  {...}\n  for (i in seq_along(batches)) {\n        dataset &lt;- datasets[i]\n        s1 &lt;- stringr::str_glue(\"CREATE TEMP TABLE {dataset} (\\n{s1_str}\\n);\")\n        s2 &lt;- stringr::str_glue(\"INSERT INTO {dataset} ({paste(cn, collapse =\\\", \\\")})\")\n        s3 &lt;- batches[i]\n        s4 &lt;- stringr::str_glue(\"SELECT * FROM {dataset};\")\n        q &lt;- paste(s1, s2, s3, s4)\n        tmptbl_object &lt;- bigrquery::bq_project_query(Sys.getenv(\"GOOGLE_PROJECT\"), \n            query = q)\n        n[[i]] &lt;- dplyr::tbl(con, paste(tmptbl_object$project, \n            tmptbl_object$dataset, tmptbl_object$table, sep = (\".\")))\n  }\n  final_tbl &lt;- purrr::reduce(n, dplyr::union_all)\n  {...}\n}"
  },
  {
    "objectID": "Presentations/allofus/index.html#aou_create_temp_table-1",
    "href": "Presentations/allofus/index.html#aou_create_temp_table-1",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "aou_create_temp_table()",
    "text": "aou_create_temp_table()\nCREATE TEMP TABLE MYLVFUKBBA (\n  concept_id FLOAT64,\n  category STRING,\n  gest_value FLOAT64\n  ); \nINSERT INTO MYLVFUKBBA (concept_id, category, gest_value) \nVALUES(439331, 'AB', NULL),\n  (4290245, 'DELIV', NULL),\n  (435640, 'PREG', 25),\nSELECT * FROM MYLVFUKBBA;\n\ntmptbl_object &lt;- bigrquery::bq_project_query(Sys.getenv(\"GOOGLE_PROJECT\"), query = q)\npaste(tmptbl_object$project, tmptbl_object$dataset, tmptbl_object$table, sep = (\".\"))\n\n\n\n[1] \"terra-vpc-sc-07d9a2ac._5e8cebc37c5303ccccd8c889e44de664222a9786.anon8daf0d7bf0928b865ebae9fe169111e4f21636f52ee032338b018d8da11852e3\"\n\n\n\ndplyr::tbl(con, paste(tmptbl_object$project, \n                                  tmptbl_object$dataset, \n                                  tmptbl_object$table, sep = (\".\")))"
  },
  {
    "objectID": "Presentations/allofus/index.html#other-functions",
    "href": "Presentations/allofus/index.html#other-functions",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Other functions",
    "text": "Other functions"
  },
  {
    "objectID": "Presentations/allofus/index.html#thank-you",
    "href": "Presentations/allofus/index.html#thank-you",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Thank you!",
    "text": "Thank you!\n\nSmith LH, Cavanaugh R. allofus: an R package to facilitate use of the All of Us Researcher Workbench. Journal of the American Medical Informatics Association. 2024;31(12):3013-3021. doi: 10.1093/jamia/ocae198\nGitHub (source code, bug reports): github.com/roux-ohdsi/allofus\nPackage site (tutorials, searchable codebooks): roux-ohdsi.github.io/allofus"
  }
]
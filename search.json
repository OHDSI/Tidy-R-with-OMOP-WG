[
  {
    "objectID": "index.html#description-and-goals",
    "href": "index.html#description-and-goals",
    "title": "Tidy R with OMOP workgroup",
    "section": "Description and goals",
    "text": "Description and goals\n\nOKRs 2026\n\n\nOKRs 2025"
  },
  {
    "objectID": "index.html#regular-meetings",
    "href": "index.html#regular-meetings",
    "title": "Tidy R with OMOP workgroup",
    "section": "Regular meetings",
    "text": "Regular meetings"
  },
  {
    "objectID": "index.html#join-the-journey",
    "href": "index.html#join-the-journey",
    "title": "Tidy R with OMOP workgroup",
    "section": "Join the Journey",
    "text": "Join the Journey"
  },
  {
    "objectID": "Presentations/ecosystem.html#content",
    "href": "Presentations/ecosystem.html#content",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Content",
    "text": "Content\n\nMotivation and foundations\nExisting packages overview\nomopgenerics the core package"
  },
  {
    "objectID": "Presentations/ecosystem.html#motivation",
    "href": "Presentations/ecosystem.html#motivation",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Motivation",
    "text": "Motivation\n\nOMOP CDM\ncomplications to install packages, not in cran, java, contribute to the ecosystem\ntidyverse\nno Java code, no SQL code, just R code"
  },
  {
    "objectID": "Presentations/ecosystem.html#foundation",
    "href": "Presentations/ecosystem.html#foundation",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Foundation",
    "text": "Foundation\n\nlibrary(palmerpenguins)\nlibrary(dplyr)\n\npenguins |&gt;\n  group_by(species) |&gt;\n  summarise(\n    n = n(),\n    min_bill_length_mm = min(bill_length_mm, na.rm = TRUE),\n    mean_bill_length_mm = mean(bill_length_mm, na.rm = TRUE),\n    max_bill_length_mm = max(bill_length_mm, na.rm = TRUE)\n  ) |&gt;\n  mutate(min_max_bill_length_mm = paste0(\n    min_bill_length_mm, \" to \", max_bill_length_mm\n  )) |&gt;\n  select(\"species\", \"mean_bill_length_mm\", \"min_max_bill_length_mm\")\n\n# A tibble: 3 × 3\n  species   mean_bill_length_mm min_max_bill_length_mm\n  &lt;fct&gt;                   &lt;dbl&gt; &lt;chr&gt;                 \n1 Adelie                   38.8 32.1 to 46            \n2 Chinstrap                48.8 40.9 to 58            \n3 Gentoo                   47.5 40.9 to 59.6"
  },
  {
    "objectID": "Presentations/ecosystem.html#foundartion",
    "href": "Presentations/ecosystem.html#foundartion",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Foundartion",
    "text": "Foundartion\n\nlibrary(duckdb)\n\ncon &lt;- dbConnect(drv = duckdb())\ndbWriteTable(conn = con, name = \"penguins\", value = penguins)\npenguins_db &lt;- tbl(con, \"penguins\")\npenguins_db\n\n# Source:   table&lt;penguins&gt; [?? x 8]\n# Database: DuckDB 1.4.4 [unknown@Linux 6.11.0-1018-azure:R 4.5.2/:memory:]\n   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year\n   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt; &lt;fct&gt;  &lt;int&gt;\n 1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007\n 2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007\n 3 Adelie  Torgersen           40.3          18                 195        3250 female  2007\n 4 Adelie  Torgersen           NA            NA                  NA          NA &lt;NA&gt;    2007\n 5 Adelie  Torgersen           36.7          19.3               193        3450 female  2007\n 6 Adelie  Torgersen           39.3          20.6               190        3650 male    2007\n 7 Adelie  Torgersen           38.9          17.8               181        3625 female  2007\n 8 Adelie  Torgersen           39.2          19.6               195        4675 male    2007\n 9 Adelie  Torgersen           34.1          18.1               193        3475 &lt;NA&gt;    2007\n10 Adelie  Torgersen           42            20.2               190        4250 &lt;NA&gt;    2007\n# ℹ more rows"
  },
  {
    "objectID": "Presentations/ecosystem.html#foundartion-1",
    "href": "Presentations/ecosystem.html#foundartion-1",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Foundartion",
    "text": "Foundartion\n\npenguins_db |&gt;\n  group_by(species) |&gt;\n  summarise(\n    n = n(),\n    min_bill_length_mm = min(bill_length_mm, na.rm = TRUE),\n    mean_bill_length_mm = mean(bill_length_mm, na.rm = TRUE),\n    max_bill_length_mm = max(bill_length_mm, na.rm = TRUE)\n  ) |&gt;\n  mutate(min_max_bill_length_mm = paste0(\n    min_bill_length_mm, \" to \", max_bill_length_mm\n  )) |&gt;\n  select(\"species\", \"mean_bill_length_mm\", \"min_max_bill_length_mm\")\n\n# Source:   SQL [?? x 3]\n# Database: DuckDB 1.4.4 [unknown@Linux 6.11.0-1018-azure:R 4.5.2/:memory:]\n  species   mean_bill_length_mm min_max_bill_length_mm\n  &lt;fct&gt;                   &lt;dbl&gt; &lt;chr&gt;                 \n1 Adelie                   38.8 32.1 to 46.0          \n2 Chinstrap                48.8 40.9 to 58.0          \n3 Gentoo                   47.5 40.9 to 59.6"
  },
  {
    "objectID": "Presentations/ecosystem.html#foundation-1",
    "href": "Presentations/ecosystem.html#foundation-1",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Foundation",
    "text": "Foundation\n\npenguins_db |&gt;\n  group_by(species) |&gt;\n  summarise(\n    n = n(),\n    min_bill_length_mm = min(bill_length_mm, na.rm = TRUE),\n    mean_bill_length_mm = mean(bill_length_mm, na.rm = TRUE),\n    max_bill_length_mm = max(bill_length_mm, na.rm = TRUE)\n  ) |&gt;\n  mutate(min_max_bill_length_mm = paste0(\n    min_bill_length_mm, \" to \", max_bill_length_mm\n  )) |&gt;\n  select(\"species\", \"mean_bill_length_mm\", \"min_max_bill_length_mm\") |&gt;\n  show_query()\n\n&lt;SQL&gt;\nSELECT\n  species,\n  mean_bill_length_mm,\n  CONCAT_WS('', min_bill_length_mm, ' to ', max_bill_length_mm) AS min_max_bill_length_mm\nFROM (\n  SELECT\n    species,\n    COUNT(*) AS n,\n    MIN(bill_length_mm) AS min_bill_length_mm,\n    AVG(bill_length_mm) AS mean_bill_length_mm,\n    MAX(bill_length_mm) AS max_bill_length_mm\n  FROM penguins\n  GROUP BY species\n) q01"
  },
  {
    "objectID": "Presentations/ecosystem.html#foundation-2",
    "href": "Presentations/ecosystem.html#foundation-2",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Foundation",
    "text": "Foundation\ndbplyr support the database translation of dplyr functions against several database management systems.\n\nThe presented ecosystem sits on top of these functions combined with the known structure of the OMOP CDM tables to build packages to perform Epidemiological studies extracting data from an OMOP CDM source that can be in several different forms."
  },
  {
    "objectID": "Presentations/ecosystem.html#cronology-early-stages",
    "href": "Presentations/ecosystem.html#cronology-early-stages",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Cronology (Early stages)",
    "text": "Cronology (Early stages)"
  },
  {
    "objectID": "Presentations/ecosystem.html#cronology-first-packages",
    "href": "Presentations/ecosystem.html#cronology-first-packages",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Cronology (First packages)",
    "text": "Cronology (First packages)"
  },
  {
    "objectID": "Presentations/ecosystem.html#cronology-standardarisation-and-expansion",
    "href": "Presentations/ecosystem.html#cronology-standardarisation-and-expansion",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Cronology (Standardarisation and expansion)",
    "text": "Cronology (Standardarisation and expansion)"
  },
  {
    "objectID": "Presentations/ecosystem.html#cronology-1.0.0-releases-and-stability",
    "href": "Presentations/ecosystem.html#cronology-1.0.0-releases-and-stability",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Cronology (1.0.0 releases and stability)",
    "text": "Cronology (1.0.0 releases and stability)"
  },
  {
    "objectID": "Presentations/ecosystem.html#existing-packages",
    "href": "Presentations/ecosystem.html#existing-packages",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Existing packages",
    "text": "Existing packages\n\n\nCore\n\nomopgenerics\nomock\nvisOmopResults\nCodelistGenerator\nPatientProfiles\n\n\n\nBack-end\n\nCDMConnector\nOmopOnSpark\nOmopOnPostgres\nOmopOnDuckDB\nOmopOnSqlServer\n\n\n\nAnalytics\n\nCohortConstructor\nIncidencePrevalence\nDrugUtilisation\nCohortCharacteristics\nCohortSurvival\nCohortSymmetry\nOmopSketch\nTreatmentPatterns\n\n\n\nDiagnostics\n\nCodelistGenerator\nOmopSketch\nMeasurementDiagnostics\nPhenotypeR\nDrugExposureDiagnostics\n\n\n\nETL\n\nOmopConstructor\n\n\n\nVisualisation\n\nvisOmopResults\nOmopViewer"
  },
  {
    "objectID": "Presentations/ecosystem.html#omopgenerics-core",
    "href": "Presentations/ecosystem.html#omopgenerics-core",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "omopgenerics (Core)",
    "text": "omopgenerics (Core)\n\nMethods and Classes for the OMOP Common Data Model\nCurrent version: 1.3.6 First release: 2024-01-17 Total releases: 23\nLinks: Website; GitHub\n\n\nProvides definitions of core classes and methods used by analytic pipelines that query the OMOP (Observational Medical Outcomes Partnership) common data model.\n\nDefine methods and classes for the ecosystem"
  },
  {
    "objectID": "Presentations/ecosystem.html#cdmconnector-back-end",
    "href": "Presentations/ecosystem.html#cdmconnector-back-end",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "CDMConnector (Back-end)",
    "text": "CDMConnector (Back-end)\n\n\n\n\nConnect to an OMOP Common Data Model\nCurrent version: 2.3.0 First release: 2022-09-29 Total releases: 29\nLinks: Website; GitHub\n\n\nProvides tools for working with observational health data in the Observational Medical Outcomes Partnership (OMOP) Common Data Model format with a pipe friendly syntax. Common data model database table references are stored in a single compound object along with metadata.\n\nCreate a cdm_reference for database backends"
  },
  {
    "objectID": "Presentations/ecosystem.html#omock-core",
    "href": "Presentations/ecosystem.html#omock-core",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "omock (Core)",
    "text": "omock (Core)\n\n\n\n\nCreation of Mock Observational Medical Outcomes Partnership Common Data Model\nCurrent version: 0.6.1 First release: 2024-03-08 Total releases: 9\nLinks: Website; GitHub\n\n\nCreates mock data for testing and package development for the Observational Medical Outcomes Partnership common data model. The package offers functions crafted with pipeline-friendly implementation, enabling users to effortlessly include only the necessary tables for their testing needs.\n\nGenerate mock synthetic data\nCreate cdm reference to existing mock datasets"
  },
  {
    "objectID": "Presentations/ecosystem.html#visomopresults-core-visualisation",
    "href": "Presentations/ecosystem.html#visomopresults-core-visualisation",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "visOmopResults (Core; Visualisation)",
    "text": "visOmopResults (Core; Visualisation)\n\n\n\n\nGraphs and Tables for OMOP Results\nCurrent version: 1.4.1 First release: 2024-02-06 Total releases: 18\nLinks: Website; GitHub\n\n\nProvides methods to transform omop_result objects into formatted tables and figures, facilitating the visualisation of study results working with the Observational Medical Outcomes Partnership (OMOP) Common Data Model.\n\nManage summarised_result objects\nCreate tables from summarised_result objects\nCreate plots from summarised_result objects"
  },
  {
    "objectID": "Presentations/ecosystem.html#codelistgenerator-core-diagnostics",
    "href": "Presentations/ecosystem.html#codelistgenerator-core-diagnostics",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "CodelistGenerator (Core; Diagnostics)",
    "text": "CodelistGenerator (Core; Diagnostics)\n\n\n\n\nIdentify Relevant Clinical Codes and Evaluate Their Use\nCurrent version: 4.0.2 First release: 2023-02-07 Total releases: 28\nLinks: Website; GitHub\n\n\nGenerate a candidate code list for the Observational Medical Outcomes Partnership (OMOP) common data model based on string matching. For a given search strategy, a candidate code list will be returned.\n\nManage codelists and concept sets\nRun codelist diagnostics"
  },
  {
    "objectID": "Presentations/ecosystem.html#patientprofiles-core",
    "href": "Presentations/ecosystem.html#patientprofiles-core",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "PatientProfiles (Core)",
    "text": "PatientProfiles (Core)\n\n\n\n\nIdentify Characteristics of Patients in the OMOP Common Data Model\nCurrent version: 1.4.5 First release: 2023-05-02 Total releases: 27\nLinks: Website; GitHub\n\n\nIdentify the characteristics of patients in data mapped to the Observational Medical Outcomes Partnership (OMOP) common data model.\n\nAdd columns related to patient demographics\nAdd columns related to intersections"
  },
  {
    "objectID": "Presentations/ecosystem.html#cohortconstructor-analytics",
    "href": "Presentations/ecosystem.html#cohortconstructor-analytics",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "CohortConstructor (Analytics)",
    "text": "CohortConstructor (Analytics)\n\n\n\n\nBuild and Manipulate Study Cohorts Using a Common Data Model\nCurrent version: 0.6.1 First release: 2024-06-01 Total releases: 14\nLinks: Website; GitHub\n\n\nCreate and manipulate study cohorts in data mapped to the Observational Medical Outcomes Partnership Common Data Model.\n\nGenerate base cohorts\nApply inclusion (and exclusion) criteria to cohorts"
  },
  {
    "objectID": "Presentations/ecosystem.html#incidenceprevalence-analytics",
    "href": "Presentations/ecosystem.html#incidenceprevalence-analytics",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "IncidencePrevalence (Analytics)",
    "text": "IncidencePrevalence (Analytics)\n\n\n\n\nEstimate Incidence and Prevalence using the OMOP Common Data Model\nCurrent version: 1.2.1 First release: 2023-03-27 Total releases: 24\nLinks: Website; GitHub\n\n\nCalculate incidence and prevalence using data mapped to the Observational Medical Outcomes Partnership (OMOP) common data model. Incidence and prevalence can be estimated for the total population in a database or for a stratification cohort.\n\nIdentify denominators based on demographics\nEstimate Incidence\nEstimate Point-Prevalence\nEstimate Period-Prevalence"
  },
  {
    "objectID": "Presentations/ecosystem.html#drugutilisation-analytics",
    "href": "Presentations/ecosystem.html#drugutilisation-analytics",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "DrugUtilisation (Analytics)",
    "text": "DrugUtilisation (Analytics)\n\n\n\n\nSummarise Patient-Level Drug Utilisation in Data Mapped to the OMOP Common Data Model\nCurrent version: 1.1.0 First release: 2023-06-19 Total releases: 25\nLinks: Website; GitHub\n\n\nSummarise patient-level drug utilisation cohorts using data mapped to the Observational Medical Outcomes Partnership (OMOP) common data model. New users and prevalent users cohorts can be generated and their characteristics, indication and drug use summarised.\n\nEstimate drug use\nEstimate Proportion of Patients Covered\nSummarise Indication\nAnalyse Discontunation and restart\nCalculate daily dose"
  },
  {
    "objectID": "Presentations/ecosystem.html#cohortcharacteristics-analytics",
    "href": "Presentations/ecosystem.html#cohortcharacteristics-analytics",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "CohortCharacteristics (Analytics)",
    "text": "CohortCharacteristics (Analytics)\n\n\n\n\nSummarise and Visualise Characteristics of Patients in the OMOP CDM\nCurrent version: 1.1.1 First release: 2024-04-16 Total releases: 13\nLinks: Website; GitHub\n\n\nSummarise and visualise the characteristics of patients in data mapped to the Observational Medical Outcomes Partnership (OMOP) common data model (CDM).\n\nExtract counts and attrition of cohorts\nOverlap and Timing between cohorts\nCharacterise cohorts based in demographics and predefined conditions\nData driven characterisation"
  },
  {
    "objectID": "Presentations/ecosystem.html#cohortsurvival-analytics",
    "href": "Presentations/ecosystem.html#cohortsurvival-analytics",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "CohortSurvival (Analytics)",
    "text": "CohortSurvival (Analytics)\n\n\n\n\nEstimate Survival from Common Data Model Cohorts\nCurrent version: 1.1.0 First release: 2023-12-07 Total releases: 14\nLinks: Website; GitHub\n\n\nEstimate survival using data mapped to the Observational Medical Outcomes Partnership common data model. Survival can be estimated based on user-defined study cohorts.\n\nEstimate survival probabilities\nEstimate competing risks probabilities"
  },
  {
    "objectID": "Presentations/ecosystem.html#cohortsymmetry-analytics",
    "href": "Presentations/ecosystem.html#cohortsymmetry-analytics",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "CohortSymmetry (Analytics)",
    "text": "CohortSymmetry (Analytics)\n\n\n\n\nSequence Symmetry Analysis Using the Observational Medical Outcomes Partnership Common Data Model\nCurrent version: 0.2.4 First release: 2024-06-04 Total releases: 10\nLinks: Website; GitHub\n\n\nCalculating crude sequence ratio, adjusted sequence ratio and confidence intervals using data mapped to the Observational Medical Outcomes Partnership Common Data Model.\n\nSummarise temporal symmetry\nSummarise sequence ratios"
  },
  {
    "objectID": "Presentations/ecosystem.html#omopsketch-diagnostics-analytics",
    "href": "Presentations/ecosystem.html#omopsketch-diagnostics-analytics",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "OmopSketch (Diagnostics; Analytics)",
    "text": "OmopSketch (Diagnostics; Analytics)\n\n\n\n\nCharacterise Tables of an OMOP Common Data Model Instance\nCurrent version: 1.0.0 First release: 2024-09-26 Total releases: 13\nLinks: Website; GitHub\n\n\nSummarises key information in data mapped to the Observational Medical Outcomes Partnership (OMOP) common data model. Assess suitability to perform specific epidemiological studies and explore the different domains to obtain feasibility counts and trends.\n\nSummarise data standards of omop tables\nSummarise record trends\nSummarise missing data\nSummarise concept counts"
  },
  {
    "objectID": "Presentations/ecosystem.html#measurementdiagnostics-diagnostics",
    "href": "Presentations/ecosystem.html#measurementdiagnostics-diagnostics",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "MeasurementDiagnostics (Diagnostics)",
    "text": "MeasurementDiagnostics (Diagnostics)\n\n\n\n\nDiagnostics for Lists of Codes Based on Measurements\nCurrent version: 0.2.0 First release: 2025-07-11 Total releases: 3\nLinks: Website; GitHub\n\n\nDiagnostics of list of codes based on concepts from the domains measurement and observation. This package works for data mapped to the Observational Medical Outcomes Partnership Common Data Model.\n\nDiagnotics for measurement codelists"
  },
  {
    "objectID": "Presentations/ecosystem.html#phenotyper-diagnostics",
    "href": "Presentations/ecosystem.html#phenotyper-diagnostics",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "PhenotypeR (Diagnostics)",
    "text": "PhenotypeR (Diagnostics)\n\n\n\n\nAssess Study Cohorts Using a Common Data Model\nCurrent version: 0.3.1 First release: 2024-12-06 Total releases: 10\nLinks: Website; GitHub\n\n\nPhenotype study cohorts in data mapped to the Observational Medical Outcomes Partnership Common Data Model. Diagnostics are run at the database, code list, cohort, and population level to assess whether study cohorts are ready for research.\n\nDiagnostics at database level\nDiagnostics at codelist level\nDiagnostics at cohort level"
  },
  {
    "objectID": "Presentations/ecosystem.html#omopviewer-visualisation",
    "href": "Presentations/ecosystem.html#omopviewer-visualisation",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "OmopViewer (Visualisation)",
    "text": "OmopViewer (Visualisation)\n\nVisualise OMOP Results using ‘shiny’ Applications\nCurrent version: 0.6.0 First release: 2024-10-21 Total releases: 6\nLinks: Website; GitHub\n\n\nVisualise results obtained from analysing data mapped to the Observational Medical Outcomes Partnership (OMOP) common data model using ‘shiny’ applications.\n\nCreate automatic shiny app from standard results"
  },
  {
    "objectID": "Presentations/ecosystem.html#drugexposurediagnostics-diagnostics",
    "href": "Presentations/ecosystem.html#drugexposurediagnostics-diagnostics",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "DrugExposureDiagnostics (Diagnostics)",
    "text": "DrugExposureDiagnostics (Diagnostics)\n\nDiagnostics for OMOP Common Data Model Drug Records\nCurrent version: 1.1.5 First release: 2023-03-08 Total releases: 23\nLinks: Website; GitHub\n\n\nIngredient specific diagnostics for drug exposure records in the Observational Medical Outcomes Partnership (OMOP) common data model.\n\nDiagnostics for drug codelists"
  },
  {
    "objectID": "Presentations/ecosystem.html#treatmentpatterns-analytics",
    "href": "Presentations/ecosystem.html#treatmentpatterns-analytics",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "TreatmentPatterns (Analytics)",
    "text": "TreatmentPatterns (Analytics)\n\nAnalyzes Real-World Treatment Patterns of a Study Population of Interest\nCurrent version: 3.1.1 First release: 2023-08-16 Total releases: 20\nLinks: Website; GitHub\n\n\n\nComputes treatment patterns within a given cohort using the Observational Medical Outcomes Partnership (OMOP) common data model (CDM). As described in Markus, Verhamme, Kors, and Rijnbeek (2022) doi:10.1016/j.cmpb.2022.107081.*\nAnalyse treatment sequences and pathways"
  },
  {
    "objectID": "Presentations/ecosystem.html#omopconstructor-etl",
    "href": "Presentations/ecosystem.html#omopconstructor-etl",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "OmopConstructor (ETL)",
    "text": "OmopConstructor (ETL)\n\nBuild Tables in the OMOP Common Data Model\nCurrent version: 0.1.0 First release: 2025-09-30 Total releases: 1\nLinks: Website; GitHub\n\n\nProvides functionality to construct standardised tables from health care data formatted according to the Observational Medical Outcomes Partnership (OMOP) Common Data Model. The package includes tools to build key tables such as observation period and drug era, among others.\n\nGenerate the observation_period using cdm data\nRun Achilles analyses\nCreate drug_era table\nCreate pregnancy algorithm"
  },
  {
    "objectID": "Presentations/ecosystem.html#omoponspark-back-end",
    "href": "Presentations/ecosystem.html#omoponspark-back-end",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "OmopOnSpark (Back-end)",
    "text": "OmopOnSpark (Back-end)\n\nUsing a Common Data Model on ‘Spark’\nCurrent version: 0.1.0 First release: 2025-10-22 Total releases: 1\nLinks: Website; GitHub\n\n\nUse health data in the Observational Medical Outcomes Partnership Common Data Model format in ‘Spark’. Functionality includes creating all required tables and fields and creation of a single reference to the data. Native ‘Spark’ functionality is supported.\n\nCreate a cdm_reference using spark connection"
  },
  {
    "objectID": "Presentations/ecosystem.html#omoponpostgres-back-end",
    "href": "Presentations/ecosystem.html#omoponpostgres-back-end",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "OmopOnPostgres (Back-end)",
    "text": "OmopOnPostgres (Back-end)\n\nWhat the Package Does (One Line, Title Case)\nCurrent version: - First release: - Total releases: 0\nLinks: Website; GitHub\n\n\nWhat the package does (one paragraph).\n\nCreate a cdm_reference using postgres connection\nUse postgres indexes"
  },
  {
    "objectID": "Presentations/ecosystem.html#omoponduckdb-back-end",
    "href": "Presentations/ecosystem.html#omoponduckdb-back-end",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "OmopOnDuckDB (Back-end)",
    "text": "OmopOnDuckDB (Back-end)\n\nWhat the Package Does (Title Case)\nCurrent version: - First release: - Total releases: 0\nLinks: Website; GitHub\n\n\nMore about what it does (maybe more than one line) Use four spaces when indenting paragraphs within the Description.\n\nCreate a cdm_reference using duckdb connection\nCreate a cdm_reference using parquet files"
  },
  {
    "objectID": "Presentations/ecosystem.html#omoponsqlserver-back-end",
    "href": "Presentations/ecosystem.html#omoponsqlserver-back-end",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "OmopOnSqlServer (Back-end)",
    "text": "OmopOnSqlServer (Back-end)\n\nWhat the Package Does (Title Case)\nCurrent version: - First release: - Total releases: 0\nLinks: Website; GitHub\n\n\nMore about what it does (maybe more than one line) Use four spaces when indenting paragraphs within the Description.\n\nCreate a cdm_reference using sql server connection\nCreate a cdm_reference using synapse connection"
  },
  {
    "objectID": "Presentations/ecosystem.html#how-packages-interact",
    "href": "Presentations/ecosystem.html#how-packages-interact",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "How packages interact?",
    "text": "How packages interact?"
  },
  {
    "objectID": "Presentations/ecosystem.html#how-packages-interact-1",
    "href": "Presentations/ecosystem.html#how-packages-interact-1",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "How packages interact?",
    "text": "How packages interact?"
  },
  {
    "objectID": "Presentations/ecosystem.html#some-statistics",
    "href": "Presentations/ecosystem.html#some-statistics",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Some statistics",
    "text": "Some statistics\n\n\n\n\n\n\n\nNumber of R packages\n23\n\n\n\n\n\n\n\n\n\n\n\n\nNumber of R packages on CRAN\n20\n\n\n\n\n\n\n\n\n\n\n\n\nNumber Releases\n311\n\n\n\n\n\n\n\n\n\n\n\n\nTotal CRAN downloads\n409096"
  },
  {
    "objectID": "Presentations/ecosystem.html#omopgenerics-1",
    "href": "Presentations/ecosystem.html#omopgenerics-1",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "omopgenerics",
    "text": "omopgenerics\nProvides definitions of core classes and methods used by analytic pipelines that query the OMOP (Observational Medical Outcomes Partnership) common data model."
  },
  {
    "objectID": "Presentations/ecosystem.html#classes",
    "href": "Presentations/ecosystem.html#classes",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Classes",
    "text": "Classes\n\nThe CDM refernce object: cdm_reference, cdm_source, local_source\nCDM tables: cdm_table, omop_table, achilles_table, cohort_table\nCode lists: codelist, codelist_with_details, concept_set_expression\nResult model: summaried_result"
  },
  {
    "objectID": "Presentations/ecosystem.html#cdm_reference",
    "href": "Presentations/ecosystem.html#cdm_reference",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "cdm_reference",
    "text": "cdm_reference\nThe cdm_reference is the center of the ecosystem, it is a list with a reference to the different OMOP CDM tables. In general we will create a cdm_reference with the CDMConnector package:\n\nlibrary(CDMConnector)\ncdm &lt;- cdmFromCon(\n  con = con,\n  cdmSchema = \"public\",\n  writeSchema = \"results\",\n  writePrefix = \"mc_\",\n  cdmName = \"my OMOP\"\n)\ncdm\n\n\n\n\n\n\n── # OMOP CDM reference (duckdb) of my OMOP ────────────────────────────────────────────────────────────────────────────\n\n\n• omop tables: care_site, cdm_source, concept, concept_ancestor, concept_class, concept_relationship, concept_synonym,\ncondition_era, condition_occurrence, cost, death, device_exposure, domain, dose_era, drug_era, drug_exposure,\ndrug_strength, fact_relationship, location, measurement, metadata, note, note_nlp, observation, observation_period,\npayer_plan_period, person, procedure_occurrence, provider, relationship, source_to_concept_map, specimen, visit_detail,\nvisit_occurrence, vocabulary\n\n\n• cohort tables: -\n\n\n• achilles tables: -\n\n\n• other tables: -"
  },
  {
    "objectID": "Presentations/ecosystem.html#cdm_reference-1",
    "href": "Presentations/ecosystem.html#cdm_reference-1",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "cdm_reference",
    "text": "cdm_reference\nThe cdm_reference object contains several attributes:\n\nlibrary(omopgenerics)\ncdmName(cdm)\n\n[1] \"my OMOP\"\n\n\n\ncdmVersion(cdm)\n\n[1] \"5.3\"\n\n\n\ncdmSource(cdm)\n\nThis is a duckdb cdm source\n\n\n\nsourceType(cdm)\n\n[1] \"duckdb\""
  },
  {
    "objectID": "Presentations/ecosystem.html#cdm_reference-2",
    "href": "Presentations/ecosystem.html#cdm_reference-2",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "cdm_reference",
    "text": "cdm_reference\nYou can use the cdm_reference object to insert, list, drop or read tables in using the same source of the cdm_reference.\n\n\ncdm &lt;- insertTable(cdm = cdm, name = \"my_table\", table = cars)\ncdm$my_table\n\n# Source:   table&lt;results.test_my_table&gt; [?? x 2]\n# Database: DuckDB 1.4.4 [unknown@Linux 6.11.0-1018-azure:R 4.5.2//tmp/RtmpfqBmVH/file5aff26515451.duckdb]\n   speed  dist\n   &lt;dbl&gt; &lt;dbl&gt;\n 1     4     2\n 2     4    10\n 3     7     4\n 4     7    22\n 5     8    16\n 6     9    10\n 7    10    18\n 8    10    26\n 9    10    34\n10    11    17\n# ℹ more rows\n\n\n\n\n\nlistSourceTables(cdm = cdm)\n\n[1] \"my_table\"\n\n\n\n\n\ncdm$my_table &lt;- NULL\ncdm\n\n\n\n\n── # OMOP CDM reference (duckdb) of my OMOP ────────────────────────────────────────────────────────────────────────────\n\n\n• omop tables: care_site, cdm_source, concept, concept_ancestor, concept_class, concept_relationship, concept_synonym,\ncondition_era, condition_occurrence, cost, death, device_exposure, domain, dose_era, drug_era, drug_exposure,\ndrug_strength, fact_relationship, location, measurement, metadata, note, note_nlp, observation, observation_period,\npayer_plan_period, person, procedure_occurrence, provider, relationship, source_to_concept_map, specimen, visit_detail,\nvisit_occurrence, vocabulary\n\n\n• cohort tables: -\n\n\n• achilles tables: -\n\n\n• other tables: -\n\n\n\n\n\ncdm &lt;- readSourceTable(cdm = cdm, name = \"my_table\")\ncdm\n\n\n\n\n── # OMOP CDM reference (duckdb) of my OMOP ────────────────────────────────────────────────────────────────────────────\n\n\n• omop tables: care_site, cdm_source, concept, concept_ancestor, concept_class, concept_relationship, concept_synonym,\ncondition_era, condition_occurrence, cost, death, device_exposure, domain, dose_era, drug_era, drug_exposure,\ndrug_strength, fact_relationship, location, measurement, metadata, note, note_nlp, observation, observation_period,\npayer_plan_period, person, procedure_occurrence, provider, relationship, source_to_concept_map, specimen, visit_detail,\nvisit_occurrence, vocabulary\n\n\n• cohort tables: -\n\n\n• achilles tables: -\n\n\n• other tables: my_table\n\n\n\n\n\ncdm &lt;- dropSourceTable(cdm = cdm, name = \"my_table\")\ncdm\n\n\n\n\n── # OMOP CDM reference (duckdb) of my OMOP ────────────────────────────────────────────────────────────────────────────\n\n\n• omop tables: care_site, cdm_source, concept, concept_ancestor, concept_class, concept_relationship, concept_synonym,\ncondition_era, condition_occurrence, cost, death, device_exposure, domain, dose_era, drug_era, drug_exposure,\ndrug_strength, fact_relationship, location, measurement, metadata, note, note_nlp, observation, observation_period,\npayer_plan_period, person, procedure_occurrence, provider, relationship, source_to_concept_map, specimen, visit_detail,\nvisit_occurrence, vocabulary\n\n\n• cohort tables: -\n\n\n• achilles tables: -\n\n\n• other tables: -\n\nlistSourceTables(cdm = cdm)\n\ncharacter(0)"
  },
  {
    "objectID": "Presentations/ecosystem.html#cdm_source",
    "href": "Presentations/ecosystem.html#cdm_source",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "cdm_source",
    "text": "cdm_source\nThe cdm_source is an object that defines how to:\n\ncompute a table (compute.&lt;class&gt;)\neliminate a table (dropSourceTable.&lt;class&gt;)\ninsert a table (insertTable.&lt;class&gt;)\nread a table (readSourceTable.&lt;class&gt;)\n\n\nAt the creation of the cdm_source object all these steps will be checked (that’s why creating a cdm_reference can take a few seconds).\n\n\nTo create a new cdm_source object you can use newCdmSource().\n\n\nFor example for CDMConnector ths source contains the connection and the writeSchema:\n\nlibrary(omock)\nlibrary(omopgenerics)\n\ncdm &lt;- mockCdmFromDataset(source = \"duckdb\")\nsrc &lt;- cdmSource(cdm)\nsrc\nunclass(src)\n\nlist()\nattr(,\"dbcon\")\n\n\nattr(,\"write_schema\")\n   schema    prefix \n\"results\"   \"test_\" \nattr(,\"source_type\")\n[1] \"duckdb\""
  },
  {
    "objectID": "Presentations/ecosystem.html#cdm_source-1",
    "href": "Presentations/ecosystem.html#cdm_source-1",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "cdm_source",
    "text": "cdm_source\nYou can summarise the properties of a cdm_source object using summary()\n\n\nsummary(src)\n\nThis is a \u001b[1m\u001b[36mduckdb\u001b[0m source created by \u001b[3m\u001b[36mCDMConnector\u001b[0m package:\n ∙ \u001b[34mwrite_schema\u001b[0m: `results`\n ∙ \u001b[34mwrite_prefix\u001b[0m: `test_`"
  },
  {
    "objectID": "Presentations/ecosystem.html#db_source",
    "href": "Presentations/ecosystem.html#db_source",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "db_source",
    "text": "db_source\nFor example here we can see how the db_source is defined by CDMConnector: https://github.com/darwin-eu/CDMConnector/blob/main/R/dbSource.R"
  },
  {
    "objectID": "Presentations/ecosystem.html#cdm_table",
    "href": "Presentations/ecosystem.html#cdm_table",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "cdm_table",
    "text": "cdm_table\nA cdm_table object is a table that comes from a cdm_reference:\n\n\nclass(cdm$person)\n\n[1] \"omop_table\"            \"cdm_table\"             \"tbl_duckdb_connection\" \"tbl_dbi\"              \n[5] \"tbl_sql\"               \"tbl_lazy\"              \"tbl\"                  \n\n\n\n\nThe cdm_table will always include the reference where they come from, so we will be able to access other tables of the same cdm_reference object:\n\ncdmReference(cdm$person)\n\n\n\n\n── # OMOP CDM reference (duckdb) of GiBleed ────────────────────────────────────────────────────────────────────────────\n\n\n• omop tables: care_site, cdm_source, concept, concept_ancestor, concept_class, concept_relationship, concept_synonym,\ncondition_era, condition_occurrence, cost, death, device_exposure, domain, dose_era, drug_era, drug_exposure,\ndrug_strength, fact_relationship, location, measurement, metadata, note, note_nlp, observation, observation_period,\npayer_plan_period, person, procedure_occurrence, provider, relationship, source_to_concept_map, specimen, visit_detail,\nvisit_occurrence, vocabulary\n\n\n• cohort tables: -\n\n\n• achilles tables: -\n\n\n• other tables: -"
  },
  {
    "objectID": "Presentations/ecosystem.html#cdm_table-1",
    "href": "Presentations/ecosystem.html#cdm_table-1",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "cdm_table",
    "text": "cdm_table\nThe fact that contains the cdm_refernce object allow us to also access the same properties that we had before:\n\ncdmName(cdm$person)\n\n[1] \"GiBleed\"\n\n\n\ncdmVersion(cdm$person)\n\n[1] \"5.3\"\n\n\n\ncdmSource(cdm$person)\n\nThis is a duckdb cdm source\n\n\n\nsourceType(cdm)\n\n[1] \"duckdb\""
  },
  {
    "objectID": "Presentations/ecosystem.html#cdm_table-2",
    "href": "Presentations/ecosystem.html#cdm_table-2",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "cdm_table",
    "text": "cdm_table\nOn top of that extra attributes can be obtained:\n\ntableName(cdm$person)\n\n[1] \"person\"\n\n\n\ntableSource(cdm$person)\n\nThis is a duckdb cdm source"
  },
  {
    "objectID": "Presentations/ecosystem.html#omop_table",
    "href": "Presentations/ecosystem.html#omop_table",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "omop_table",
    "text": "omop_table\nThe omop_table is a subclass of cdm_table that protects the OMOP CDM integrity and validates the OMOP CDM standard tables.\n\n\nclass(cdm$person)\n\n[1] \"omop_table\"            \"cdm_table\"             \"tbl_duckdb_connection\" \"tbl_dbi\"              \n[5] \"tbl_sql\"               \"tbl_lazy\"              \"tbl\"                  \n\n\n\n\nFor example we can not remove required columns from omop_tables:\n\ncdm$person &lt;- cdm$person |&gt;\n  select(!\"person_id\")\n\nError in `newOmopTable()`:\n! person_id is not present in table person\n\n\n\n\nOr assign tables that are not named the same way:\n\ncdm$person &lt;- cdm$drug_exposure\n\nError in `[[&lt;-`:\n✖ You can't assign a table named drug_exposure to person.\nℹ You can change the name using compute:\ncdm[['person']] &lt;- yourObject |&gt;\n  dplyr::compute(name = 'person')\nℹ You can also change the name using the `name` argument in your function: `name = 'person'`.\n\n\n\n\nBut this does not mean that we can not modify them, we can add columns and/or change its content:\n\ncdm$person &lt;- cdm$person |&gt;\n  filter(person_id == 6) |&gt;\n  mutate(extra_col = \"my_content\")\ncdm$person |&gt;\n  glimpse()\n\nRows: ??\nColumns: 19\nDatabase: DuckDB 1.4.4 [unknown@Linux 6.11.0-1018-azure:R 4.5.2//tmp/RtmpfqBmVH/file5aff41e0c1b5.duckdb]\n$ person_id                   &lt;int&gt; 6\n$ gender_concept_id           &lt;int&gt; 8532\n$ year_of_birth               &lt;int&gt; 1963\n$ month_of_birth              &lt;int&gt; 12\n$ day_of_birth                &lt;int&gt; 31\n$ birth_datetime              &lt;dttm&gt; 1963-12-31\n$ race_concept_id             &lt;int&gt; 8516\n$ ethnicity_concept_id        &lt;int&gt; 0\n$ location_id                 &lt;int&gt; NA\n$ provider_id                 &lt;int&gt; NA\n$ care_site_id                &lt;int&gt; NA\n$ person_source_value         &lt;chr&gt; \"001f4a87-70d0-435c-a4b9-1425f6928d33\"\n$ gender_source_value         &lt;chr&gt; \"F\"\n$ gender_source_concept_id    &lt;int&gt; 0\n$ race_source_value           &lt;chr&gt; \"black\"\n$ race_source_concept_id      &lt;int&gt; 0\n$ ethnicity_source_value      &lt;chr&gt; \"west_indian\"\n$ ethnicity_source_concept_id &lt;int&gt; 0\n$ extra_col                   &lt;chr&gt; \"my_content\""
  },
  {
    "objectID": "Presentations/ecosystem.html#achilles_table",
    "href": "Presentations/ecosystem.html#achilles_table",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "achilles_table",
    "text": "achilles_table\nThe class achilles_table is a similar protection for the tables coming form the achilles analyses."
  },
  {
    "objectID": "Presentations/ecosystem.html#cohort_table",
    "href": "Presentations/ecosystem.html#cohort_table",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "cohort_table",
    "text": "cohort_table\nThe cohort_table class is a class built on top of cdm_table (it has all the functionalities seen for cdm_table) with some extra attributes.\n\ncdm\n\n\n\n\n── # OMOP CDM reference (duckdb) of GiBleed ────────────────────────────────────────────────────────────────────────────\n\n\n• omop tables: care_site, cdm_source, concept, concept_ancestor, concept_class, concept_relationship, concept_synonym,\ncondition_era, condition_occurrence, cost, death, device_exposure, domain, dose_era, drug_era, drug_exposure,\ndrug_strength, fact_relationship, location, measurement, metadata, note, note_nlp, observation, observation_period,\npayer_plan_period, person, procedure_occurrence, provider, relationship, source_to_concept_map, specimen, visit_detail,\nvisit_occurrence, vocabulary\n\n\n• cohort tables: my_cohort\n\n\n• achilles tables: -\n\n\n• other tables: -\n\n\n\n\ncdm$my_cohort\n\n# Source:   table&lt;results.test_my_cohort&gt; [?? x 4]\n# Database: DuckDB 1.4.4 [unknown@Linux 6.11.0-1018-azure:R 4.5.2//tmp/RtmpfqBmVH/file5aff11150ad0.duckdb]\n   cohort_definition_id subject_id cohort_start_date cohort_end_date\n                  &lt;int&gt;      &lt;int&gt; &lt;date&gt;            &lt;date&gt;         \n 1                    1        752 1967-07-16        1967-07-23     \n 2                    1       1128 1993-02-05        1993-02-19     \n 3                    1       1432 1964-05-23        1964-06-13     \n 4                    1       1558 1977-11-19        1977-12-03     \n 5                    1       1911 1953-06-19        1953-07-03     \n 6                    1       3144 2019-04-07        2019-04-07     \n 7                    1       3495 1977-06-13        1977-06-27     \n 8                    1       3560 1979-07-21        1979-08-11     \n 9                    1       3852 1995-09-10        1995-10-01     \n10                    1       4022 1976-09-22        1976-09-29     \n# ℹ more rows\n\n\n\n\n\nclass(cdm$my_cohort)\n\n[1] \"cohort_table\"          \"cdm_table\"             \"GeneratedCohortSet\"    \"tbl_duckdb_connection\"\n[5] \"tbl_dbi\"               \"tbl_sql\"               \"tbl_lazy\"              \"tbl\""
  },
  {
    "objectID": "Presentations/ecosystem.html#cohort_table-1",
    "href": "Presentations/ecosystem.html#cohort_table-1",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "cohort_table",
    "text": "cohort_table\n\nattributes(cdm$my_cohort)\n\n$names\n[1] \"src\"        \"lazy_query\"\n\n$class\n[1] \"cohort_table\"          \"cdm_table\"             \"GeneratedCohortSet\"    \"tbl_duckdb_connection\"\n[5] \"tbl_dbi\"               \"tbl_sql\"               \"tbl_lazy\"              \"tbl\"                  \n\n$tbl_source\n\n\n\n$tbl_name\n[1] \"my_cohort\"\n\n$cohort_set\n# Source:   table&lt;results.test_my_cohort_set&gt; [?? x 4]\n# Database: DuckDB 1.4.4 [unknown@Linux 6.11.0-1018-azure:R 4.5.2//tmp/RtmpfqBmVH/file5aff11150ad0.duckdb]\n  cohort_definition_id cohort_name cdm_version vocabulary_version\n                 &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;             \n1                    1 cohort1     5.3         v5.0 18-JAN-19    \n2                    2 cohort2     5.3         v5.0 18-JAN-19    \n\n$cohort_attrition\n# Source:   table&lt;results.test_my_cohort_attrition&gt; [?? x 7]\n# Database: DuckDB 1.4.4 [unknown@Linux 6.11.0-1018-azure:R 4.5.2//tmp/RtmpfqBmVH/file5aff11150ad0.duckdb]\n  cohort_definition_id number_records number_subjects reason_id reason                excluded_records excluded_subjects\n                 &lt;int&gt;          &lt;int&gt;           &lt;int&gt;     &lt;int&gt; &lt;chr&gt;                            &lt;int&gt;             &lt;int&gt;\n1                    1          17268            2686         1 Initial qualifying e…                0                 0\n2                    1          17268            2686         2 Record in observation                0                 0\n3                    1          17268            2686         3 Not missing record d…                0                 0\n4                    2          10217            2606         1 Initial qualifying e…                0                 0\n5                    2          10217            2606         2 Record in observation                0                 0\n6                    2          10217            2606         3 Not missing record d…                0                 0\n7                    1          17268            2686         4 Merge overlapping re…                0                 0\n8                    2          10217            2606         4 Merge overlapping re…                0                 0\n\n$cohort_codelist\n# Source:   table&lt;results.test_my_cohort_codelist&gt; [?? x 4]\n# Database: DuckDB 1.4.4 [unknown@Linux 6.11.0-1018-azure:R 4.5.2//tmp/RtmpfqBmVH/file5aff11150ad0.duckdb]\n  cohort_definition_id codelist_name concept_id codelist_type\n                 &lt;int&gt; &lt;chr&gt;              &lt;int&gt; &lt;chr&gt;        \n1                    1 cohort1         40481087 index event  \n2                    2 cohort2          4112343 index event  \n\n$cdm_reference"
  },
  {
    "objectID": "Presentations/ecosystem.html#cohort_table-2",
    "href": "Presentations/ecosystem.html#cohort_table-2",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "cohort_table",
    "text": "cohort_table\nWe can access those attributes:\n\n\nsettings(cdm$my_cohort)\n\n# A tibble: 2 × 4\n  cohort_definition_id cohort_name cdm_version vocabulary_version\n                 &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;       &lt;chr&gt;             \n1                    1 cohort1     5.3         v5.0 18-JAN-19    \n2                    2 cohort2     5.3         v5.0 18-JAN-19    \n\n\n\n\n\ncohortCount(cdm$my_cohort)\n\n# A tibble: 2 × 3\n  cohort_definition_id number_records number_subjects\n                 &lt;int&gt;          &lt;int&gt;           &lt;int&gt;\n1                    1          17268            2686\n2                    2          10217            2606"
  },
  {
    "objectID": "Presentations/ecosystem.html#cohort_table-3",
    "href": "Presentations/ecosystem.html#cohort_table-3",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "cohort_table",
    "text": "cohort_table\n\nattrition(cdm$my_cohort)\n\n# A tibble: 8 × 7\n  cohort_definition_id number_records number_subjects reason_id reason                excluded_records excluded_subjects\n                 &lt;int&gt;          &lt;int&gt;           &lt;int&gt;     &lt;int&gt; &lt;chr&gt;                            &lt;int&gt;             &lt;int&gt;\n1                    1          17268            2686         1 Initial qualifying e…                0                 0\n2                    1          17268            2686         2 Record in observation                0                 0\n3                    1          17268            2686         3 Not missing record d…                0                 0\n4                    1          17268            2686         4 Merge overlapping re…                0                 0\n5                    2          10217            2606         1 Initial qualifying e…                0                 0\n6                    2          10217            2606         2 Record in observation                0                 0\n7                    2          10217            2606         3 Not missing record d…                0                 0\n8                    2          10217            2606         4 Merge overlapping re…                0                 0"
  },
  {
    "objectID": "Presentations/ecosystem.html#cohort_table-4",
    "href": "Presentations/ecosystem.html#cohort_table-4",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "cohort_table",
    "text": "cohort_table\nWe can easily update the attrition as:\n\ncdm$my_cohort &lt;- cdm$my_cohort |&gt;\n  filter(subject_id %% 2 == 0) |&gt;\n  compute(name = \"my_cohort\") |&gt;\n  recordCohortAttrition(\"Onlye even subjects\")\n\n\n\ncohortCount(cdm$my_cohort)\n\n# A tibble: 2 × 3\n  cohort_definition_id number_records number_subjects\n                 &lt;int&gt;          &lt;int&gt;           &lt;int&gt;\n1                    1           8574            1339\n2                    2           5072            1299\n\nattrition(cdm$my_cohort)\n\n# A tibble: 10 × 7\n   cohort_definition_id number_records number_subjects reason_id reason               excluded_records excluded_subjects\n                  &lt;int&gt;          &lt;int&gt;           &lt;int&gt;     &lt;int&gt; &lt;chr&gt;                           &lt;int&gt;             &lt;int&gt;\n 1                    1          17268            2686         1 Initial qualifying …                0                 0\n 2                    1          17268            2686         2 Record in observati…                0                 0\n 3                    1          17268            2686         3 Not missing record …                0                 0\n 4                    1          17268            2686         4 Merge overlapping r…                0                 0\n 5                    1           8574            1339         5 Onlye even subjects              8694              1347\n 6                    2          10217            2606         1 Initial qualifying …                0                 0\n 7                    2          10217            2606         2 Record in observati…                0                 0\n 8                    2          10217            2606         3 Not missing record …                0                 0\n 9                    2          10217            2606         4 Merge overlapping r…                0                 0\n10                    2           5072            1299         5 Onlye even subjects              5145              1307"
  },
  {
    "objectID": "Presentations/ecosystem.html#codelists",
    "href": "Presentations/ecosystem.html#codelists",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Codelists",
    "text": "Codelists\nThe package defines 3 different ways to define code lists:\n\ncodelist\ncodelist_with_details\nconcept_set_expression"
  },
  {
    "objectID": "Presentations/ecosystem.html#codelist",
    "href": "Presentations/ecosystem.html#codelist",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "codelist",
    "text": "codelist\n\ncodelist &lt;- newCodelist(list(my_codes = c(1, 2, 3), condition2 = c(3, 4)))\ncodelist\n\n\n\n\n── 2 codelists ─────────────────────────────────────────────────────────────────────────────────────────────────────────\n\n\n\n- condition2 (2 codes)\n- my_codes (3 codes)\n\n\n\ncodelist$my_codes\n\n[1] 1 2 3"
  },
  {
    "objectID": "Presentations/ecosystem.html#codelist_with_details",
    "href": "Presentations/ecosystem.html#codelist_with_details",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "codelist_with_details",
    "text": "codelist_with_details\n\ncodelist &lt;- list(\n  my_codes = tibble(\n    concept_id = c(1L, 2L, 3L),\n    extra_properties = c(\"a\", \"b\", \"c\")\n  ), \n  condition2 = tibble(\n    concept_id = c(3L, 4L),\n    concept_name = c(\"code 3\", \"code 4\")\n  )\n) |&gt;\n  newCodelistWithDetails()\ncodelist\n\n\n\n\n── 2 codelists with details ────────────────────────────────────────────────────────────────────────────────────────────\n\n\n\n- condition2 (2 codes)\n- my_codes (3 codes)\n\n\n\ncodelist$my_codes\n\n# A tibble: 3 × 2\n  concept_id extra_properties\n       &lt;int&gt; &lt;chr&gt;           \n1          1 a               \n2          2 b               \n3          3 c"
  },
  {
    "objectID": "Presentations/ecosystem.html#codelist-1",
    "href": "Presentations/ecosystem.html#codelist-1",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "codelist",
    "text": "codelist"
  },
  {
    "objectID": "Presentations/ecosystem.html#codelist-2",
    "href": "Presentations/ecosystem.html#codelist-2",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "codelist",
    "text": "codelist\n\ncodelist &lt;- newCodelist(list(my_codes = c(1, 2, 3), condition2 = c(3, 4)))\ncodelist\n\n\n\n\n── 2 codelists ─────────────────────────────────────────────────────────────────────────────────────────────────────────\n\n\n\n- condition2 (2 codes)\n- my_codes (3 codes)\n\n\n\ncodelist$my_codes\n\n[1] 1 2 3"
  },
  {
    "objectID": "Presentations/ecosystem.html#concept_set_expression",
    "href": "Presentations/ecosystem.html#concept_set_expression",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "concept_set_expression",
    "text": "concept_set_expression\n\ncodelist &lt;- list(\n  my_codes = tibble(\n    concept_id = c(1L, 2L, 3L),\n    descendants = c(T, F, T),\n    excluded = c(F, T, F),\n    mapped = F\n  ), \n  condition2 = tibble(\n    concept_id = c(3L, 4L),\n    descendants = c(T, F),\n    excluded = c(F, T),\n    mapped = F\n  )\n) |&gt;\n  newConceptSetExpression()\ncodelist\n\n\n\n\n── 2 concept set expressions ───────────────────────────────────────────────────────────────────────────────────────────\n\n\n\n- condition2 (2 concept criteria)\n- my_codes (3 concept criteria)\n\n\n\ncodelist$my_codes\n\n# A tibble: 3 × 4\n  concept_id excluded descendants mapped\n       &lt;int&gt; &lt;lgl&gt;    &lt;lgl&gt;       &lt;lgl&gt; \n1          1 FALSE    TRUE        FALSE \n2          2 TRUE     FALSE       FALSE \n3          3 FALSE    TRUE        FALSE"
  },
  {
    "objectID": "Presentations/ecosystem.html#combine-and-subset-codelists",
    "href": "Presentations/ecosystem.html#combine-and-subset-codelists",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Combine and Subset codelists",
    "text": "Combine and Subset codelists\nomopgenerics contains methods so that combining and subsetting codelists will preserve the class object:\n\n\ncodelist1 &lt;- newCodelist(list(concept_1 = 1L, anxiety = c(4L, 5L)))\ncodelist2 &lt;- newCodelist(list(hypertension = 6L))\nc(codelist1, codelist2)\n\n\n- anxiety (2 codes)\n- concept_1 (1 codes)\n- hypertension (1 codes)\n\n\n\n\n\ncodelist1[\"anxiety\"]\n\n\n- anxiety (2 codes)"
  },
  {
    "objectID": "Presentations/ecosystem.html#codelistgenerator",
    "href": "Presentations/ecosystem.html#codelistgenerator",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "CodelistGenerator",
    "text": "CodelistGenerator\nCodelistGenerator provides multiple functionality to manage the 3 codelists classes, combine them, compare them:\n\nget*Codes() to create different code lists\nsubset*() to subset code lists\nstratify*() to stratify code lists\nasCodelist(), asCodelistWithDetails(), asConceptSetExpression()"
  },
  {
    "objectID": "Presentations/ecosystem.html#the-conceptset-argument",
    "href": "Presentations/ecosystem.html#the-conceptset-argument",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "The conceptSet argument",
    "text": "The conceptSet argument\nIn general analytical packages will have an argument named conceptSet the input of this argument can either be a codelist, codelist_with_details or concept_set_expression or an object that can be converted to any of these objects (e.g. list(concept = 1))."
  },
  {
    "objectID": "Presentations/ecosystem.html#export-codelist",
    "href": "Presentations/ecosystem.html#export-codelist",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Export codelist",
    "text": "Export codelist\ncodelist and concept_set_expressions can be exported in json or csv format:\n\n\nlibrary(here)\nexportCodelist(codelist, path = here(), type = \"csv\")\nexportCodelist(codelist, path = here(), type = \"json\")\nexportConceptSetExpression(codelist, path = here(), type = \"csv\")\nexportConceptSetExpression(codelist, path = here(), type = \"json\")\n\n\n\nThen later can be also imported:\n\ncodelist &lt;- importCodelist(path = here(), type = \"csv\")\ncodelist &lt;- importCodelist(path = here(), type = \"json\")\ncodelist &lt;- importConceptSetExpression(path = here(), type = \"csv\")\ncodelist &lt;- importConceptSetExpression(path = here(), type = \"json\")\n\nJSON file definition is the same than ATLAS and in line with the guidelines of OHDSI TAB."
  },
  {
    "objectID": "Presentations/ecosystem.html#summarised_result",
    "href": "Presentations/ecosystem.html#summarised_result",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "summarised_result",
    "text": "summarised_result\nThe summarised_result is the result model defined by omopgenerics"
  },
  {
    "objectID": "Presentations/ecosystem.html#visualisations-with-summarised_result",
    "href": "Presentations/ecosystem.html#visualisations-with-summarised_result",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Visualisations with summarised_result",
    "text": "Visualisations with summarised_result\nThe visOmopResults provides multiple functionality to to create tables and plot from the summarised_result object:\n\nCreate Tables using summarised_results\nCreate Plots using summarised_results"
  },
  {
    "objectID": "Presentations/ecosystem.html#further-reading",
    "href": "Presentations/ecosystem.html#further-reading",
    "title": "The Tidy R in OMOP CDM ecosystem",
    "section": "Further reading",
    "text": "Further reading\n\nTidy R packages foundations: https://ohdsi.github.io/Tidy-R-programming-with-OMOP/\nTidy R packages develioment: https://oxford-pharmacoepi.github.io/Tidy-R-packages-with-OMOP/"
  },
  {
    "objectID": "Presentations/allofus.html#allofus-r-package-authors",
    "href": "Presentations/allofus.html#allofus-r-package-authors",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "allofus R package authors",
    "text": "allofus R package authors\n\n\n\nLouisa Smith\n\nAssistant Professor at Northeastern University in the department of Public Health and Health Sciences and at the Roux Institute\n\n\n\n\n\nRob Cavanaugh\n\nAssistant Professor at the Massachusetts General Hospital Institute for Health Professions with appointments in Communication Science and Disorders and Genetic Counseling"
  },
  {
    "objectID": "Presentations/allofus.html#all-of-us-research-program",
    "href": "Presentations/allofus.html#all-of-us-research-program",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "All of Us Research Program",
    "text": "All of Us Research Program\n\nLaunched in 2018 by the National Institutes of Health (NIH)\nGoal: gather data from 1 million or more people living in the United States to accelerate research and improve health\n\nData types: EHR, surveys, physical measurements, genomics, wearables\nRight now about 600,000 have EHR, initial surveys, physical measurements, biospecimens"
  },
  {
    "objectID": "Presentations/allofus.html#all-of-us-researcher-workbench",
    "href": "Presentations/allofus.html#all-of-us-researcher-workbench",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "All of Us Researcher Workbench",
    "text": "All of Us Researcher Workbench\n\nCloud-based platform to access All of Us data for analysis\nData stored in Google BigQuery in the OMOP Common Data Model\nAccess directly via SQL queries or using Cohort Builder tool\nAnalysis in R, Python, or SAS"
  },
  {
    "objectID": "Presentations/allofus.html#costs",
    "href": "Presentations/allofus.html#costs",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Costs",
    "text": "Costs"
  },
  {
    "objectID": "Presentations/allofus.html#costs-1",
    "href": "Presentations/allofus.html#costs-1",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Costs",
    "text": "Costs"
  },
  {
    "objectID": "Presentations/allofus.html#cohort-builder",
    "href": "Presentations/allofus.html#cohort-builder",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Cohort Builder",
    "text": "Cohort Builder"
  },
  {
    "objectID": "Presentations/allofus.html#concept-set-builder",
    "href": "Presentations/allofus.html#concept-set-builder",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Concept Set Builder",
    "text": "Concept Set Builder"
  },
  {
    "objectID": "Presentations/allofus.html#dataset-builder",
    "href": "Presentations/allofus.html#dataset-builder",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Dataset Builder",
    "text": "Dataset Builder"
  },
  {
    "objectID": "Presentations/allofus.html#creates-code",
    "href": "Presentations/allofus.html#creates-code",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Creates code",
    "text": "Creates code"
  },
  {
    "objectID": "Presentations/allofus.html#code-writes-csv-files",
    "href": "Presentations/allofus.html#code-writes-csv-files",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Code writes csv files",
    "text": "Code writes csv files\n\n# Formulate a Cloud Storage destination path for the data exported from BigQuery.\n# NOTE: By default data exported multiple times on the same day will overwrite older copies.\n#       But data exported on a different days will write to a new location so that historical\n#       copies can be kept as the dataset definition is changed.\nsurvey_61548618_path &lt;- file.path(\n  Sys.getenv(\"WORKSPACE_BUCKET\"),\n  \"bq_exports\",\n  Sys.getenv(\"OWNER_EMAIL\"),\n  strftime(lubridate::now(), \"%Y%m%d\"),  # Comment out this line if you want the export to always overwrite.\n  \"survey_61548618\",\n  \"survey_61548618_*.csv\")\nmessage(str_glue('The data will be written to {survey_61548618_path}. Use this path when reading ',\n                 'the data into your notebooks in the future.'))\n\n# Perform the query and export the dataset to Cloud Storage as CSV files.\n# NOTE: You only need to run `bq_table_save` once. After that, you can\n#       just read data from the CSVs in Cloud Storage.\nbq_table_save(\n  bq_dataset_query(Sys.getenv(\"WORKSPACE_CDR\"), dataset_61548618_survey_sql, billing = Sys.getenv(\"GOOGLE_PROJECT\")),\n  survey_61548618_path,\n  destination_format = \"CSV\")\n\n\n# Read the data directly from Cloud Storage into memory.\n# NOTE: Alternatively you can `gsutil -m cp {survey_61548618_path}` to copy these files\n#       to the Jupyter disk.\nread_bq_export_from_workspace_bucket &lt;- function(export_path) {\n  col_types &lt;- cols(survey = col_character(), question = col_character(), answer = col_character(), survey_version_name = col_character())\n  bind_rows(\n    map(system2('gsutil', args = c('ls', export_path), stdout = TRUE, stderr = TRUE),\n        function(csv) {\n          message(str_glue('Loading {csv}.'))\n          chunk &lt;- read_csv(pipe(str_glue('gsutil cat {csv}')), col_types = col_types, show_col_types = FALSE)\n          if (is.null(col_types)) {\n            col_types &lt;- spec(chunk)\n          }\n          chunk\n        }))\n}\ndataset_61548618_survey_df &lt;- read_bq_export_from_workspace_bucket(survey_61548618_path)"
  },
  {
    "objectID": "Presentations/allofus.html#challenges",
    "href": "Presentations/allofus.html#challenges",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Challenges",
    "text": "Challenges\n\nPoint-and-click tools very limited, results in huge csv files\nBut lack of programming skills…\n\nHealth researchers often use R or SAS, some use python, few use SQL\ntidyverse is (the most?) popular framework for R\n\nAll of Us data is complex\n\nthe OMOP CDM has a steep learning curve, plus the complexity of the other data (e.g., surveys)\nmany researchers are trained on cleaner, more straightforward data\n\nLarge scale observational health research is hard\n\ndefining cohorts with appropriate inclusion/exclusion criteria, exposure/outcome phenotypes, time under observation, etc.\nreproducibility is critical"
  },
  {
    "objectID": "Presentations/allofus.html#allofus-r-package",
    "href": "Presentations/allofus.html#allofus-r-package",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "allofus R package",
    "text": "allofus R package\n\n\n\n\n\nBuild on existing tools/skills\nEnable complex research\nEfficient (compared to built-in tools)\nReadable and reproducible"
  },
  {
    "objectID": "Presentations/allofus.html#begin-in-r-not-cohort-builder",
    "href": "Presentations/allofus.html#begin-in-r-not-cohort-builder",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Begin in R, not Cohort Builder",
    "text": "Begin in R, not Cohort Builder\n\nlibrary(allofus)\nlibrary(tidyverse)\n\ncon &lt;- aou_connect()\n\nError:\n! Unable to connect to CDR"
  },
  {
    "objectID": "Presentations/allofus.html#access-tables",
    "href": "Presentations/allofus.html#access-tables",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Access tables",
    "text": "Access tables\nUnder the hood, dbplyr (part of the tidyverse) allows researchers to use many of the same functions on a remote table that they would use on a dataframe\n\nperson &lt;- tbl(con, \"person\")\n\nError:\n! object 'con' not found\n\ncolnames(person)\n\nNULL"
  },
  {
    "objectID": "Presentations/allofus.html#quick-data-manipulations-and-computations",
    "href": "Presentations/allofus.html#quick-data-manipulations-and-computations",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Quick data manipulations and computations",
    "text": "Quick data manipulations and computations\nUsers are running SQL queries without realizing they’re running SQL queries\n\nperson |&gt;\n  mutate(birth_decade = cut(year_of_birth, \n                            breaks = c(1930, 1940, 1950, 1960, 1970, \n                                       1980, 1990, 2000, 2010))) |&gt;\n  count(birth_decade)\n\nError in `UseMethod()`:\n! no applicable method for 'mutate' applied to an object of class \"function\""
  },
  {
    "objectID": "Presentations/allofus.html#creating-cohorts-with-allofus",
    "href": "Presentations/allofus.html#creating-cohorts-with-allofus",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Creating cohorts with allofus",
    "text": "Creating cohorts with allofus\n\nreproductive_age_female &lt;- tbl(con, \"cb_search_person\") |&gt; \n  filter(age_at_consent &gt;= 18 & age_at_consent &lt;= 55, \n         sex_at_birth == \"Female\")\n\nError:\n! object 'con' not found\n\nhypertensive_disorder &lt;- tbl(con, \"concept_ancestor\") |&gt; \n  filter(ancestor_concept_id == 316866) |&gt; \n  inner_join(\n    tbl(con, \"condition_occurrence\"), \n    by = join_by(descendant_concept_id == condition_concept_id)) |&gt; \n  distinct(person_id)\n\nError:\n! object 'con' not found\n\ncohort &lt;- reproductive_age_female |&gt; \n  inner_join(hypertensive_disorder, by = join_by(person_id))\n\nError:\n! object 'reproductive_age_female' not found\n\ntally(cohort)\n\nError:\n! object 'cohort' not found"
  },
  {
    "objectID": "Presentations/allofus.html#creating-datasets-with-cohort-builder",
    "href": "Presentations/allofus.html#creating-datasets-with-cohort-builder",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Creating datasets with Cohort Builder",
    "text": "Creating datasets with Cohort Builder\n\nlibrary(tidyverse)\nlibrary(bigrquery)\n\n# This query represents dataset \"hypertension in pregnancy\" for domain \"person\" and was generated for All of Us Registered Tier Dataset v7\ndataset_71250616_person_sql &lt;- paste(\"\n    SELECT\n        person.person_id,\n        person.gender_concept_id,\n        p_gender_concept.concept_name as gender,\n        person.birth_datetime as date_of_birth,\n        person.race_concept_id,\n        p_race_concept.concept_name as race,\n        person.ethnicity_concept_id,\n        p_ethnicity_concept.concept_name as ethnicity,\n        person.sex_at_birth_concept_id,\n        p_sex_at_birth_concept.concept_name as sex_at_birth \n    FROM\n        `person` person \n    LEFT JOIN\n        `concept` p_gender_concept \n            ON person.gender_concept_id = p_gender_concept.concept_id \n    LEFT JOIN\n        `concept` p_race_concept \n            ON person.race_concept_id = p_race_concept.concept_id \n    LEFT JOIN\n        `concept` p_ethnicity_concept \n            ON person.ethnicity_concept_id = p_ethnicity_concept.concept_id \n    LEFT JOIN\n        `concept` p_sex_at_birth_concept \n            ON person.sex_at_birth_concept_id = p_sex_at_birth_concept.concept_id  \n    WHERE\n        person.PERSON_ID IN (SELECT\n            distinct person_id  \n        FROM\n            `cb_search_person` cb_search_person  \n        WHERE\n            cb_search_person.person_id IN (SELECT\n                person_id \n            FROM\n                `cb_search_person` p \n            WHERE\n                age_at_consent BETWEEN 18 AND 50 \n            AND cb_search_person.person_id IN (SELECT\n                person_id \n            FROM\n                `person` p \n            WHERE\n                sex_at_birth_concept_id IN (45878463) ) \n            AND cb_search_person.person_id IN (SELECT\n                criteria.person_id \n            FROM\n                (SELECT\n                    DISTINCT person_id, entry_date, concept_id \n                FROM\n                    `cb_search_all_events` \n                WHERE\n                    (concept_id IN(SELECT\n                        DISTINCT c.concept_id \n                    FROM\n                        `cb_criteria` c \n                    JOIN\n                        (SELECT\n                            CAST(cr.id as string) AS id       \n                        FROM\n                            `cb_criteria` cr       \n                        WHERE\n                            concept_id IN (316866)       \n                            AND full_text LIKE '%_rank1]%'      ) a \n                            ON (c.path LIKE CONCAT('%.', a.id, '.%') \n                            OR c.path LIKE CONCAT('%.', a.id) \n                            OR c.path LIKE CONCAT(a.id, '.%') \n                            OR c.path = a.id) \n                    WHERE\n                        is_standard = 1 \n                        AND is_selectable = 1) \n                    AND is_standard = 1 )) criteria ) )\", sep=\"\")\n\n# Formulate a Cloud Storage destination path for the data exported from BigQuery.\n# NOTE: By default data exported multiple times on the same day will overwrite older copies.\n#       But data exported on a different days will write to a new location so that historical\n#       copies can be kept as the dataset definition is changed.\nperson_71250616_path &lt;- file.path(\n  Sys.getenv(\"WORKSPACE_BUCKET\"),\n  \"bq_exports\",\n  Sys.getenv(\"OWNER_EMAIL\"),\n  strftime(lubridate::now(), \"%Y%m%d\"),  # Comment out this line if you want the export to always overwrite.\n  \"person_71250616\",\n  \"person_71250616_*.csv\")\nmessage(str_glue('The data will be written to {person_71250616_path}. Use this path when reading ',\n                 'the data into your notebooks in the future.'))\n\n# Perform the query and export the dataset to Cloud Storage as CSV files.\n# NOTE: You only need to run `bq_table_save` once. After that, you can\n#       just read data from the CSVs in Cloud Storage.\nbq_table_save(\n  bq_dataset_query(Sys.getenv(\"WORKSPACE_CDR\"), dataset_71250616_person_sql, billing = Sys.getenv(\"GOOGLE_PROJECT\")),\n  person_71250616_path,\n  destination_format = \"CSV\")\n\n\n# Read the data directly from Cloud Storage into memory.\n# NOTE: Alternatively you can `gsutil -m cp {person_71250616_path}` to copy these files\n#       to the Jupyter disk.\nread_bq_export_from_workspace_bucket &lt;- function(export_path) {\n  col_types &lt;- cols(gender = col_character(), race = col_character(), ethnicity = col_character(), sex_at_birth = col_character())\n  bind_rows(\n    map(system2('gsutil', args = c('ls', export_path), stdout = TRUE, stderr = TRUE),\n        function(csv) {\n          message(str_glue('Loading {csv}.'))\n          chunk &lt;- read_csv(pipe(str_glue('gsutil cat {csv}')), col_types = col_types, show_col_types = FALSE)\n          if (is.null(col_types)) {\n            col_types &lt;- spec(chunk)\n          }\n          chunk\n        }))\n}\ndataset_71250616_person_df &lt;- read_bq_export_from_workspace_bucket(person_71250616_path)\n\ndim(dataset_71250616_person_df)\n\nhead(dataset_71250616_person_df, 5)\nlibrary(tidyverse)\nlibrary(bigrquery)\n\n# This query represents dataset \"hypertension in pregnancy\" for domain \"condition\" and was generated for All of Us Registered Tier Dataset v7\ndataset_71250616_condition_sql &lt;- paste(\"\n    SELECT\n        c_occurrence.person_id,\n        c_occurrence.condition_concept_id,\n        c_standard_concept.concept_name as standard_concept_name,\n        c_standard_concept.concept_code as standard_concept_code,\n        c_standard_concept.vocabulary_id as standard_vocabulary,\n        c_occurrence.condition_start_datetime,\n        c_occurrence.condition_end_datetime,\n        c_occurrence.condition_type_concept_id,\n        c_type.concept_name as condition_type_concept_name,\n        c_occurrence.stop_reason,\n        c_occurrence.visit_occurrence_id,\n        visit.concept_name as visit_occurrence_concept_name,\n        c_occurrence.condition_source_value,\n        c_occurrence.condition_source_concept_id,\n        c_source_concept.concept_name as source_concept_name,\n        c_source_concept.concept_code as source_concept_code,\n        c_source_concept.vocabulary_id as source_vocabulary,\n        c_occurrence.condition_status_source_value,\n        c_occurrence.condition_status_concept_id,\n        c_status.concept_name as condition_status_concept_name \n    FROM\n        ( SELECT\n            * \n        FROM\n            `condition_occurrence` c_occurrence \n        WHERE\n            (\n                condition_concept_id IN (SELECT\n                    DISTINCT c.concept_id \n                FROM\n                    `cb_criteria` c \n                JOIN\n                    (SELECT\n                        CAST(cr.id as string) AS id       \n                    FROM\n                        `cb_criteria` cr       \n                    WHERE\n                        concept_id IN (132685, 133816, 134414, 135601, 136743, 137613, 138811, 141084, 314090, 35622939, 4034096, 4057976, 4116344, 4283352, 433536, 438490, 439077, 439393, 443700)       \n                        AND full_text LIKE '%_rank1]%'      ) a \n                        ON (c.path LIKE CONCAT('%.', a.id, '.%') \n                        OR c.path LIKE CONCAT('%.', a.id) \n                        OR c.path LIKE CONCAT(a.id, '.%') \n                        OR c.path = a.id) \n                WHERE\n                    is_standard = 1 \n                    AND is_selectable = 1)\n            )  \n            AND (\n                c_occurrence.PERSON_ID IN (SELECT\n                    distinct person_id  \n                FROM\n                    `cb_search_person` cb_search_person  \n                WHERE\n                    cb_search_person.person_id IN (SELECT\n                        person_id \n                    FROM\n                        `cb_search_person` p \n                    WHERE\n                        age_at_consent BETWEEN 18 AND 50 \n                    AND cb_search_person.person_id IN (SELECT\n                        person_id \n                    FROM\n                        `person` p \n                    WHERE\n                        sex_at_birth_concept_id IN (45878463) ) \n                    AND cb_search_person.person_id IN (SELECT\n                        criteria.person_id \n                    FROM\n                        (SELECT\n                            DISTINCT person_id, entry_date, concept_id \n                        FROM\n                            `cb_search_all_events` \n                        WHERE\n                            (concept_id IN(SELECT\n                                DISTINCT c.concept_id \n                            FROM\n                                `cb_criteria` c \n                            JOIN\n                                (SELECT\n                                    CAST(cr.id as string) AS id       \n                                FROM\n                                    `cb_criteria` cr       \n                                WHERE\n                                    concept_id IN (316866)       \n                                    AND full_text LIKE '%_rank1]%'      ) a \n                                    ON (c.path LIKE CONCAT('%.', a.id, '.%') \n                                    OR c.path LIKE CONCAT('%.', a.id) \n                                    OR c.path LIKE CONCAT(a.id, '.%') \n                                    OR c.path = a.id) \n                            WHERE\n                                is_standard = 1 \n                                AND is_selectable = 1) \n                            AND is_standard = 1 )) criteria ) )\n            )) c_occurrence \n    LEFT JOIN\n        `concept` c_standard_concept \n            ON c_occurrence.condition_concept_id = c_standard_concept.concept_id \n    LEFT JOIN\n        `concept` c_type \n            ON c_occurrence.condition_type_concept_id = c_type.concept_id \n    LEFT JOIN\n        `visit_occurrence` v \n            ON c_occurrence.visit_occurrence_id = v.visit_occurrence_id \n    LEFT JOIN\n        `concept` visit \n            ON v.visit_concept_id = visit.concept_id \n    LEFT JOIN\n        `concept` c_source_concept \n            ON c_occurrence.condition_source_concept_id = c_source_concept.concept_id \n    LEFT JOIN\n        `concept` c_status \n            ON c_occurrence.condition_status_concept_id = c_status.concept_id\", sep=\"\")\n\n# Formulate a Cloud Storage destination path for the data exported from BigQuery.\n# NOTE: By default data exported multiple times on the same day will overwrite older copies.\n#       But data exported on a different days will write to a new location so that historical\n#       copies can be kept as the dataset definition is changed.\ncondition_71250616_path &lt;- file.path(\n  Sys.getenv(\"WORKSPACE_BUCKET\"),\n  \"bq_exports\",\n  Sys.getenv(\"OWNER_EMAIL\"),\n  strftime(lubridate::now(), \"%Y%m%d\"),  # Comment out this line if you want the export to always overwrite.\n  \"condition_71250616\",\n  \"condition_71250616_*.csv\")\nmessage(str_glue('The data will be written to {condition_71250616_path}. Use this path when reading ',\n                 'the data into your notebooks in the future.'))\n\n# Perform the query and export the dataset to Cloud Storage as CSV files.\n# NOTE: You only need to run `bq_table_save` once. After that, you can\n#       just read data from the CSVs in Cloud Storage.\nbq_table_save(\n  bq_dataset_query(Sys.getenv(\"WORKSPACE_CDR\"), dataset_71250616_condition_sql, billing = Sys.getenv(\"GOOGLE_PROJECT\")),\n  condition_71250616_path,\n  destination_format = \"CSV\")\n\n\n# Read the data directly from Cloud Storage into memory.\n# NOTE: Alternatively you can `gsutil -m cp {condition_71250616_path}` to copy these files\n#       to the Jupyter disk.\nread_bq_export_from_workspace_bucket &lt;- function(export_path) {\n  col_types &lt;- cols(standard_concept_name = col_character(), standard_concept_code = col_character(), standard_vocabulary = col_character(), condition_type_concept_name = col_character(), stop_reason = col_character(), visit_occurrence_concept_name = col_character(), condition_source_value = col_character(), source_concept_name = col_character(), source_concept_code = col_character(), source_vocabulary = col_character(), condition_status_source_value = col_character(), condition_status_concept_name = col_character())\n  bind_rows(\n    map(system2('gsutil', args = c('ls', export_path), stdout = TRUE, stderr = TRUE),\n        function(csv) {\n          message(str_glue('Loading {csv}.'))\n          chunk &lt;- read_csv(pipe(str_glue('gsutil cat {csv}')), col_types = col_types, show_col_types = FALSE)\n          if (is.null(col_types)) {\n            col_types &lt;- spec(chunk)\n          }\n          chunk\n        }))\n}\ndataset_71250616_condition_df &lt;- read_bq_export_from_workspace_bucket(condition_71250616_path)\n\ndim(dataset_71250616_condition_df)\n\nhead(dataset_71250616_condition_df, 5)\nlibrary(tidyverse)\nlibrary(bigrquery)\n\n# This query represents dataset \"hypertension in pregnancy\" for domain \"measurement\" and was generated for All of Us Registered Tier Dataset v7\ndataset_71250616_measurement_sql &lt;- paste(\"\n    SELECT\n        measurement.person_id,\n        measurement.measurement_concept_id,\n        m_standard_concept.concept_name as standard_concept_name,\n        m_standard_concept.concept_code as standard_concept_code,\n        m_standard_concept.vocabulary_id as standard_vocabulary,\n        measurement.measurement_datetime,\n        measurement.measurement_type_concept_id,\n        m_type.concept_name as measurement_type_concept_name,\n        measurement.operator_concept_id,\n        m_operator.concept_name as operator_concept_name,\n        measurement.value_as_number,\n        measurement.value_as_concept_id,\n        m_value.concept_name as value_as_concept_name,\n        measurement.unit_concept_id,\n        m_unit.concept_name as unit_concept_name,\n        measurement.range_low,\n        measurement.range_high,\n        measurement.visit_occurrence_id,\n        m_visit.concept_name as visit_occurrence_concept_name,\n        measurement.measurement_source_value,\n        measurement.measurement_source_concept_id,\n        m_source_concept.concept_name as source_concept_name,\n        m_source_concept.concept_code as source_concept_code,\n        m_source_concept.vocabulary_id as source_vocabulary,\n        measurement.unit_source_value,\n        measurement.value_source_value \n    FROM\n        ( SELECT\n            * \n        FROM\n            `measurement` measurement \n        WHERE\n            (\n                measurement_concept_id IN (SELECT\n                    DISTINCT c.concept_id \n                FROM\n                    `cb_criteria` c \n                JOIN\n                    (SELECT\n                        CAST(cr.id as string) AS id       \n                    FROM\n                        `cb_criteria` cr       \n                    WHERE\n                        concept_id IN (21490851, 21490853, 3004249, 3005606, 3009395, 3012526, 3012888, 3013940, 3017490, 3018586, 3018592, 3018822, 3019962, 3027598, 3028737, 3031203, 3034703, 3035856, 36716965, 4060834, 40758413, 4152194, 4154790, 4232915, 4239021, 4248524, 4298393, 4302410, 44789315, 44789316)       \n                        AND full_text LIKE '%_rank1]%'      ) a \n                        ON (c.path LIKE CONCAT('%.', a.id, '.%') \n                        OR c.path LIKE CONCAT('%.', a.id) \n                        OR c.path LIKE CONCAT(a.id, '.%') \n                        OR c.path = a.id) \n                WHERE\n                    is_standard = 1 \n                    AND is_selectable = 1)\n            )  \n            AND (\n                measurement.PERSON_ID IN (SELECT\n                    distinct person_id  \n                FROM\n                    `cb_search_person` cb_search_person  \n                WHERE\n                    cb_search_person.person_id IN (SELECT\n                        person_id \n                    FROM\n                        `cb_search_person` p \n                    WHERE\n                        age_at_consent BETWEEN 18 AND 50 \n                    AND cb_search_person.person_id IN (SELECT\n                        person_id \n                    FROM\n                        `person` p \n                    WHERE\n                        sex_at_birth_concept_id IN (45878463) ) \n                    AND cb_search_person.person_id IN (SELECT\n                        criteria.person_id \n                    FROM\n                        (SELECT\n                            DISTINCT person_id, entry_date, concept_id \n                        FROM\n                            `cb_search_all_events` \n                        WHERE\n                            (concept_id IN(SELECT\n                                DISTINCT c.concept_id \n                            FROM\n                                `cb_criteria` c \n                            JOIN\n                                (SELECT\n                                    CAST(cr.id as string) AS id       \n                                FROM\n                                    `cb_criteria` cr       \n                                WHERE\n                                    concept_id IN (316866)       \n                                    AND full_text LIKE '%_rank1]%'      ) a \n                                    ON (c.path LIKE CONCAT('%.', a.id, '.%') \n                                    OR c.path LIKE CONCAT('%.', a.id) \n                                    OR c.path LIKE CONCAT(a.id, '.%') \n                                    OR c.path = a.id) \n                            WHERE\n                                is_standard = 1 \n                                AND is_selectable = 1) \n                            AND is_standard = 1 )) criteria ) )\n            )) measurement \n    LEFT JOIN\n        `concept` m_standard_concept \n            ON measurement.measurement_concept_id = m_standard_concept.concept_id \n    LEFT JOIN\n        `concept` m_type \n            ON measurement.measurement_type_concept_id = m_type.concept_id \n    LEFT JOIN\n        `concept` m_operator \n            ON measurement.operator_concept_id = m_operator.concept_id \n    LEFT JOIN\n        `concept` m_value \n            ON measurement.value_as_concept_id = m_value.concept_id \n    LEFT JOIN\n        `concept` m_unit \n            ON measurement.unit_concept_id = m_unit.concept_id \n    LEFT JOIn\n        `visit_occurrence` v \n            ON measurement.visit_occurrence_id = v.visit_occurrence_id \n    LEFT JOIN\n        `concept` m_visit \n            ON v.visit_concept_id = m_visit.concept_id \n    LEFT JOIN\n        `concept` m_source_concept \n            ON measurement.measurement_source_concept_id = m_source_concept.concept_id\", sep=\"\")\n\n# Formulate a Cloud Storage destination path for the data exported from BigQuery.\n# NOTE: By default data exported multiple times on the same day will overwrite older copies.\n#       But data exported on a different days will write to a new location so that historical\n#       copies can be kept as the dataset definition is changed.\nmeasurement_71250616_path &lt;- file.path(\n  Sys.getenv(\"WORKSPACE_BUCKET\"),\n  \"bq_exports\",\n  Sys.getenv(\"OWNER_EMAIL\"),\n  strftime(lubridate::now(), \"%Y%m%d\"),  # Comment out this line if you want the export to always overwrite.\n  \"measurement_71250616\",\n  \"measurement_71250616_*.csv\")\nmessage(str_glue('The data will be written to {measurement_71250616_path}. Use this path when reading ',\n                 'the data into your notebooks in the future.'))\n\n# Perform the query and export the dataset to Cloud Storage as CSV files.\n# NOTE: You only need to run `bq_table_save` once. After that, you can\n#       just read data from the CSVs in Cloud Storage.\nbq_table_save(\n  bq_dataset_query(Sys.getenv(\"WORKSPACE_CDR\"), dataset_71250616_measurement_sql, billing = Sys.getenv(\"GOOGLE_PROJECT\")),\n  measurement_71250616_path,\n  destination_format = \"CSV\")\n\n\n# Read the data directly from Cloud Storage into memory.\n# NOTE: Alternatively you can `gsutil -m cp {measurement_71250616_path}` to copy these files\n#       to the Jupyter disk.\nread_bq_export_from_workspace_bucket &lt;- function(export_path) {\n  col_types &lt;- cols(standard_concept_name = col_character(), standard_concept_code = col_character(), standard_vocabulary = col_character(), measurement_type_concept_name = col_character(), operator_concept_name = col_character(), value_as_concept_name = col_character(), unit_concept_name = col_character(), visit_occurrence_concept_name = col_character(), measurement_source_value = col_character(), source_concept_name = col_character(), source_concept_code = col_character(), source_vocabulary = col_character(), unit_source_value = col_character(), value_source_value = col_character())\n  bind_rows(\n    map(system2('gsutil', args = c('ls', export_path), stdout = TRUE, stderr = TRUE),\n        function(csv) {\n          message(str_glue('Loading {csv}.'))\n          chunk &lt;- read_csv(pipe(str_glue('gsutil cat {csv}')), col_types = col_types, show_col_types = FALSE)\n          if (is.null(col_types)) {\n            col_types &lt;- spec(chunk)\n          }\n          chunk\n        }))\n}\ndataset_71250616_measurement_df &lt;- read_bq_export_from_workspace_bucket(measurement_71250616_path)\n\ndim(dataset_71250616_measurement_df)\n\nhead(dataset_71250616_measurement_df, 5)\nlibrary(tidyverse)\nlibrary(bigrquery)\n\n# This query represents dataset \"hypertension in pregnancy\" for domain \"drug\" and was generated for All of Us Registered Tier Dataset v7\ndataset_71250616_drug_sql &lt;- paste(\"\n    SELECT\n        d_exposure.person_id,\n        d_exposure.drug_concept_id,\n        d_standard_concept.concept_name as standard_concept_name,\n        d_standard_concept.concept_code as standard_concept_code,\n        d_standard_concept.vocabulary_id as standard_vocabulary,\n        d_exposure.drug_exposure_start_datetime,\n        d_exposure.drug_exposure_end_datetime,\n        d_exposure.verbatim_end_date,\n        d_exposure.drug_type_concept_id,\n        d_type.concept_name as drug_type_concept_name,\n        d_exposure.stop_reason,\n        d_exposure.refills,\n        d_exposure.quantity,\n        d_exposure.days_supply,\n        d_exposure.sig,\n        d_exposure.route_concept_id,\n        d_route.concept_name as route_concept_name,\n        d_exposure.lot_number,\n        d_exposure.visit_occurrence_id,\n        d_visit.concept_name as visit_occurrence_concept_name,\n        d_exposure.drug_source_value,\n        d_exposure.drug_source_concept_id,\n        d_source_concept.concept_name as source_concept_name,\n        d_source_concept.concept_code as source_concept_code,\n        d_source_concept.vocabulary_id as source_vocabulary,\n        d_exposure.route_source_value,\n        d_exposure.dose_unit_source_value \n    FROM\n        ( SELECT\n            * \n        FROM\n            `drug_exposure` d_exposure \n        WHERE\n            (\n                drug_concept_id IN (SELECT\n                    DISTINCT ca.descendant_id \n                FROM\n                    `cb_criteria_ancestor` ca \n                JOIN\n                    (SELECT\n                        DISTINCT c.concept_id       \n                    FROM\n                        `cb_criteria` c       \n                    JOIN\n                        (SELECT\n                            CAST(cr.id as string) AS id             \n                        FROM\n                            `cb_criteria` cr             \n                        WHERE\n                            concept_id IN (21601664, 21601744)             \n                            AND full_text LIKE '%_rank1]%'       ) a \n                            ON (c.path LIKE CONCAT('%.', a.id, '.%') \n                            OR c.path LIKE CONCAT('%.', a.id) \n                            OR c.path LIKE CONCAT(a.id, '.%') \n                            OR c.path = a.id) \n                    WHERE\n                        is_standard = 1 \n                        AND is_selectable = 1) b \n                        ON (ca.ancestor_id = b.concept_id)))  \n                    AND (d_exposure.PERSON_ID IN (SELECT\n                        distinct person_id  \n                FROM\n                    `cb_search_person` cb_search_person  \n                WHERE\n                    cb_search_person.person_id IN (SELECT\n                        person_id \n                    FROM\n                        `cb_search_person` p \n                    WHERE\n                        age_at_consent BETWEEN 18 AND 50\n                    AND cb_search_person.person_id IN (SELECT\n                        person_id \n                    FROM\n                        `person` p \n                    WHERE\n                        sex_at_birth_concept_id IN (45878463) ) \n                    AND cb_search_person.person_id IN (SELECT\n                        criteria.person_id \n                    FROM\n                        (SELECT\n                            DISTINCT person_id, entry_date, concept_id \n                        FROM\n                            `cb_search_all_events` \n                        WHERE\n                            (concept_id IN(SELECT\n                                DISTINCT c.concept_id \n                            FROM\n                                `cb_criteria` c \n                            JOIN\n                                (SELECT\n                                    CAST(cr.id as string) AS id       \n                                FROM\n                                    `cb_criteria` cr       \n                                WHERE\n                                    concept_id IN (316866)       \n                                    AND full_text LIKE '%_rank1]%'      ) a \n                                    ON (c.path LIKE CONCAT('%.', a.id, '.%') \n                                    OR c.path LIKE CONCAT('%.', a.id) \n                                    OR c.path LIKE CONCAT(a.id, '.%') \n                                    OR c.path = a.id) \n                            WHERE\n                                is_standard = 1 \n                                AND is_selectable = 1) \n                            AND is_standard = 1 )) criteria ) )\n            )) d_exposure \n    LEFT JOIN\n        `concept` d_standard_concept \n            ON d_exposure.drug_concept_id = d_standard_concept.concept_id \n    LEFT JOIN\n        `concept` d_type \n            ON d_exposure.drug_type_concept_id = d_type.concept_id \n    LEFT JOIN\n        `concept` d_route \n            ON d_exposure.route_concept_id = d_route.concept_id \n    LEFT JOIN\n        `visit_occurrence` v \n            ON d_exposure.visit_occurrence_id = v.visit_occurrence_id \n    LEFT JOIN\n        `concept` d_visit \n            ON v.visit_concept_id = d_visit.concept_id \n    LEFT JOIN\n        `concept` d_source_concept \n            ON d_exposure.drug_source_concept_id = d_source_concept.concept_id\", sep=\"\")\n\n# Formulate a Cloud Storage destination path for the data exported from BigQuery.\n# NOTE: By default data exported multiple times on the same day will overwrite older copies.\n#       But data exported on a different days will write to a new location so that historical\n#       copies can be kept as the dataset definition is changed.\ndrug_71250616_path &lt;- file.path(\n  Sys.getenv(\"WORKSPACE_BUCKET\"),\n  \"bq_exports\",\n  Sys.getenv(\"OWNER_EMAIL\"),\n  strftime(lubridate::now(), \"%Y%m%d\"),  # Comment out this line if you want the export to always overwrite.\n  \"drug_71250616\",\n  \"drug_71250616_*.csv\")\nmessage(str_glue('The data will be written to {drug_71250616_path}. Use this path when reading ',\n                 'the data into your notebooks in the future.'))\n\n# Perform the query and export the dataset to Cloud Storage as CSV files.\n# NOTE: You only need to run `bq_table_save` once. After that, you can\n#       just read data from the CSVs in Cloud Storage.\nbq_table_save(\n  bq_dataset_query(Sys.getenv(\"WORKSPACE_CDR\"), dataset_71250616_drug_sql, billing = Sys.getenv(\"GOOGLE_PROJECT\")),\n  drug_71250616_path,\n  destination_format = \"CSV\")\n\n\n# Read the data directly from Cloud Storage into memory.\n# NOTE: Alternatively you can `gsutil -m cp {drug_71250616_path}` to copy these files\n#       to the Jupyter disk.\nread_bq_export_from_workspace_bucket &lt;- function(export_path) {\n  col_types &lt;- cols(standard_concept_name = col_character(), standard_concept_code = col_character(), standard_vocabulary = col_character(), drug_type_concept_name = col_character(), stop_reason = col_character(), sig = col_character(), route_concept_name = col_character(), lot_number = col_character(), visit_occurrence_concept_name = col_character(), drug_source_value = col_character(), source_concept_name = col_character(), source_concept_code = col_character(), source_vocabulary = col_character(), route_source_value = col_character(), dose_unit_source_value = col_character())\n  bind_rows(\n    map(system2('gsutil', args = c('ls', export_path), stdout = TRUE, stderr = TRUE),\n        function(csv) {\n          message(str_glue('Loading {csv}.'))\n          chunk &lt;- read_csv(pipe(str_glue('gsutil cat {csv}')), col_types = col_types, show_col_types = FALSE)\n          if (is.null(col_types)) {\n            col_types &lt;- spec(chunk)\n          }\n          chunk\n        }))\n}\ndataset_71250616_drug_df &lt;- read_bq_export_from_workspace_bucket(drug_71250616_path)\n\ndim(dataset_71250616_drug_df)\n\nhead(dataset_71250616_drug_df, 5)"
  },
  {
    "objectID": "Presentations/allofus.html#creating-datasets-with-cohort-builder-1",
    "href": "Presentations/allofus.html#creating-datasets-with-cohort-builder-1",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Creating datasets with Cohort Builder",
    "text": "Creating datasets with Cohort Builder\nI have 4 CSV files (over 6 million rows) stored in my bucket that I have to read back in to do more manipulation\n\n\ngs://fc-secure-5dd899cc-249c-449a-b4b1-96abcc51898b/bq_exports/\nlouisahsmith@researchallofus.org/20241106/person_71250616/\nperson_71250616_*.csv\n\ngs://fc-secure-5dd899cc-249c-449a-b4b1-96abcc51898b/bq_exports/\nlouisahsmith@researchallofus.org/20241106/condition_71250616/\ncondition_71250616_*.csv\n\ngs://fc-secure-5dd899cc-249c-449a-b4b1-96abcc51898b/bq_exports/\nlouisahsmith@researchallofus.org/20241106/measurement_71250616/\nmeasurement_71250616_*.csv\n\ngs://fc-secure-5dd899cc-249c-449a-b4b1-96abcc51898b/bq_exports/\nlouisahsmith@researchallofus.org/20241106/drug_71250616/drug_71250616_*.csv"
  },
  {
    "objectID": "Presentations/allofus.html#creating-datasets-with-allofus",
    "href": "Presentations/allofus.html#creating-datasets-with-allofus",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Creating datasets with allofus",
    "text": "Creating datasets with allofus\n\nconcept_ids &lt;- c(21601664, 21601744, 21490851, 21490853, 3004249, 3005606, 3009395, 3012526, 3012888, 3013940, 3017490, 3018586, 3018592, 3018822, 3019962, 3027598, 3028737, 3031203, 3034703, 3035856, 36716965, 4060834, 40758413, 4152194, 4154790, 4232915, 4239021, 4248524, 4298393, 4302410, 44789315, 44789316, 132685, 133816, 134414, 135601, 136743, 137613, 138811, 141084, 314090, 35622939, 4034096, 4057976, 4116344, 4283352, 433536, 438490, 439077, 439393, 443700)\n\naou_concept_set(cohort, \n                concepts = concept_ids, \n                domains = c(\"drug\", \"measurement\", \"condition\"), \n                output = \"all\") |&gt; \n  count(concept_name, sort = TRUE)\n\nError in `aou_concept_set()`:\n! No connection available.\nℹ Provide a connection automatically by running `aou_connect()` before this\n  function.\nℹ You can also provide `con` as an argument or default with\n  `options(aou.default.con = ...)`."
  },
  {
    "objectID": "Presentations/allofus.html#improved-efficiency",
    "href": "Presentations/allofus.html#improved-efficiency",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Improved efficiency",
    "text": "Improved efficiency\n\nWe’re extracting a lot less data because we are\n\nImmediately using it for what we need (eligibility criteria)\nRestricting to the time periods of interest\n\nThe data is not actually extracted or stored until we need it in a local R session (e.g, for figures, regressions, etc.)\nEdits are straightforward and code is easily readable\n\nvs. storing millions of rows of data in a bucket and transferring it every time you run a notebook"
  },
  {
    "objectID": "Presentations/allofus.html#survey-data",
    "href": "Presentations/allofus.html#survey-data",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Survey data",
    "text": "Survey data\n\nsurvey_data &lt;- aou_survey(cohort,\n           questions = c(43529063),\n           question_output = c(\"hypertension\"))\n\nWhen was the survey question answered?\n\ncolnames(survey_data)\n\n\n\n[1] \"person_id\"         \"hypertension\"      \"hypertension_date\""
  },
  {
    "objectID": "Presentations/allofus.html#survey-data-1",
    "href": "Presentations/allofus.html#survey-data-1",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Survey data",
    "text": "Survey data\n\ncount(survey_data, hypertension)\n\n\n\n# A tibble: 6 × 2\n  hypertension      n    \n  &lt;chr&gt;             &lt;chr&gt;\n1 &lt;NA&gt;              16229\n2 Yes               5579 \n3 No                4426 \n4 Skip              280  \n5 DontKnow          49   \n6 PreferNotToAnswer &lt;20  \n\n\n\n“Skip/Prefer not to answer/Don’t know” includes anyone who skipped the whole question\nNA refers to participants who never saw the question.\n“No” assigned to respondents who answered the question, but didn’t select “Self”"
  },
  {
    "objectID": "Presentations/allofus.html#integrating-ohdsi-software-for-cohort-building",
    "href": "Presentations/allofus.html#integrating-ohdsi-software-for-cohort-building",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Integrating OHDSI software for cohort building",
    "text": "Integrating OHDSI software for cohort building"
  },
  {
    "objectID": "Presentations/allofus.html#challenges-in-fully-integrating-other-ohdsi-software",
    "href": "Presentations/allofus.html#challenges-in-fully-integrating-other-ohdsi-software",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Challenges in fully integrating other OHDSI software",
    "text": "Challenges in fully integrating other OHDSI software\n\nNo direct write access\nTemp tables work differently"
  },
  {
    "objectID": "Presentations/allofus.html#aou_compute",
    "href": "Presentations/allofus.html#aou_compute",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "aou_compute()",
    "text": "aou_compute()\nLike dplyr::compute() – forces computation\n\nfunction (data, ..., con = getOption(\"aou.default.con\")) \n{\n  q &lt;- as.character(dbplyr::db_sql_render(con, data))\n  tmp1 &lt;- \"CREATE TEMP TABLE table1 AS\"\n  tmp2 &lt;- \"SELECT * FROM table1\"\n  out &lt;- paste0(tmp1, \"\\n\", q, \";\\n\", tmp2)\n  {...}\n  get_query_table(out, collect = FALSE, ..., con = con)\n}"
  },
  {
    "objectID": "Presentations/allofus.html#aou_create_temp_table",
    "href": "Presentations/allofus.html#aou_create_temp_table",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "aou_create_temp_table()",
    "text": "aou_create_temp_table()\nCopies a local data frame to a temporary table in the connected database (in batches as necessary)\n\nfunction (data, nchar_batch = 1e+06, ..., con = getOption(\"aou.default.con\")) \n{\n  {...}\n  for (i in seq_along(batches)) {\n        dataset &lt;- datasets[i]\n        s1 &lt;- stringr::str_glue(\"CREATE TEMP TABLE {dataset} (\\n{s1_str}\\n);\")\n        s2 &lt;- stringr::str_glue(\"INSERT INTO {dataset} ({paste(cn, collapse =\\\", \\\")})\")\n        s3 &lt;- batches[i]\n        s4 &lt;- stringr::str_glue(\"SELECT * FROM {dataset};\")\n        q &lt;- paste(s1, s2, s3, s4)\n        tmptbl_object &lt;- bigrquery::bq_project_query(Sys.getenv(\"GOOGLE_PROJECT\"), \n            query = q)\n        n[[i]] &lt;- dplyr::tbl(con, paste(tmptbl_object$project, \n            tmptbl_object$dataset, tmptbl_object$table, sep = (\".\")))\n  }\n  final_tbl &lt;- purrr::reduce(n, dplyr::union_all)\n  {...}\n}"
  },
  {
    "objectID": "Presentations/allofus.html#aou_create_temp_table-1",
    "href": "Presentations/allofus.html#aou_create_temp_table-1",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "aou_create_temp_table()",
    "text": "aou_create_temp_table()\nCREATE TEMP TABLE MYLVFUKBBA (\n  concept_id FLOAT64,\n  category STRING,\n  gest_value FLOAT64\n  ); \nINSERT INTO MYLVFUKBBA (concept_id, category, gest_value) \nVALUES(439331, 'AB', NULL),\n  (4290245, 'DELIV', NULL),\n  (435640, 'PREG', 25),\nSELECT * FROM MYLVFUKBBA;\n\ntmptbl_object &lt;- bigrquery::bq_project_query(Sys.getenv(\"GOOGLE_PROJECT\"), query = q)\npaste(tmptbl_object$project, tmptbl_object$dataset, tmptbl_object$table, sep = (\".\"))\n\n\n\n[1] \"terra-vpc-sc-07d9a2ac._5e8cebc37c5303ccccd8c889e44de664222a9786.anon8daf0d7bf0928b865ebae9fe169111e4f21636f52ee032338b018d8da11852e3\"\n\n\n\ndplyr::tbl(con, paste(tmptbl_object$project, \n                                  tmptbl_object$dataset, \n                                  tmptbl_object$table, sep = (\".\")))"
  },
  {
    "objectID": "Presentations/allofus.html#other-functions",
    "href": "Presentations/allofus.html#other-functions",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Other functions",
    "text": "Other functions"
  },
  {
    "objectID": "Presentations/allofus.html#thank-you",
    "href": "Presentations/allofus.html#thank-you",
    "title": "allofus: an R package to facilitate use of the All of Us Researcher Workbench ",
    "section": "Thank you!",
    "text": "Thank you!\n\nSmith LH, Cavanaugh R. allofus: an R package to facilitate use of the All of Us Researcher Workbench. Journal of the American Medical Informatics Association. 2024;31(12):3013-3021. doi: 10.1093/jamia/ocae198\nGitHub (source code, bug reports): github.com/roux-ohdsi/allofus\nPackage site (tutorials, searchable codebooks): roux-ohdsi.github.io/allofus"
  },
  {
    "objectID": "Presentations/index.html",
    "href": "Presentations/index.html",
    "title": "Presentations",
    "section": "",
    "text": "Presentations\n\nAllOfUs\nDrugUtilisation"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#introduction",
    "href": "Presentations/DrugUtilisation.html#introduction",
    "title": "DrugUtilisation",
    "section": "Introduction",
    "text": "Introduction\nDrug Utilisation Studies (DUS) were defined by the World Health Organization as studying the marketing, distribution, prescription, and use of medicinal products in a society, with special emphasis on the resulting medical and socioeconomic consequences (WHO, 2003).\n\nThis package aims to standardise and provide the tools to conduct Drug Utilisation studies as of the Darwin-EU Catalogue of Standard Analytics."
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#the-package",
    "href": "Presentations/DrugUtilisation.html#the-package",
    "title": "DrugUtilisation",
    "section": "The package",
    "text": "The package\n\n\ninstall.packages(\"DrugUtilisation\")\n\n\nv1.0.5 on cran.\npackage website\nReport an issue/Feature request"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#create-a-reference-to-a-cdm-object",
    "href": "Presentations/DrugUtilisation.html#create-a-reference-to-a-cdm-object",
    "title": "DrugUtilisation",
    "section": "Create a reference to a cdm object",
    "text": "Create a reference to a cdm object\nFor this example we are going to use the GiBleed synthetic test database:\n\nlibrary(omock)\nlibrary(duckdb)\nlibrary(CDMConnector)\nlibrary(dplyr)\nlibrary(CodelistGenerator)\nlibrary(DrugUtilisation)\nlibrary(CohortConstructor)\nlibrary(PatientProfiles)\nlibrary(ggplot2)\nlibrary(clock)\nlibrary(omopgenerics)\nlibrary(CohortSurvival)\n\ncdm &lt;- mockCdmFromDataset(datasetName = \"GiBleed\", source = \"duckdb\")\ncdm$drug_exposure &lt;- cdm$drug_exposure |&gt;\n  mutate(quantity = sql(\"floor(random() * 6) + 1\")) |&gt;\n  mutate(quantity = case_when(\n    quantity == 1 ~ 0,\n    quantity == 2 ~ 1,\n    quantity == 3 ~ 5,\n    quantity == 4 ~ 10,\n    quantity == 5 ~ 30,\n    quantity == 6 ~ 100\n  )) |&gt;\n  compute(name = \"drug_exposure\")"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#generate-a-drug-cohort",
    "href": "Presentations/DrugUtilisation.html#generate-a-drug-cohort",
    "title": "DrugUtilisation",
    "section": "Generate a drug cohort",
    "text": "Generate a drug cohort\nFor this example we are going to use all records of acteaminophen:\n\n\ncodelist &lt;- getDrugIngredientCodes(cdm = cdm, name = \"acetaminophen\", nameStyle = \"{concept_name}\")\n\n\ncdm$dus_cohort &lt;- conceptCohort(\n  cdm = cdm,\n  name = \"dus_cohort\",\n  conceptSet = codelist\n)\n\n\n\nThe results is the cdm object with the new cohort instantiated.\n\n\n\ncdm\n\n\n\n\n── # OMOP CDM reference (duckdb) of GiBleed ────────────────────────────────────────────────────────────────────────────\n\n\n• omop tables: care_site, cdm_source, concept, concept_ancestor, concept_class, concept_relationship, concept_synonym,\ncondition_era, condition_occurrence, cost, death, device_exposure, domain, dose_era, drug_era, drug_exposure,\ndrug_strength, fact_relationship, location, measurement, metadata, note, note_nlp, observation, observation_period,\npayer_plan_period, person, procedure_occurrence, provider, relationship, source_to_concept_map, specimen, visit_detail,\nvisit_occurrence, vocabulary\n\n\n• cohort tables: dus_cohort\n\n\n• achilles tables: -\n\n\n• other tables: -"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#cohort-objects",
    "href": "Presentations/DrugUtilisation.html#cohort-objects",
    "title": "DrugUtilisation",
    "section": "Cohort objects",
    "text": "Cohort objects\nThe cohort objects have some attributes:\n\nclass(cdm$dus_cohort)\n\n[1] \"cohort_table\"          \"cdm_table\"             \"GeneratedCohortSet\"    \"tbl_duckdb_connection\"\n[5] \"tbl_dbi\"               \"tbl_sql\"               \"tbl_lazy\"              \"tbl\"                  \n\n\n\n\nnames(attributes(cdm$dus_cohort))\n\n[1] \"names\"            \"class\"            \"tbl_source\"       \"tbl_name\"         \"cohort_set\"       \"cohort_attrition\"\n[7] \"cohort_codelist\"  \"cdm_reference\"   \n\n\n\n\n\nSettings\nCounts\nAttrition\nCodelist"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#cohort-attributes",
    "href": "Presentations/DrugUtilisation.html#cohort-attributes",
    "title": "DrugUtilisation",
    "section": "Cohort attributes",
    "text": "Cohort attributes\nSettings:\n\nsettings(cdm$dus_cohort)\n\n# A tibble: 1 × 4\n  cohort_definition_id cohort_name   cdm_version vocabulary_version\n                 &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;             \n1                    1 acetaminophen 5.3         v5.0 18-JAN-19    \n\n\n\nCohort counts:\n\ncohortCount(cdm$dus_cohort)\n\n# A tibble: 1 × 3\n  cohort_definition_id number_records number_subjects\n                 &lt;int&gt;          &lt;int&gt;           &lt;int&gt;\n1                    1          13908            2679"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#cohort-attributes-1",
    "href": "Presentations/DrugUtilisation.html#cohort-attributes-1",
    "title": "DrugUtilisation",
    "section": "Cohort attributes",
    "text": "Cohort attributes\nCohort attrition:\n\nattrition(cdm$dus_cohort)\n\n# A tibble: 4 × 7\n  cohort_definition_id number_records number_subjects reason_id reason                excluded_records excluded_subjects\n                 &lt;int&gt;          &lt;int&gt;           &lt;int&gt;     &lt;int&gt; &lt;chr&gt;                            &lt;int&gt;             &lt;int&gt;\n1                    1          14205            2679         1 Initial qualifying e…                0                 0\n2                    1          14205            2679         2 Record in observation                0                 0\n3                    1          14205            2679         3 Not missing record d…                0                 0\n4                    1          13908            2679         4 Merge overlapping re…              297                 0\n\n\n\nCohort codelist:\n\ncohortCodelist(cdm$dus_cohort, cohortId = 1)\n\n\n- acetaminophen (7 codes)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#gapera-parameter",
    "href": "Presentations/DrugUtilisation.html#gapera-parameter",
    "title": "DrugUtilisation",
    "section": "gapEra parameter",
    "text": "gapEra parameter\ngapEra parameter can be used to concatenate different records.\n\nNumber of days between two continuous exposures to be considered in the same era. Records that have fewer days between them than this gap will be concatenated into the same cohort record."
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#gapera-parameter-1",
    "href": "Presentations/DrugUtilisation.html#gapera-parameter-1",
    "title": "DrugUtilisation",
    "section": "gapEra parameter",
    "text": "gapEra parameter"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#generate-a-drug-cohort-1",
    "href": "Presentations/DrugUtilisation.html#generate-a-drug-cohort-1",
    "title": "DrugUtilisation",
    "section": "Generate a drug cohort",
    "text": "Generate a drug cohort\n\n\ncohortCount(cdm$dus_cohort)\n\n# A tibble: 1 × 3\n  cohort_definition_id number_records number_subjects\n                 &lt;int&gt;          &lt;int&gt;           &lt;int&gt;\n1                    1          13908            2679\n\n\n\n\n\ncdm$dus_cohort &lt;- cdm$dus_cohort |&gt;\n  collapseCohorts(gap = 30)\n\n\n\n\ncohortCount(cdm$dus_cohort)\n\n# A tibble: 1 × 3\n  cohort_definition_id number_records number_subjects\n                 &lt;int&gt;          &lt;int&gt;           &lt;int&gt;\n1                    1          13860            2679\n\n\n\n\n\nattrition(cdm$dus_cohort)\n\n# A tibble: 5 × 7\n  cohort_definition_id number_records number_subjects reason_id reason                excluded_records excluded_subjects\n                 &lt;int&gt;          &lt;int&gt;           &lt;int&gt;     &lt;int&gt; &lt;chr&gt;                            &lt;int&gt;             &lt;int&gt;\n1                    1          14205            2679         1 Initial qualifying e…                0                 0\n2                    1          14205            2679         2 Record in observation                0                 0\n3                    1          14205            2679         3 Not missing record d…                0                 0\n4                    1          13908            2679         4 Merge overlapping re…              297                 0\n5                    1          13860            2679         5 Collapse cohort with…               48                 0"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#inclusion-criteria",
    "href": "Presentations/DrugUtilisation.html#inclusion-criteria",
    "title": "DrugUtilisation",
    "section": "Inclusion criteria",
    "text": "Inclusion criteria\nFour functions to add inclusion criteria to our cohort:\n\nWashout requirePriorDrugWashout() (requireConceptIntersect)\nFirst observation requireIsFirstDrugEntry() (requireIsFirstEntry)\nPrior observation requireObservationBeforeDrug() (requirePriorObservation)\nDate range requireDrugInDateRange() (requireInDateRange)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#important-considerations",
    "href": "Presentations/DrugUtilisation.html#important-considerations",
    "title": "DrugUtilisation",
    "section": "Important considerations",
    "text": "Important considerations\nNot all inclusion criteria are commutable operations (A + B != B + A):\nNot commutable:\n\nprior washout + prior observation != prior observation + prior washout\nprior washout + first != first + prior washout\nprior washout + date range != date range + prior washout\nfirst + prior observation != prior observation + first\nfirst + date range != date range + first\n\n\nCommutable:\n\ndate range + prior observation == prior observation + date range"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#recommended-order",
    "href": "Presentations/DrugUtilisation.html#recommended-order",
    "title": "DrugUtilisation",
    "section": "Recommended order",
    "text": "Recommended order\nHaving all this into account the recommended order to apply criteria would be:\n\nRequire a prior drug washout or require first drug entry (particular case).\nRequire a prior observation before the drug episode.\nRequire the drugs to be in a certain date range."
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#vignette-to-create-cohorts",
    "href": "Presentations/DrugUtilisation.html#vignette-to-create-cohorts",
    "title": "DrugUtilisation",
    "section": "Vignette to create cohorts",
    "text": "Vignette to create cohorts\nhttps://darwin-eu-dev.github.io/DrugUtilisation/articles/create_cohorts.html"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drug-usage",
    "href": "Presentations/DrugUtilisation.html#drug-usage",
    "title": "DrugUtilisation",
    "section": "Drug usage",
    "text": "Drug usage\n\n\nresult &lt;- cdm$dus_cohort |&gt;\n  summariseDrugUtilisation(\n    ingredientConceptId = 1125315L, \n    indexDate = \"cohort_start_date\",\n    censorDate = \"cohort_end_date\", \n    restrictIncident = TRUE, \n    gapEra = 30, \n    numberExposures = TRUE, \n    numberEras = TRUE,\n    daysExposed = TRUE,\n    daysPrescribed = TRUE,\n    timeToExposure = FALSE, \n    initialQuantity = TRUE, \n    cumulativeQuantity = TRUE, \n    initialDailyDose = TRUE, \n    cumulativeDose = TRUE,\n    estimates = c(\"q25\", \"median\", \"q75\")\n  )"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drug-usage-1",
    "href": "Presentations/DrugUtilisation.html#drug-usage-1",
    "title": "DrugUtilisation",
    "section": "Drug usage",
    "text": "Drug usage\n\nresult |&gt;\n  suppress(minCellCount = 5) |&gt;\n  tableDrugUtilisation()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nConcept set\nIngredient\nVariable name\nEstimate name\n\nCDM name\n\n\n\nGiBleed\n\n\n\n\nacetaminophen\n\n\noverall\noverall\nnumber records\nN\n13,860\n\n\n\n\nnumber subjects\nN\n2,679\n\n\ningredient_1125315_descendants\noverall\nnumber exposures\nMedian (Q25 - Q75)\n1 (1 - 1)\n\n\n\n\ncumulative quantity\nMedian (Q25 - Q75)\n10.00 (1.00 - 30.00)\n\n\n\n\ninitial quantity\nMedian (Q25 - Q75)\n10.00 (1.00 - 30.00)\n\n\n\n\ninitial exposure duration\nMedian (Q25 - Q75)\n15 (8 - 15)\n\n\n\n\nnumber eras\nMedian (Q25 - Q75)\n1 (1 - 1)\n\n\n\n\ndays exposed\nMedian (Q25 - Q75)\n15 (8 - 15)\n\n\n\n\ndays prescribed\nMedian (Q25 - Q75)\n15 (8 - 15)\n\n\n\nAcetaminophen\ncumulative dose milligram\nMedian (Q25 - Q75)\n1,625.00 (217.00 - 9,750.00)\n\n\n\n\ninitial daily dose milligram\nMedian (Q25 - Q75)\n108.33 (13.56 - 443.18)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications",
    "href": "Presentations/DrugUtilisation.html#indications",
    "title": "DrugUtilisation",
    "section": "Indications",
    "text": "Indications\nsummariseIndication():\n\nTo summarise mutually exclusive indications.\nDefine a window respect to the ‘cohort_start_date’.\nIndications must be instantiated beforehand as cohorts.\nUnknown indication (check a table to see if there is a record)."
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-1",
    "href": "Presentations/DrugUtilisation.html#indications-1",
    "title": "DrugUtilisation",
    "section": "Indications",
    "text": "Indications\nLet’s instantiate the cohorts of interest:\n\ncdm$indications &lt;- conceptCohort(\n  cdm = cdm,\n  conceptSet = list(\n    arteriosclerosis = 317576, \n    myocardial_infarction = 4329847, \n    pain = getCandidateCodes(cdm = cdm, keywords = \"pain\")$concept_id\n  ),\n  name = \"indications\"\n)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indciations",
    "href": "Presentations/DrugUtilisation.html#indciations",
    "title": "DrugUtilisation",
    "section": "Indciations",
    "text": "Indciations\n\nresult &lt;- cdm$dus_cohort |&gt;\n  summariseIndication(\n    indicationCohortName = \"indications\", \n    indicationWindow = list(c(0, 0), c(-30, 7)), \n    unknownIndicationTable = \"condition_occurrence\"\n  )\nresult |&gt;\n  glimpse()\n\nRows: 40\nColumns: 13\n$ result_id        &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ cdm_name         &lt;chr&gt; \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBl…\n$ group_name       &lt;chr&gt; \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"co…\n$ group_level      &lt;chr&gt; \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetami…\n$ strata_name      &lt;chr&gt; \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"over…\n$ strata_level     &lt;chr&gt; \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"over…\n$ variable_name    &lt;chr&gt; \"Indication on index date\", \"Indication on index date\", \"Indication on index date\", \"Indicati…\n$ variable_level   &lt;chr&gt; \"arteriosclerosis\", \"arteriosclerosis\", \"myocardial_infarction\", \"myocardial_infarction\", \"pa…\n$ estimate_name    &lt;chr&gt; \"count\", \"percentage\", \"count\", \"percentage\", \"count\", \"percentage\", \"count\", \"percentage\", \"…\n$ estimate_type    &lt;chr&gt; \"integer\", \"percentage\", \"integer\", \"percentage\", \"integer\", \"percentage\", \"integer\", \"percen…\n$ estimate_value   &lt;chr&gt; \"0\", \"0\", \"64\", \"0.461760461760462\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"13633…\n$ additional_name  &lt;chr&gt; \"window_name\", \"window_name\", \"window_name\", \"window_name\", \"window_name\", \"window_name\", \"wi…\n$ additional_level &lt;chr&gt; \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 …"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-2",
    "href": "Presentations/DrugUtilisation.html#indications-2",
    "title": "DrugUtilisation",
    "section": "Indications",
    "text": "Indications\n\n\nresult |&gt;\n  suppress() |&gt;\n  tableIndication()\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCDM name\n\n\n\n\n\nGiBleed\n\n\n\nIndication\nEstimate name\n\nCohort name\n\n\n\nacetaminophen\n\n\n\n\nIndication on index date\n\n\narteriosclerosis\nN (%)\n0 (0.00 %)\n\n\nmyocardial_infarction\nN (%)\n64 (0.46 %)\n\n\npain\nN (%)\n0 (0.00 %)\n\n\narteriosclerosis and myocardial_infarction\nN (%)\n0 (0.00 %)\n\n\narteriosclerosis and pain\nN (%)\n0 (0.00 %)\n\n\nmyocardial_infarction and pain\nN (%)\n0 (0.00 %)\n\n\narteriosclerosis and myocardial_infarction and pain\nN (%)\n0 (0.00 %)\n\n\nunknown\nN (%)\n13,633 (98.36 %)\n\n\nnone\nN (%)\n163 (1.18 %)\n\n\nnot in observation\nN (%)\n0 (0.00 %)\n\n\nIndication from 30 days before to 7 days after the index date\n\n\narteriosclerosis\nN (%)\n5 (0.04 %)\n\n\nmyocardial_infarction\nN (%)\n64 (0.46 %)\n\n\npain\nN (%)\n0 (0.00 %)\n\n\narteriosclerosis and myocardial_infarction\nN (%)\n0 (0.00 %)\n\n\narteriosclerosis and pain\nN (%)\n0 (0.00 %)\n\n\nmyocardial_infarction and pain\nN (%)\n0 (0.00 %)\n\n\narteriosclerosis and myocardial_infarction and pain\nN (%)\n0 (0.00 %)\n\n\nunknown\nN (%)\n13,784 (99.45 %)\n\n\nnone\nN (%)\n7 (0.05 %)\n\n\nnot in observation\nN (%)\n0 (0.00 %)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-3",
    "href": "Presentations/DrugUtilisation.html#indications-3",
    "title": "DrugUtilisation",
    "section": "Indications",
    "text": "Indications\n\nplotIndication(result)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-4",
    "href": "Presentations/DrugUtilisation.html#indications-4",
    "title": "DrugUtilisation",
    "section": "Indications",
    "text": "Indications\nOutput of ploting functions are ggplot2 objects.\n\n\nplotIndication(result) +\n  theme(legend.position = \"none\")"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-5",
    "href": "Presentations/DrugUtilisation.html#indications-5",
    "title": "DrugUtilisation",
    "section": "Indications",
    "text": "Indications\nCurrently considering to add support for plotly.\n\n\nlibrary(plotly)\nplotIndication(result) |&gt;\n  ggplotly()"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-new-plot",
    "href": "Presentations/DrugUtilisation.html#indications-new-plot",
    "title": "DrugUtilisation",
    "section": "Indications (new plot)",
    "text": "Indications (new plot)\nLet’s say we conducted the analysis stratified by sex:\n\nresult &lt;- cdm$dus_cohort |&gt;\n  addSex() |&gt;\n  summariseIndication(\n    strata = \"sex\",\n    indicationCohortName = \"indications\", \n    indicationWindow = list(c(0, 0), c(-30, 7)), \n    unknownIndicationTable = \"condition_occurrence\"\n  )\nresult |&gt;\n  glimpse()\n\nRows: 120\nColumns: 13\n$ result_id        &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …\n$ cdm_name         &lt;chr&gt; \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBl…\n$ group_name       &lt;chr&gt; \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"co…\n$ group_level      &lt;chr&gt; \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetami…\n$ strata_name      &lt;chr&gt; \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"over…\n$ strata_level     &lt;chr&gt; \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"over…\n$ variable_name    &lt;chr&gt; \"Indication on index date\", \"Indication on index date\", \"Indication on index date\", \"Indicati…\n$ variable_level   &lt;chr&gt; \"arteriosclerosis\", \"arteriosclerosis\", \"myocardial_infarction\", \"myocardial_infarction\", \"pa…\n$ estimate_name    &lt;chr&gt; \"count\", \"percentage\", \"count\", \"percentage\", \"count\", \"percentage\", \"count\", \"percentage\", \"…\n$ estimate_type    &lt;chr&gt; \"integer\", \"percentage\", \"integer\", \"percentage\", \"integer\", \"percentage\", \"integer\", \"percen…\n$ estimate_value   &lt;chr&gt; \"0\", \"0\", \"64\", \"0.461760461760462\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"0\", \"13633…\n$ additional_name  &lt;chr&gt; \"window_name\", \"window_name\", \"window_name\", \"window_name\", \"window_name\", \"window_name\", \"wi…\n$ additional_level &lt;chr&gt; \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 to 0\", \"0 …"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-new-plot-1",
    "href": "Presentations/DrugUtilisation.html#indications-new-plot-1",
    "title": "DrugUtilisation",
    "section": "Indications (new plot)",
    "text": "Indications (new plot)\n\nplotIndication(result = result, x = \"sex\")"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-new-plot-2",
    "href": "Presentations/DrugUtilisation.html#indications-new-plot-2",
    "title": "DrugUtilisation",
    "section": "Indications (new plot)",
    "text": "Indications (new plot)\n\nYou can do the same plot by year:\n\n\n\nresult &lt;- cdm$dus_cohort |&gt;\n  requireDrugInDateRange(\n    name = \"new_cohort\",\n    dateRange = as.Date(c(\"1990-01-01\", \"1999-12-31\"))\n  ) |&gt;\n  mutate(year = get_year(cohort_start_date)) |&gt;\n  summariseIndication(\n    strata = \"year\",\n    indicationCohortName = \"indications\", \n    indicationWindow = c(-Inf, 0), \n    unknownIndicationTable = \"condition_occurrence\"\n  )\nresult |&gt;\n  filterStrata(year != \"overall\") |&gt;\n  plotIndication(x = \"year\")"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#indications-new-plot-3",
    "href": "Presentations/DrugUtilisation.html#indications-new-plot-3",
    "title": "DrugUtilisation",
    "section": "Indications (new plot)",
    "text": "Indications (new plot)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#treatment-persistence",
    "href": "Presentations/DrugUtilisation.html#treatment-persistence",
    "title": "DrugUtilisation",
    "section": "Treatment persistence",
    "text": "Treatment persistence\nTo analyse treatment persistence and adherence there are two standard pipelines:\n\nSurvival analysis (implemented in the CohortSurvival package)\nProportion of patients covered"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#survival-analysis",
    "href": "Presentations/DrugUtilisation.html#survival-analysis",
    "title": "DrugUtilisation",
    "section": "Survival Analysis",
    "text": "Survival Analysis\n\nsurvivalResults &lt;- estimateSingleEventSurvival(\n  cdm = cdm, \n  targetCohortTable = \"dus_cohort\", \n  outcomeCohortTable = \"dus_cohort\", \n  outcomeDateVariable = \"cohort_end_date\", \n  followUpDays = 90\n)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#survival-analysis-1",
    "href": "Presentations/DrugUtilisation.html#survival-analysis-1",
    "title": "DrugUtilisation",
    "section": "Survival analysis",
    "text": "Survival analysis\n\nplotSurvival(result = survivalResults)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#proportion-of-patients-covered",
    "href": "Presentations/DrugUtilisation.html#proportion-of-patients-covered",
    "title": "DrugUtilisation",
    "section": "Proportion of patients covered",
    "text": "Proportion of patients covered\nProportion of treated individuals between index date and followUpDays. Percentages will be reported daily.\n\nresult &lt;- cdm$dus_cohort |&gt;\n  summariseProportionOfPatientsCovered(followUpDays = 90)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#proportion-of-patients-covered-1",
    "href": "Presentations/DrugUtilisation.html#proportion-of-patients-covered-1",
    "title": "DrugUtilisation",
    "section": "Proportion of patients covered",
    "text": "Proportion of patients covered\n\n\ntableProportionOfPatientsCovered(result)\n\n\n\n\n\n\n\n\n\n\n\n\nTime\nEstimate name\n\nCohort name\n\n\n\nacetaminophen\n\n\n\n\nGiBleed\n\n\n0\nPPC (95%CI)\n100.00% [99.86% - 100.00%]\n\n\n1\nPPC (95%CI)\n98.69% [98.19% - 99.06%]\n\n\n2\nPPC (95%CI)\n98.69% [98.19% - 99.06%]\n\n\n3\nPPC (95%CI)\n98.69% [98.19% - 99.06%]\n\n\n4\nPPC (95%CI)\n98.69% [98.19% - 99.06%]\n\n\n5\nPPC (95%CI)\n98.69% [98.19% - 99.06%]\n\n\n6\nPPC (95%CI)\n98.69% [98.19% - 99.06%]\n\n\n7\nPPC (95%CI)\n98.66% [98.15% - 99.03%]\n\n\n8\nPPC (95%CI)\n74.73% [73.05% - 76.34%]\n\n\n9\nPPC (95%CI)\n74.73% [73.05% - 76.34%]\n\n\n10\nPPC (95%CI)\n74.73% [73.05% - 76.34%]\n\n\n11\nPPC (95%CI)\n74.73% [73.05% - 76.34%]\n\n\n12\nPPC (95%CI)\n74.73% [73.05% - 76.34%]\n\n\n13\nPPC (95%CI)\n74.73% [73.05% - 76.34%]\n\n\n14\nPPC (95%CI)\n74.62% [72.93% - 76.23%]\n\n\n15\nPPC (95%CI)\n19.48% [18.03% - 21.03%]\n\n\n16\nPPC (95%CI)\n19.37% [17.92% - 20.91%]\n\n\n17\nPPC (95%CI)\n19.26% [17.81% - 20.80%]\n\n\n18\nPPC (95%CI)\n19.26% [17.81% - 20.80%]\n\n\n19\nPPC (95%CI)\n19.22% [17.78% - 20.76%]\n\n\n20\nPPC (95%CI)\n19.22% [17.78% - 20.76%]\n\n\n21\nPPC (95%CI)\n19.19% [17.74% - 20.72%]\n\n\n22\nPPC (95%CI)\n14.37% [13.09% - 15.75%]\n\n\n23\nPPC (95%CI)\n14.33% [13.06% - 15.71%]\n\n\n24\nPPC (95%CI)\n14.33% [13.06% - 15.71%]\n\n\n25\nPPC (95%CI)\n14.30% [13.02% - 15.67%]\n\n\n26\nPPC (95%CI)\n14.30% [13.02% - 15.67%]\n\n\n27\nPPC (95%CI)\n14.30% [13.02% - 15.67%]\n\n\n28\nPPC (95%CI)\n14.30% [13.02% - 15.67%]\n\n\n29\nPPC (95%CI)\n11.35% [10.20% - 12.60%]\n\n\n30\nPPC (95%CI)\n11.27% [10.13% - 12.53%]\n\n\n31\nPPC (95%CI)\n8.40% [7.41% - 9.51%]\n\n\n32\nPPC (95%CI)\n8.36% [7.37% - 9.47%]\n\n\n33\nPPC (95%CI)\n8.36% [7.37% - 9.47%]\n\n\n34\nPPC (95%CI)\n8.36% [7.37% - 9.47%]\n\n\n35\nPPC (95%CI)\n8.32% [7.34% - 9.43%]\n\n\n36\nPPC (95%CI)\n5.97% [5.14% - 6.93%]\n\n\n37\nPPC (95%CI)\n5.97% [5.14% - 6.93%]\n\n\n38\nPPC (95%CI)\n5.71% [4.89% - 6.65%]\n\n\n39\nPPC (95%CI)\n5.64% [4.82% - 6.57%]\n\n\n40\nPPC (95%CI)\n5.56% [4.76% - 6.49%]\n\n\n41\nPPC (95%CI)\n5.56% [4.76% - 6.49%]\n\n\n42\nPPC (95%CI)\n5.56% [4.76% - 6.49%]\n\n\n43\nPPC (95%CI)\n5.56% [4.76% - 6.49%]\n\n\n44\nPPC (95%CI)\n5.52% [4.72% - 6.45%]\n\n\n45\nPPC (95%CI)\n5.45% [4.65% - 6.37%]\n\n\n46\nPPC (95%CI)\n5.45% [4.65% - 6.37%]\n\n\n47\nPPC (95%CI)\n5.45% [4.65% - 6.37%]\n\n\n48\nPPC (95%CI)\n5.56% [4.76% - 6.49%]\n\n\n49\nPPC (95%CI)\n5.56% [4.76% - 6.49%]\n\n\n50\nPPC (95%CI)\n5.56% [4.76% - 6.49%]\n\n\n51\nPPC (95%CI)\n5.52% [4.72% - 6.45%]\n\n\n52\nPPC (95%CI)\n5.52% [4.72% - 6.45%]\n\n\n53\nPPC (95%CI)\n5.52% [4.72% - 6.45%]\n\n\n54\nPPC (95%CI)\n5.52% [4.72% - 6.45%]\n\n\n55\nPPC (95%CI)\n5.52% [4.72% - 6.45%]\n\n\n56\nPPC (95%CI)\n5.49% [4.69% - 6.41%]\n\n\n57\nPPC (95%CI)\n5.49% [4.69% - 6.41%]\n\n\n58\nPPC (95%CI)\n5.75% [4.93% - 6.69%]\n\n\n59\nPPC (95%CI)\n5.75% [4.93% - 6.69%]\n\n\n60\nPPC (95%CI)\n5.82% [5.00% - 6.77%]\n\n\n61\nPPC (95%CI)\n3.28% [2.67% - 4.03%]\n\n\n62\nPPC (95%CI)\n3.40% [2.77% - 4.15%]\n\n\n63\nPPC (95%CI)\n3.32% [2.71% - 4.07%]\n\n\n64\nPPC (95%CI)\n3.32% [2.71% - 4.07%]\n\n\n65\nPPC (95%CI)\n3.32% [2.71% - 4.07%]\n\n\n66\nPPC (95%CI)\n3.40% [2.77% - 4.15%]\n\n\n67\nPPC (95%CI)\n3.40% [2.77% - 4.15%]\n\n\n68\nPPC (95%CI)\n3.17% [2.57% - 3.91%]\n\n\n69\nPPC (95%CI)\n3.17% [2.57% - 3.91%]\n\n\n70\nPPC (95%CI)\n3.10% [2.51% - 3.82%]\n\n\n71\nPPC (95%CI)\n3.10% [2.51% - 3.82%]\n\n\n72\nPPC (95%CI)\n3.06% [2.47% - 3.78%]\n\n\n73\nPPC (95%CI)\n2.87% [2.31% - 3.58%]\n\n\n74\nPPC (95%CI)\n2.84% [2.27% - 3.54%]\n\n\n75\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n76\nPPC (95%CI)\n2.76% [2.21% - 3.45%]\n\n\n77\nPPC (95%CI)\n2.76% [2.21% - 3.45%]\n\n\n78\nPPC (95%CI)\n2.84% [2.27% - 3.54%]\n\n\n79\nPPC (95%CI)\n2.87% [2.31% - 3.58%]\n\n\n80\nPPC (95%CI)\n2.87% [2.31% - 3.58%]\n\n\n81\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n82\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n83\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n84\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n85\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n86\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n87\nPPC (95%CI)\n2.80% [2.24% - 3.49%]\n\n\n88\nPPC (95%CI)\n2.84% [2.27% - 3.54%]\n\n\n89\nPPC (95%CI)\n2.91% [2.34% - 3.62%]\n\n\n90\nPPC (95%CI)\n2.91% [2.34% - 3.62%]"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#proportion-of-patients-covered-2",
    "href": "Presentations/DrugUtilisation.html#proportion-of-patients-covered-2",
    "title": "DrugUtilisation",
    "section": "Proportion of patients covered",
    "text": "Proportion of patients covered\n\nplotProportionOfPatientsCovered(result)\n\n\n\ngapEra parameter can have a big impact in survival analysis, whereas it does not have such big impact on proportion of patients covered."
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching",
    "href": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching",
    "title": "DrugUtilisation",
    "section": "Drug restart and drug switching",
    "text": "Drug restart and drug switching\nWe have the ability to study drug restart or drug switching after a discontinuation:\n\nSwitching cohorts must be defined in advance.\nWe have to define the windows of interest.\nIndex date will be the date of discontinuation.\nReported percentages in each window will be:\nRestart: individuals that restarted and not switched.\nSwitch: individuals that switched and not restarted.\nRestart and switch: individuals that restarted and switched.\nUntreated: individuals that did not restart or switch."
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-1",
    "href": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-1",
    "title": "DrugUtilisation",
    "section": "Drug restart and drug switching",
    "text": "Drug restart and drug switching\nLet’s define the cohorts of interest for switching:\n\ncodelist &lt;- getDrugIngredientCodes(\n  cdm = cdm, \n  name = c(\"clopidogrel\", \"simvastatin\", \"warfarin\"), \n  nameStyle = \"{concept_name}\"\n)\ncdm$switch &lt;- conceptCohort(\n  cdm = cdm, \n  name = \"switch\",\n  conceptSet = codelist\n)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-2",
    "href": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-2",
    "title": "DrugUtilisation",
    "section": "Drug restart and drug switching",
    "text": "Drug restart and drug switching\nWe have to be careful with the inclusion criteria of the input cohort, as restart is derived from it.\n\n\nresult &lt;- cdm$dus_cohort |&gt;\n  summariseDrugRestart(\n    switchCohortTable = \"switch\", \n    followUpDays = c(90, 180, 270, 360), \n    restrictToFirstDiscontinuation = TRUE\n  )\nresult |&gt;\n  glimpse()\n\nRows: 32\nColumns: 13\n$ result_id        &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1\n$ cdm_name         &lt;chr&gt; \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBleed\", \"GiBl…\n$ group_name       &lt;chr&gt; \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"cohort_name\", \"co…\n$ group_level      &lt;chr&gt; \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetaminophen\", \"acetami…\n$ strata_name      &lt;chr&gt; \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"over…\n$ strata_level     &lt;chr&gt; \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"overall\", \"over…\n$ variable_name    &lt;chr&gt; \"Drug restart in 90 days\", \"Drug restart in 90 days\", \"Drug restart in 90 days\", \"Drug restar…\n$ variable_level   &lt;chr&gt; \"restart\", \"restart\", \"switch\", \"switch\", \"restart and switch\", \"restart and switch\", \"untrea…\n$ estimate_name    &lt;chr&gt; \"count\", \"percentage\", \"count\", \"percentage\", \"count\", \"percentage\", \"count\", \"percentage\", \"…\n$ estimate_type    &lt;chr&gt; \"integer\", \"percentage\", \"integer\", \"percentage\", \"integer\", \"percentage\", \"integer\", \"percen…\n$ estimate_value   &lt;chr&gt; \"43\", \"1.60507652108996\", \"0\", \"0\", \"0\", \"0\", \"2636\", \"98.39492347891\", \"97\", \"3.620754012691…\n$ additional_name  &lt;chr&gt; \"follow_up_days\", \"follow_up_days\", \"follow_up_days\", \"follow_up_days\", \"follow_up_days\", \"fo…\n$ additional_level &lt;chr&gt; \"90 days\", \"90 days\", \"90 days\", \"90 days\", \"90 days\", \"90 days\", \"90 days\", \"90 days\", \"180 …"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-3",
    "href": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-3",
    "title": "DrugUtilisation",
    "section": "Drug restart and drug switching",
    "text": "Drug restart and drug switching\n\n\ntableDrugRestart(result)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCDM name\n\n\n\n\n\nGiBleed\n\n\n\nTreatment\nEstimate name\n\nCohort name\n\n\n\nacetaminophen\n\n\n\n\nDrug restart in 90 days\n\n\nrestart\nN (%)\n43 (1.61 %)\n\n\nswitch\nN (%)\n0 (0.00 %)\n\n\nrestart and switch\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,636 (98.39 %)\n\n\nDrug restart in 180 days\n\n\nrestart\nN (%)\n97 (3.62 %)\n\n\nswitch\nN (%)\n0 (0.00 %)\n\n\nrestart and switch\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,582 (96.38 %)\n\n\nDrug restart in 270 days\n\n\nrestart\nN (%)\n175 (6.53 %)\n\n\nswitch\nN (%)\n0 (0.00 %)\n\n\nrestart and switch\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,504 (93.47 %)\n\n\nDrug restart in 360 days\n\n\nrestart\nN (%)\n244 (9.11 %)\n\n\nswitch\nN (%)\n1 (0.04 %)\n\n\nrestart and switch\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,434 (90.85 %)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-4",
    "href": "Presentations/DrugUtilisation.html#drug-restart-and-drug-switching-4",
    "title": "DrugUtilisation",
    "section": "Drug restart and drug switching",
    "text": "Drug restart and drug switching\n\nplotDrugRestart(result)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-treatments",
    "href": "Presentations/DrugUtilisation.html#summarise-treatments",
    "title": "DrugUtilisation",
    "section": "Summarise treatments",
    "text": "Summarise treatments\nsummariseTreatment() is a general function to analyse presence of treatments (cohorts) after an index date. This can be used with many different purposes:\n\nSummarise treatments after a certain condition\nAnalyse comedications\nAnalyse treatments after discontinuation\n…"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#lets-create-some-treatments-cohorts",
    "href": "Presentations/DrugUtilisation.html#lets-create-some-treatments-cohorts",
    "title": "DrugUtilisation",
    "section": "Let’s create some treatments cohorts",
    "text": "Let’s create some treatments cohorts\n\ncodelist &lt;- getDrugIngredientCodes(\n  cdm = cdm, \n  name = c(\"clopidogrel\", \"simvastatin\", \"warfarin\", \"nitroglycerin\"),\n  nameStyle = \"{concept_name}\"\n)\ncdm$treatments &lt;- conceptCohort(\n  cdm = cdm, \n  name = \"treatments\",\n  conceptSet = codelist\n)\ncdm$osteoarthritis &lt;- conceptCohort(\n  cdm = cdm,\n  conceptSet = list(osteoarthritis = 80180L),\n  name = \"osteoarthritis\"\n)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-treatments-after-condition",
    "href": "Presentations/DrugUtilisation.html#summarise-treatments-after-condition",
    "title": "DrugUtilisation",
    "section": "Summarise treatments after condition",
    "text": "Summarise treatments after condition\n\nresult &lt;- cdm$osteoarthritis |&gt;\n  summariseTreatment(\n    window = list(c(1, 90), c(91, 180), c(181, 270), c(271, 360)), \n    treatmentCohortName = \"treatments\", \n    indexDate = \"cohort_start_date\", \n    censorDate = NULL\n  )"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-treatments-after-condition-1",
    "href": "Presentations/DrugUtilisation.html#summarise-treatments-after-condition-1",
    "title": "DrugUtilisation",
    "section": "Summarise treatments after condition",
    "text": "Summarise treatments after condition\n\n\ntableTreatment(result, style = \"darwin\")\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCDM name\n\n\n\n\n\nGiBleed\n\n\n\nTreatment\nEstimate name\n\nCohort name\n\n\n\nosteoarthritis\n\n\n\n\nMedication from 1 day after to 90 days after the index date\n\n\nclopidogrel\nN (%)\n9 (0.34 %)\n\n\nnitroglycerin\nN (%)\n20 (0.76 %)\n\n\nsimvastatin\nN (%)\n1 (0.04 %)\n\n\nwarfarin\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,608 (99.16 %)\n\n\nnot in observation\nN (%)\n0 (0.00 %)\n\n\nMedication from 91 days after to 180 days after the index date\n\n\nclopidogrel\nN (%)\n10 (0.38 %)\n\n\nnitroglycerin\nN (%)\n20 (0.76 %)\n\n\nsimvastatin\nN (%)\n0 (0.00 %)\n\n\nwarfarin\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,583 (98.21 %)\n\n\nnot in observation\nN (%)\n25 (0.95 %)\n\n\nMedication from 181 days after to 270 days after the index date\n\n\nclopidogrel\nN (%)\n9 (0.34 %)\n\n\nnitroglycerin\nN (%)\n20 (0.76 %)\n\n\nsimvastatin\nN (%)\n1 (0.04 %)\n\n\nwarfarin\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,569 (97.68 %)\n\n\nnot in observation\nN (%)\n40 (1.52 %)\n\n\nMedication from 271 days after to 360 days after the index date\n\n\nclopidogrel\nN (%)\n11 (0.42 %)\n\n\nnitroglycerin\nN (%)\n21 (0.80 %)\n\n\nsimvastatin\nN (%)\n1 (0.04 %)\n\n\nwarfarin\nN (%)\n0 (0.00 %)\n\n\nuntreated\nN (%)\n2,547 (96.84 %)\n\n\nnot in observation\nN (%)\n60 (2.28 %)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-treatments-after-condition-2",
    "href": "Presentations/DrugUtilisation.html#summarise-treatments-after-condition-2",
    "title": "DrugUtilisation",
    "section": "Summarise treatments after condition",
    "text": "Summarise treatments after condition\n\nplotTreatment(result)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-treatments-after-discontinuation",
    "href": "Presentations/DrugUtilisation.html#summarise-treatments-after-discontinuation",
    "title": "DrugUtilisation",
    "section": "Summarise treatments after discontinuation",
    "text": "Summarise treatments after discontinuation\n\nresult &lt;- cdm$dus_cohort |&gt;\n  summariseTreatment(\n    window = list(c(1, 90), c(91, 180), c(181, 270), c(271, 360)), \n    treatmentCohortName = \"treatments\", \n    indexDate = \"cohort_end_date\", \n    censorDate = NULL\n  )"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-treatments-after-discontinuation-1",
    "href": "Presentations/DrugUtilisation.html#summarise-treatments-after-discontinuation-1",
    "title": "DrugUtilisation",
    "section": "Summarise treatments after discontinuation",
    "text": "Summarise treatments after discontinuation\n\nplotTreatment(result)"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-comedications",
    "href": "Presentations/DrugUtilisation.html#summarise-comedications",
    "title": "DrugUtilisation",
    "section": "Summarise comedications",
    "text": "Summarise comedications\n\ncomedications &lt;- cdm$dus_cohort |&gt;\n  summariseTreatment(\n    window = c(0, Inf), \n    treatmentCohortName = \"treatments\", \n    indexDate = \"cohort_start_date\", \n    censorDate = \"cohort_end_date\"\n  )"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#summarise-comedications-1",
    "href": "Presentations/DrugUtilisation.html#summarise-comedications-1",
    "title": "DrugUtilisation",
    "section": "Summarise comedications",
    "text": "Summarise comedications\n\nplotTreatment(comedications, style = \"darwin\")"
  },
  {
    "objectID": "Presentations/DrugUtilisation.html#drugutilisation",
    "href": "Presentations/DrugUtilisation.html#drugutilisation",
    "title": "DrugUtilisation",
    "section": "DrugUtilisation",
    "text": "DrugUtilisation\n\n\n👉 Packages website\n👉 CRAN link\n👉 Manual\n📧 marti.catalasabate@ndorms.ox.ac.uk"
  }
]